"use strict";(("undefined"!==typeof self?self:this)["webpackChunksupportability_review_app_3_0_0"]=("undefined"!==typeof self?self:this)["webpackChunksupportability_review_app_3_0_0"]||[]).push([[739],{14123:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var o=a(9274);function r(e,t,a,r,n,l){const s=(0,o.resolveComponent)("Loading"),i=(0,o.resolveComponent)("LabeledInput"),c=(0,o.resolveComponent)("Banner"),u=(0,o.resolveComponent)("Tab"),m=(0,o.resolveComponent)("Tolerations"),d=(0,o.resolveComponent)("TextAreaAutoGrow"),p=(0,o.resolveComponent)("Tabbed"),h=(0,o.resolveComponent)("CruResource"),v=(0,o.resolveDirective)("clean-html");return a.value?((0,o.openBlock)(),(0,o.createBlock)(h,{key:1,"done-route":e.doneRoute,"can-yaml":!0,mode:a.mode,resource:a.value,errors:e.errors,"validation-passed":e.isFormValid,onError:t[3]||(t[3]=t=>e.errors=t),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{"label-key":"sr.menuLabels.basic",name:"basic-config",weight:3},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[t[4]||(t[4]=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1)),t[5]||(t[5]=(0,o.createElementVNode)("h4",{class:"mb-200"},"Bundle Name",-1)),(0,o.createVNode)(i,{value:n.generateName,"onUpdate:value":t[0]||(t[0]=e=>n.generateName=e),label:"Enter Bundle Name",placeholder:"review-bundle",maxlength:30,onBlur:l.setDefaultName},null,8,["value","onBlur"]),(0,o.createVNode)(c,{class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[v,e.t("sr.menuLabels.bundleNameRestriction",{},!0)]])])),_:1})])])),_:1}),(0,o.createVNode)(u,{"label-key":"sr.menuLabels.advanced",name:"advanced-config",weight:2},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",null,[t[6]||(t[6]=(0,o.createElementVNode)("h2",{class:"mb-200"},"Collector Config",-1)),t[7]||(t[7]=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Sonobuoy Namespace",-1)),(0,o.createVNode)(i,{value:a.value.spec.sonobuoyNamespace,"onUpdate:value":t[1]||(t[1]=e=>a.value.spec.sonobuoyNamespace=e),placeholder:"sonobuoy",maxlength:64,onBlur:l.setDefaultSonobuoyNamespace},null,8,["value","onBlur"]),t[8]||(t[8]=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200",for:"tolerations"},"Tolerations",-1)),(0,o.createVNode)(m,{value:a.value.spec.tolerations,"onUpdate:value":t[2]||(t[2]=e=>a.value.spec.tolerations=e),mode:a.mode},null,8,["value","mode"]),t[9]||(t[9]=(0,o.createElementVNode)("h4",{class:"mt-10 mb-200"},"Bundle Description",-1)),(0,o.createVNode)(d,{minHeight:"50",placeholder:"Enter bundle description",autocapitalize:"off",spellcheck:"false"})])])),_:1})])),_:1}),n.isPrime?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[v,e.t("sr.menuLabels.forCommunityUser0",{},!0)]])])),_:1})),n.isPrime?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(c,{key:1,class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[v,e.t("sr.menuLabels.forCommunityUser1",{},!0)]])])),_:1})),n.isPrime?((0,o.openBlock)(),(0,o.createBlock)(c,{key:2,class:"mb-10",color:"info"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",null,null,512),[[v,e.t("sr.menuLabels.forCommunityUser1",{},!0)]])])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1},8,["done-route","mode","resource","errors","validation-passed","onFinish","onCancel"])):((0,o.openBlock)(),(0,o.createBlock)(s,{key:0}))}var n=a(84409),l=a(2930),s=a(10006),i=a(49584),c=a(91825),u=a(14220),m=a(35664),d=a(9980),p=a(54873),h=a(59582),v=a(59378),b=a(4364),N={name:"ReviewBundleEditView",components:{Banner:d.l,CruResource:l.A,LabeledInput:h.A,Loading:n.A,Tabbed:s.A,Tab:i.A,TextAreaAutoGrow:v.A,Tolerations:p.A},mixins:[c.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0},resource:{type:String,required:!0}},data(){return this.mode===u.YQ&&(this.value.metadata.name||(this.value.metadata.generateName="review-bundle-"),this.value.spec||(this.value.spec={}),this.value.spec.analyzeClusters=["local"],this.value.spec.sonobuoyNamespace="sonobuoy",this.createApiToken().then((e=>{this.value.spec.token=e})).catch((e=>{b.error(e)})),fetch("/v3/settings/server-url",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{this.value.spec.hostName=e.value})).catch((e=>{b.error("Fetch error:",e)})),fetch("/rancherversion",{headers:{"Content-Type":"application/json",Accept:"application/json"}}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{"false"===e.RancherPrime?(this.value.spec.collectClusters=["local"],this.isPrime=!1):this.isPrime=!0})).catch((e=>{b.error("Fetch error:",e)}))),{description:"",isPrime:!0,generateName:"review-bundle"}},computed:{isView(){return this.mode!==u.YQ&&this.mode!==u.G5},editorMode(){return this.isView?EDITOR_MODES.VIEW_CODE:EDITOR_MODES.EDIT_CODE},hasBeenCreated(){return!!this.value.id}},watch:{},methods:{async createApiToken(){const e=144e5,t=await this.$store.dispatch("rancher/create",{type:m.k$.TOKEN,ttl:e,description:"Supportability Review"}),a=await t.save();return a.token},setDefaultName(){this.value.metadata.generateName=this.generateName.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"").replace(/^-+/,"").slice(0,30),this.value.metadata.generateName.trim()||(this.value.metadata.generateName="review-bundle-"),this.value.metadata.generateName.endsWith("-")||(this.value.metadata.generateName+="-")},setDefaultSonobuoyNamespace(){this.value.spec.sonobuoyNamespace.trim()||(this.value.spec.sonobuoyNamespace="sonobuoy")}}},f=a(47433);const C=(0,f.A)(N,[["render",r]]);var w=C}}]);
//# sourceMappingURL=supportability-review-app-3.0.0.umd.min.edit.js.map