(("undefined"!==typeof self?self:this)["webpackJsonpneuvector_ui_ext_2_0_4"]=("undefined"!==typeof self?self:this)["webpackJsonpneuvector_ui_ext_2_0_4"]||[]).push([[7],{"0fc3":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a("9557"),r=a("f4b0");async function i(e){await Object(r["b"])(e);let t=await Object(n["b"])();e.dispatch("neuvector/updateWorkloads",s(t.data.workloads))}function s(e){let t=new Map;return t}async function o(e,t){await Object(r["b"])(t);let a=new Map;e.forEach(e=>{var t;let n=e.status.containerStatuses&&(null===(t=e.status.containerStatuses[0])||void 0===t?void 0:t.containerID)||"",r=n.split("//")[1]||"";a.has(r)||a.set(e.id,r)}),console.log("rancherWorkloadMap",a),t.dispatch("neuvector/updateRancherWorkloadMap",a)}},9557:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a("827a"),r=a("f4b0"),i=a("49bf");async function s(){return Object(n["a"])({url:Object(r["j"])(i["a"].SCANNED_CONTAINER_URL),method:"get"})}async function o(e){return Object(n["a"])({url:Object(r["j"])(i["a"].SCAN_URL),method:"get",params:{id:e}})}},"9dd3":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",[e.vulnerabilities&&e.vulnerabilities.length>0?t("VulnerabilitiesGrid",{attrs:{vulnerabilities:e.vulnerabilities,csvFileName:e.rancherWorkloadName}}):t("div",[t("Banner",{staticClass:"type-banner mb-20 mt-0",attrs:{color:"warning",label:e.t("general.NO_ROWS")}})],1)],1)},r=[],i=a("0fc3"),s=a("6418"),o=a("aada"),l=a("9557"),c={components:{Banner:s["a"],VulnerabilitiesGrid:o["a"]},props:{workload:Object,isLightTheme:Boolean},async fetch(){try{console.log("Get workload vulnerabilities...");let e="";if(this.workload);else{let t=this.$store.getters["neuvector/rancherWorkloadMap"],a=location.pathname.split("/");if(!t||0===t.size){let e=this.$store.getters["cluster/all"](a[a.length-3]);await Object(i["a"])(e,this.$store),t=this.$store.getters["neuvector/rancherWorkloadMap"]}let n=`${a[a.length-2]}/${a[a.length-1]}`;console.log(t,n),t.has(n)&&(console.log(n),e=t.get(n)),this.rancherWorkloadName=n}const t=this.$store.getters["neuvector/scannedWorkloadMap"];if(t.has(e))this.vulnerabilities=t.get(e);else{let t=await Object(l["a"])(e);this.vulnerabilities=t.data.report.vulnerabilities,this.$store.dispatch("neuvector/updateScannedWorkloadMap",{workloadID:e,scannedResult:this.vulnerabilities})}}catch(e){console.error(e)}},data(){return{vulnerabilities:null,rancherWorkloadName:""}}},u=c,d=a("d802"),h=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=h.exports}}]);
//# sourceMappingURL=neuvector-ui-ext-2.0.4.umd.min.7.js.map