(("undefined"!==typeof self?self:this)["webpackChunkharvester_1_7_0"]=("undefined"!==typeof self?self:this)["webpackChunkharvester_1_7_0"]||[]).push([[739],{49306:function(e,t,a){"use strict";a.d(t,{A:function(){return h}});var o=a(9274);const r={class:"label"},l={class:"text-label"},s={class:"mt-10"},n=["onClick"],i={key:1,class:"tag input"};function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("t"),m=(0,o.resolveComponent)("Tag");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[a.labelKey?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,k:a.labelKey},null,8,["k"])):a.label?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createTextVNode)((0,o.toDisplayString)(a.label),1)],64)):(0,o.createCommentVNode)("",!0)])]),(0,o.createElementVNode)("div",s,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.value,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(m,{key:t,class:"tag"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e),1),u.canRemove?((0,o.openBlock)(),(0,o.createElementBlock)("i",{key:0,class:"icon icon-close ml-5 icon-sm",onClick:t=>u.onRemoveTag(e)},null,8,n)):(0,o.createCommentVNode)("",!0)])),_:2},1024)))),128)),u.addVisible&&!c.inputVisible?((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:0,class:"tag add",onClick:t[0]||(t[0]=(...e)=>u.onClickPlusButton&&u.onClickPlusButton(...e))},[t[4]||(t[4]=(0,o.createElementVNode)("i",{class:"icon icon-plus icon-sm"},null,-1)),(0,o.createElementVNode)("span",null,[a.addLabelKey?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,k:a.addLabelKey},null,8,["k"])):a.addLabel?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:1},[(0,o.createTextVNode)((0,o.toDisplayString)(a.addLabel),1)],64)):(0,o.createCommentVNode)("",!0)])])):u.addVisible&&c.inputVisible?((0,o.openBlock)(),(0,o.createElementBlock)("span",i,[(0,o.withDirectives)((0,o.createElementVNode)("input",{ref:"addTagInput","onUpdate:modelValue":t[1]||(t[1]=e=>c.inputValue=e),type:"text",onBlur:t[2]||(t[2]=(...e)=>u.confirmAdd&&u.confirmAdd(...e)),onKeydown:t[3]||(t[3]=(0,o.withKeys)((0,o.withModifiers)(((...e)=>u.confirmAdd&&u.confirmAdd(...e)),["prevent"]),["enter"]))},null,544),[[o.vModelText,c.inputValue]])])):(0,o.createCommentVNode)("",!0)])])}var c=a(14220),u=a(8529),p={name:"Tags",emits:["update:value"],components:{Tag:u.A},props:{value:{type:Array,required:!0},label:{type:String,default:""},labelKey:{type:String,default:""},addLabel:{type:String,default:""},addLabelKey:{type:String,default:""},canAdd:{type:Boolean,default:!0},mode:{type:String,default:c.YQ},disabled:{type:Boolean,default:!1}},data(){return{tags:this.value,inputVisible:!1,inputValue:""}},computed:{isCreate(){return this.mode===c.YQ},isView(){return this.mode===c.nW},isEdit(){return this.mode===c.G5},canRemove(){return!this.isView},addVisible(){return this.canAdd&&!this.isView}},methods:{onClickPlusButton(){this.inputVisible=!0,this.$nextTick((()=>{this.$refs.addTagInput&&this.$refs.addTagInput.focus()}))},confirmAdd(){this.inputValue&&!this.value.includes(this.inputValue)&&(this.tags.push(this.inputValue),this.$emit("update:value",this.tags)),this.inputValue="",this.inputVisible=!1},onRemoveTag(e){this.tags=this.tags.filter((t=>t!==e)),this.$emit("update:value",this.tags)}}},m=(a(61051),a(47433));const v=(0,m.A)(p,[["render",d],["__scopeId","data-v-6b2f75f1"]]);var h=v},36955:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=a(9274);const r={class:"row mb-20"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("FileSelector"),c=(0,o.resolveComponent)("TextAreaAutoGrow");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{class:"btn btn-sm bg-primary mb-10",label:e.t("generic.readFromFile"),onSelected:i.onKeySelected},null,8,["label","onSelected"]),(0,o.createElementVNode)("div",null,[(0,o.createVNode)(c,{value:e.value.value,"onUpdate:value":t[0]||(t[0]=t=>e.value.value=t),"min-height":254},null,8,["value"])])])])])}var n=a(91825),i=a(20491),d=a(6879),c={name:"HarvesterAdditionalCA",components:{FileSelector:i.A,TextAreaAutoGrow:d.V},mixins:[n.A],methods:{onKeySelected:(0,i.B)("value.value")}},u=a(47433);const p=(0,u.A)(c,[["render",s]]);var m=p},53867:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.ratio,"onUpdate:value":[t[0]||(t[0]=e=>n.ratio=e),i.update],label:e.t("harvester.setting.ratio")},null,8,["value","label","onUpdate:value"])])])}var n=a(91825),i=a(79380),d={name:"AdditionalGuestMemoryOverheadRatio",components:{LabeledInput:i.o},mixins:[n.A],data(){return{ratio:this.value.value||this.value.default}},methods:{update(){this.value["value"]=this.ratio},useDefault(){this["ratio"]=this.value.default,this.update()}}},c=a(47433);const u=(0,c.A)(d,[["render",s]]);var p=u},32158:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("RadioGroup"),c=(0,o.resolveComponent)("UnitInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.parseDefaultValue.enable,"onUpdate:value":[t[0]||(t[0]=e=>n.parseDefaultValue.enable=e),i.update],class:"mb-20",name:"model",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","labels","onUpdate:value"]),n.parseDefaultValue.enable?((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,value:n.parseDefaultValue.expiringInHours,"onUpdate:value":[t[1]||(t[1]=e=>n.parseDefaultValue.expiringInHours=e),i.update],valueModifiers:{number:!0},class:"mb-20",min:1,max:8759,required:!0,suffix:1===n.parseDefaultValue.expiringInHours?"Hour":"Hours",label:e.t("harvester.setting.autoRotateRKE2Certs.expiringInHours"),mode:e.mode},null,8,["value","suffix","label","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0)])])}var n=a(91825),i=a(10196),d=a(73344),c={name:"HarvesterAutoRotateRKE2Certs",components:{RadioGroup:i.z,UnitInput:d.A},mixins:[n.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e}},created(){this.update()},methods:{update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},u=(a(50072),a(47433));const p=(0,u.A)(c,[["render",s],["__scopeId","data-v-034d9714"]]);var m=p},71526:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var o=a(9274);const r={class:"col span-12"},l={class:"mb-20"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("LabeledSelect"),c=(0,o.resolveComponent)("UnitInput"),u=(0,o.resolveComponent)("Tip"),p=(0,o.resolveComponent)("LabeledInput"),m=(0,o.resolveComponent)("Password"),v=(0,o.resolveComponent)("MessageLink");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"row",onInput:t[8]||(t[8]=(...e)=>i.update&&i.update(...e))},[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(d,{value:n.parseDefaultValue.type,"onUpdate:value":[t[0]||(t[0]=e=>n.parseDefaultValue.type=e),i.update],class:"mb-20",label:e.t("harvester.fields.type"),options:i.typeOption},null,8,["value","label","options","onUpdate:value"]),i.refreshIntervalInSecondEnabled?((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,value:n.parseDefaultValue.refreshIntervalInSeconds,"onUpdate:value":[t[1]||(t[1]=e=>n.parseDefaultValue.refreshIntervalInSeconds=e),i.update],suffix:n.parseDefaultValue.refreshIntervalInSeconds<=1?"Second":"Seconds",label:e.t("harvester.backup.refreshInterval.label"),mode:e.mode,positive:!0,class:"mb-5",required:""},null,8,["value","suffix","label","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0),i.refreshIntervalInSecondEnabled?((0,o.openBlock)(),(0,o.createBlock)(u,{key:1,class:"mb-20",icon:"icon icon-info",text:e.t("harvester.backup.refreshInterval.tip")},null,8,["text"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(p,{value:n.parseDefaultValue.endpoint,"onUpdate:value":t[2]||(t[2]=e=>n.parseDefaultValue.endpoint=e),class:"mb-5",placeholder:i.endpointPlaceholder,mode:e.mode,label:"Endpoint"},null,8,["value","placeholder","mode"]),(0,o.createVNode)(u,{class:"mb-20",icon:"icon icon-info",text:e.t("harvester.backup.backupTargetTip")},null,8,["text"]),i.isS3?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:2},[(0,o.createVNode)(p,{value:n.parseDefaultValue.bucketName,"onUpdate:value":t[3]||(t[3]=e=>n.parseDefaultValue.bucketName=e),class:"mb-20",mode:e.mode,label:"Bucket Name",required:""},null,8,["value","mode"]),(0,o.createVNode)(p,{value:n.parseDefaultValue.bucketRegion,"onUpdate:value":t[4]||(t[4]=e=>n.parseDefaultValue.bucketRegion=e),class:"mb-20",mode:e.mode,label:"Bucket Region",required:""},null,8,["value","mode"]),(0,o.createVNode)(p,{value:n.parseDefaultValue.accessKeyId,"onUpdate:value":t[5]||(t[5]=e=>n.parseDefaultValue.accessKeyId=e),placeholder:e.t("harvester.setting.placeholder.accessKeyId"),class:"mb-20",mode:e.mode,label:"Access Key ID",required:""},null,8,["value","placeholder","mode"]),(0,o.createVNode)(m,{value:n.parseDefaultValue.secretAccessKey,"onUpdate:value":t[6]||(t[6]=e=>n.parseDefaultValue.secretAccessKey=e),class:"mb-20",mode:e.mode,placeholder:e.t("harvester.setting.placeholder.secretAccessKey"),label:"Secret Access Key",required:""},null,8,["value","mode","placeholder"]),(0,o.createVNode)(d,{value:n.parseDefaultValue.virtualHostedStyle,"onUpdate:value":[t[7]||(t[7]=e=>n.parseDefaultValue.virtualHostedStyle=e),i.update],class:"mb-20",label:"Virtual Hosted-Style",options:i.virtualHostedStyleOptions},null,8,["value","options","onUpdate:value"]),(0,o.createElementVNode)("div",l,[(0,o.createVNode)(u,{icon:"icon icon-info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{to:i.toCA,target:"_blank","prefix-label":"harvester.setting.message.ca.prefix","middle-label":"harvester.setting.message.ca.middle","suffix-label":"harvester.setting.message.ca.suffix"},null,8,["to"])])),_:1})])],64)):(0,o.createCommentVNode)("",!0)])],32)}var n=a(29349),i=a(7274),d=a(96413),c=a(91825),u=a(79380),p=a(89483),m=a(50889),v=a(73344);const h="s3";var b={name:"HarvesterEditBackupTarget",components:{LabeledInput:u.o,LabeledSelect:p.A,Tip:n.A,Password:i.A,MessageLink:d.A,UnitInput:v.A},mixins:[c.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e={type:"",endpoint:"",refreshIntervalInSeconds:0}}return e.type||(e.type=h),e.virtualHostedStyle=!1,{parseDefaultValue:e,errors:[]}},computed:{typeOption(){return[{value:"nfs",label:"NFS"},{value:h,label:"S3"}]},virtualHostedStyleOptions(){return[{value:!0,label:"True"},{value:!1,label:"False"}]},refreshIntervalInSecondEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("refreshIntervalInSecond")},isS3(){return this.parseDefaultValue.type===h},endpointPlaceholder(){return this.isS3?"":"nfs://server:/path/"},toCA(){return`${m.EP.ADDITIONAL_CA}?mode=edit`}},watch:{value:{handler(e){let t;try{t=JSON.parse(e.value)}catch(a){t={type:"",endpoint:"",refreshIntervalInSeconds:0}}this["parseDefaultValue"]=t,this.update()},deep:!0}},created(){this.update()},methods:{update(){this.isS3||(delete this.parseDefaultValue.accessKeyId,delete this.parseDefaultValue.secretAccessKey,delete this.parseDefaultValue.bucketName,delete this.parseDefaultValue.bucketRegion,delete this.parseDefaultValue.virtualHostedStyle,delete this.parseDefaultValue.cert),this.isS3&&!this.parseDefaultValue.virtualHostedStyle&&(this.parseDefaultValue.virtualHostedStyle=!1),this.parseDefaultValue.type?this.value["value"]=JSON.stringify(this.parseDefaultValue):delete this.value["value"]},useDefault(){this["parseDefaultValue"]={type:"",endpoint:"",refreshIntervalInSeconds:0}}}},g=(a(10205),a(47433));const f=(0,g.A)(b,[["render",s],["__scopeId","data-v-4b7055bd"]]);var k=f},90955:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var o=a(9274);const r=["onClick"],l={class:"row mb-20"},s={class:"col span-12"},n={class:"mb-20"},i={class:"row mb-20"},d=["onClick"],c={class:"row mb-20"},u={class:"col span-12"},p={class:"col span-12"},m={class:"row mb-20"},v={class:"col span-6"},h={class:"col span-6"},b={class:"row mb-20"},g={class:"col span-6"},f={class:"col span-6"},k={class:"row"};function y(e,t,a,y,N,V){const C=(0,o.resolveComponent)("LabeledInput"),w=(0,o.resolveComponent)("LabeledSelect"),E=(0,o.resolveComponent)("KeyValue"),S=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("harvester.setting.containerdRegistry.mirrors.mirrors")),1),(0,o.createElementVNode)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(N.mirrors,((d,c)=>((0,o.openBlock)(),(0,o.createBlock)(S,{key:d.idx,class:"box"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{type:"button",class:"role-link btn btn-sm remove",onClick:e=>V.remove("mirrors",c)},t[2]||(t[2]=[(0,o.createElementVNode)("i",{class:"icon icon-2x icon-x"},null,-1)]),8,r),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(C,{value:d.key,"onUpdate:value":[e=>d.key=e,V.update],mode:a.mode,required:"","label-key":"harvester.setting.containerdRegistry.mirrors.registryName",onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","mode","onKeydown"])])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(w,{value:d.value.Endpoints,"onUpdate:value":[e=>d.value.Endpoints=e,V.update],mode:a.mode,required:"","label-key":"harvester.setting.containerdRegistry.mirrors.endpoints",multiple:!0,taggable:!0,searchable:!0,options:[],onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","mode","onKeydown"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(E,{value:d.value.Rewrites,"onUpdate:value":[e=>d.value.Rewrites=e,V.update],"add-label":e.t("harvester.setting.containerdRegistry.mirrors.rewrite.addRewrite"),mode:a.mode,title:e.t("harvester.setting.containerdRegistry.mirrors.rewrite.rewrite"),"read-allowed":!1,"value-can-be-empty":!0,onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","add-label","mode","title","onKeydown"])])])),_:2},1024)))),128))]),(0,o.createElementVNode)("button",{class:"btn btn-sm role-primary",onClick:t[0]||(t[0]=(0,o.withModifiers)(((...e)=>V.addMirror&&V.addMirror(...e)),["self"]))},(0,o.toDisplayString)(e.t("harvester.setting.containerdRegistry.mirrors.addMirror")),1),t[4]||(t[4]=(0,o.createElementVNode)("hr",{class:"divider mt-20 mb-20"},null,-1)),(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("harvester.setting.containerdRegistry.configs.configs")),1),(0,o.createElementVNode)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(N.configs,((r,l)=>((0,o.openBlock)(),(0,o.createBlock)(S,{key:r.idx,class:"box"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{type:"button",class:"role-link btn btn-sm remove",onClick:e=>V.remove("configs",l)},t[3]||(t[3]=[(0,o.createElementVNode)("i",{class:"icon icon-2x icon-x"},null,-1)]),8,d),(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(C,{value:r.key,"onUpdate:value":[e=>r.key=e,V.update],mode:a.mode,placeholder:e.t("harvester.setting.containerdRegistry.configs.registryPlaceholder"),"label-key":"harvester.setting.containerdRegistry.configs.registryEDQNorIP"},null,8,["value","onUpdate:value","mode","placeholder"])])])]),(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(C,{value:r.value.Auth.Username,"onUpdate:value":[e=>r.value.Auth.Username=e,V.update],mode:a.mode,"label-key":"harvester.setting.containerdRegistry.configs.username"},null,8,["value","onUpdate:value","mode"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(C,{value:r.value.Auth.Password,"onUpdate:value":[e=>r.value.Auth.Password=e,V.update],mode:a.mode,"label-key":"harvester.setting.containerdRegistry.configs.password"},null,8,["value","onUpdate:value","mode"])])]),(0,o.createElementVNode)("div",b,[(0,o.createElementVNode)("div",g,[(0,o.createVNode)(C,{value:r.value.Auth.Auth,"onUpdate:value":[e=>r.value.Auth.Auth=e,V.update],mode:a.mode,type:"multiline","min-height":150,"label-key":"harvester.setting.containerdRegistry.configs.auth"},null,8,["value","onUpdate:value","mode"])]),(0,o.createElementVNode)("div",f,[(0,o.createVNode)(C,{value:r.value.Auth.IdentityToken,"onUpdate:value":[e=>r.value.Auth.IdentityToken=e,V.update],mode:a.mode,type:"multiline","min-height":150,"label-key":"harvester.setting.containerdRegistry.configs.identityToken"},null,8,["value","onUpdate:value","mode"])])]),(0,o.createElementVNode)("div",k,[(0,o.createVNode)(w,{value:r.value.TLS.InsecureSkipVerify,"onUpdate:value":[e=>r.value.TLS.InsecureSkipVerify=e,V.update],mode:a.mode,"label-key":"harvester.setting.containerdRegistry.configs.insecureSkipVerify",options:V.insecureSkipVerifyOption},null,8,["value","onUpdate:value","mode","options"])])])),_:2},1024)))),128)),(0,o.createElementVNode)("button",{class:"btn btn-sm role-primary",onClick:t[1]||(t[1]=(...e)=>V.addConfig&&V.addConfig(...e))},(0,o.toDisplayString)(e.t("harvester.setting.containerdRegistry.configs.addConfig")),1)])])}var N=a(79380),V=a(14220),C=a(92043),w=a(89483),E=a(38094),S=a(26962),B=a(76978),A={name:"HarvesterContainerdRegistry",components:{InfoBox:S.A,KeyValue:E.A,LabeledInput:N.o,LabeledSelect:w.A},props:{mode:{type:String,default:V.G5},value:{type:Object,default:()=>({})},registerBeforeHook:{type:Function,required:!0}},data(){const e={Endpoints:[],Rewrites:{}},t={Auth:{Username:"",Password:"",Auth:"",IdentityToken:""},TLS:{InsecureSkipVerify:!1}};let a={};const o={Mirrors:{"":(0,B.o8)(e)},Configs:{}};try{a=JSON.parse(this.value.value)}catch(c){a=o}Object.keys(a).length||(a=o);const r=a.Mirrors||{},l=a.Configs||{},s=Object.keys(r),n=Object.keys(l),i=s.map((e=>({key:e,value:a.Mirrors[e],idx:(0,C.vx)(5).toLowerCase()}))),d=n.map((e=>(a.Configs[e]?.Auth||(a.Configs[e].Auth=t.Auth),{key:e,value:a.Configs[e],idx:(0,C.vx)(5).toLowerCase()})));return{mirrors:i,configs:d,originMirror:e,originConfig:t,mirrorsKeys:s,configsKeys:n,errors:[]}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},computed:{insecureSkipVerifyOption(){return[{label:"True",value:!0},{label:"False",value:!1}]}},methods:{willSave(){const e=[];if(this.value.value)try{JSON.parse(this.value.value),this.mirrors.forEach((t=>{t.key||e.push(this.t("validation.required",{key:this.t("harvester.setting.containerdRegistry.mirrors.registryName")},!0)),0===t.value.Endpoints.length&&e.push(this.t("validation.required",{key:this.t("harvester.setting.containerdRegistry.mirrors.endpoints")},!0))})),this.configs.forEach((t=>{t.key||e.push(this.t("validation.required",{key:this.t("harvester.setting.containerdRegistry.configs.registryEDQNorIP")},!0))}))}catch(t){}return e.length>0?Promise.reject(e):Promise.resolve()},update(){const e={},t={};this.mirrors.forEach((t=>{e[t.key]=t.value})),this.configs.forEach((e=>{t[e.key]=e.value}));const a={Mirrors:e,Configs:t};Object.keys(e).length||delete a.Mirrors,Object.keys(t).length||delete a.Configs;const o=Object.keys(a).length?JSON.stringify(a):"";this.value["value"]=o},addMirror(){this.mirrors.push({key:"",value:(0,B.o8)(this.originMirror),idx:(0,C.vx)(5).toLowerCase()}),this.update()},addConfig(){this.configs.push({key:"",value:(0,B.o8)(this.originConfig),idx:(0,C.vx)(5).toLowerCase()}),this.update()},remove(e,t){this[e].splice(t,1),this.update()}},watch:{value:{handler(e){e.value||(this["mirrors"]=[],this["configs"]=[],this.update())},deep:!0}}},x=(a(88789),a(47433));const D=(0,x.A)(A,[["render",y],["__scopeId","data-v-d281fc5e"]]);var M=D},65241:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var o=a(9274);const r=["disabled","onClick"],l={class:"row"},s={class:"col span-4"},n={class:"col span-4"},i={class:"col span-4"},d=["disabled"];function c(e,t,a,c,u,p){const m=(0,o.resolveComponent)("LabeledSelect"),v=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(u.configArr,((d,c)=>((0,o.openBlock)(),(0,o.createBlock)(v,{key:c,class:"box"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{disabled:p.disableEdit(d.key),type:"button",class:"role-link btn btn-sm remove",onClick:e=>p.remove(c)},t[1]||(t[1]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,r),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(m,{value:d.key,"onUpdate:value":[e=>d.key=e,p.update],mode:a.mode,required:"",disabled:p.disableEdit(d.key),"label-key":"harvester.setting.csiDriverConfig.provisioner",searchable:!0,options:p.provisioners,onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","mode","disabled","options","onKeydown"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(m,{value:d.value.volumeSnapshotClassName,"onUpdate:value":[e=>d.value.volumeSnapshotClassName=e,p.update],mode:a.mode,required:"",disabled:p.disableEdit(d.key),options:p.getVolumeSnapshotOptions(d.key),label:e.t("harvester.setting.csiDriverConfig.volumeSnapshotClassName"),onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","mode","disabled","options","label","onKeydown"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(m,{value:d.value.backupVolumeSnapshotClassName,"onUpdate:value":[e=>d.value.backupVolumeSnapshotClassName=e,p.update],mode:a.mode,disabled:p.isBackupVolumeSnapshotClassNameDisabled(d.key),options:p.getVolumeSnapshotOptions(d.key),required:p.isBackupVolumeSnapshotRequired(d.key),label:e.t("harvester.setting.csiDriverConfig.backupVolumeSnapshotClassName"),onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","onUpdate:value","mode","disabled","options","required","label","onKeydown"])])])])),_:2},1024)))),128)),(0,o.createElementVNode)("button",{class:"btn btn-sm role-primary",disabled:p.disableAdd,onClick:t[0]||(t[0]=(0,o.withModifiers)(((...e)=>p.add&&p.add(...e)),["self"]))},(0,o.toDisplayString)(e.t("generic.add")),9,d)])}var u=a(14220),p=a(89483),m=a(26962),v=a(88339),h=a(32766),b=a(35664),g={name:"HarvesterCsiDriver",components:{InfoBox:m.A,LabeledSelect:p.A},props:{mode:{type:String,default:u.G5},value:{type:Object,default:()=>({})},registerBeforeHook:{type:Function,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={csiDrivers:this.$store.dispatch(`${e}/findAll`,{type:h.Zq}),volumeSnapshotClass:this.$store.dispatch(`${e}/findAll`,{type:h.nE})};await(0,v.kR)(t)},data(){const e=this.value.value||this.value.default,t=this.parseValue(e);return{configArr:t}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},computed:{provisioners(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](h.Zq)||[];return t.filter((e=>!this.configArr.map((e=>e.key)).includes(e.name))).map((e=>e.name))},disableAdd(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](h.Zq)||[];return this.configArr.length>=t.length},allowEmptySnapshotClassNameFeatureEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("allowEmptySnapshotClassName")}},methods:{getVolumeSnapshotOptions(e){const t=this.$store.getters["currentProduct"].inStore,a=this.$store.getters[`${t}/all`](h.nE)||[];return a.filter((t=>t.driver===e)).map((e=>({label:e.name,value:e.name})))},parseValue(e){const t=[];let a={};try{a=JSON.parse(e)}catch(o){new Error("json error")}for(const[r,l]of Object.entries(a))t.push({key:r,value:l});return t},update(){const e={};this.configArr.map((t=>{e[t.key]=t.value}));const t=this.configArr.length?JSON.stringify(e):"";this.value["value"]=t},willSave(){this.update();const e=[];try{this.configArr.forEach((t=>{t.key||e.push(this.t("validation.required",{key:this.t("harvester.setting.csiDriverConfig.provisioner")},!0)),t.value.volumeSnapshotClassName||e.push(this.t("validation.required",{key:this.t("harvester.setting.csiDriverConfig.volumeSnapshotClassName")},!0)),this.allowEmptySnapshotClassNameFeatureEnabled||t.value.backupVolumeSnapshotClassName||e.push(this.t("validation.required",{key:this.t("harvester.setting.csiDriverConfig.backupVolumeSnapshotClassName")},!0))}))}catch(t){}return e.length>0?Promise.reject(e):Promise.resolve()},remove(e){this.configArr.splice(e,1)},isBackupVolumeSnapshotRequired(e){return e===b.lI},disableEdit(e){return e===b.lI},isBackupVolumeSnapshotClassNameDisabled(e){return e===b.lI||this.allowEmptySnapshotClassNameFeatureEnabled},add(){this.configArr.push({key:"",value:{volumeSnapshotClassName:"",backupVolumeSnapshotClassName:""}})},useDefault(){const e=this.parseValue(this.value.default);this["configArr"]=e,this.update()}}},f=(a(31660),a(47433));const k=(0,f.A)(g,[["render",c],["__scopeId","data-v-a4b4739a"]]);var y=k},63727:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var o=a(9274);const r=["disabled","onClick"],l={class:"row"},s={class:"col span-4"},n={class:"col span-4"},i=["disabled"];function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("Banner"),m=(0,o.resolveComponent)("LabeledSelect"),v=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(u.allErrors,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(p,{key:t,color:"error"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e),1)])),_:2},1024)))),128)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(c.configArr,((e,i)=>((0,o.openBlock)(),(0,o.createBlock)(v,{key:i,class:"box"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{class:"role-link btn btn-sm remove",type:"button",disabled:u.disableEdit(e.key),onClick:e=>u.remove(i)},t[3]||(t[3]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,r),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(m,{value:e.key,"onUpdate:value":[t=>e.key=t,u.update],"label-key":"harvester.setting.csiOnlineExpandValidation.provisioner",required:"",searchable:"",mode:a.mode,disabled:u.disableEdit(e.key),options:u.provisioners,onKeydown:t[0]||(t[0]=(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"]))},null,8,["value","onUpdate:value","mode","disabled","options"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(m,{value:e.value,"onUpdate:value":[t=>e.value=t,e=>u.onValueChange(i,e)],"label-key":"harvester.setting.csiOnlineExpandValidation.value",required:"",searchable:"",mode:a.mode,disabled:u.disableEdit(e.key),options:u.provisionerValue,onKeydown:t[1]||(t[1]=(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"]))},null,8,["value","onUpdate:value","mode","disabled","options"])])])])),_:2},1024)))),128)),(0,o.createElementVNode)("button",{class:"btn btn-sm role-primary",disabled:u.disableAdd,onClick:t[2]||(t[2]=(...e)=>u.add&&u.add(...e))},(0,o.toDisplayString)(e.t("generic.add")),9,i)])}var c=a(14220),u=a(89483),p=a(26962),m=a(9980),v=a(88339),h=a(32766),b=a(35664),g=a(4364),f={name:"CSIOnlineExpandValidation",components:{Banner:m.l,InfoBox:p.A,LabeledSelect:u.A},props:{mode:{type:String,default:c.G5},value:{type:Object,default:()=>({})},registerBeforeHook:{type:Function,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;try{await(0,v.kR)({csiDrivers:this.$store.dispatch(`${e}/findAll`,{type:h.Zq})}),this.fetchError=null}catch(t){g.error("Failed to fetch CSI drivers:",t),this.fetchError=this.t("harvester.setting.csiOnlineExpandValidation.failedToLoadDrivers",{error:t.message||t},!0)}},data(){return{configArr:[],parseError:null,fetchError:null}},created(){const e=this.value.value||this.value.default||"{}";this.configArr=this.parseValue(e),this.registerBeforeHook?.(this.willSave,"willSave")},computed:{allErrors(){const e=[];return this.fetchError&&e.push(this.fetchError),this.parseError&&e.push(this.parseError),e},csiDrivers(){if(this.fetchError)return[];const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/all`](h.Zq)||[]},provisioners(){const e=this.configArr.map((({key:e})=>e));return this.csiDrivers.filter((({name:t})=>!e.includes(t))).map((({name:e})=>e))},provisionerValue(){return[{label:"True",value:!0},{label:"False",value:!1}]},disableAdd(){return this.parseError||this.fetchError||this.configArr.length>=this.csiDrivers.length},disableConfigEditing(){return this.parseError||this.fetchError}},watch:{"value.value"(e,t){e!==t&&(this.configArr=this.parseValue(e||"{}"))}},methods:{_convertToBoolean(e){if("boolean"===typeof e)return e;if("string"===typeof e){const t=e.toLowerCase();if("true"===t)return!0;if("false"===t)return!1}return!1},parseValue(e){try{const t=JSON.parse(e);return this.parseError=null,Object.entries(t).map((([e,t])=>({key:e,value:this._convertToBoolean(t)})))}catch(t){return g.error("[CSIOnlineExpandValidation] JSON Parsing Error:",e,t),this.parseError=this.t("harvester.setting.csiOnlineExpandValidation.invalidJsonFormat",{error:t.message},!0),[]}},stringifyConfig(){const e={};return this.configArr.forEach((({key:t,value:a})=>{e[t]=a})),this.configArr.length?JSON.stringify(e):""},update(){this.value.value=this.stringifyConfig()},willSave(){const e=[];return this.configArr.forEach((({key:t})=>{t||e.push(this.t("validation.required",{key:this.t("harvester.setting.csiOnlineExpandValidation.provisioner")},!0))})),this.value.value=this.stringifyConfig(),e.length?Promise.reject(e):Promise.resolve()},useDefault(){this.configArr=this.parseValue(this.value.default||"{}"),this.update()},disableEdit(e){return this.fetchError||e===b.lI},add(){this.disableConfigEditing||this.configArr.push({key:"",value:!0})},remove(e){this.disableConfigEditing||(this.configArr.splice(e,1),this.update())},onValueChange(e,t){if(this.disableConfigEditing)return;const a="true"===t||"false"!==t&&t;this.configArr[e].value=a,this.update()}}},k=(a(31729),a(47433));const y=(0,k.A)(f,[["render",d],["__scopeId","data-v-0083bb1a"]]);var N=y},59392:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("UnitInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.terminationGracePeriodSeconds,"onUpdate:value":[t[0]||(t[0]=e=>n.terminationGracePeriodSeconds=e),i.update],valueModifiers:{number:!0},suffix:1===n.terminationGracePeriodSeconds?"Second":"Seconds",label:e.t("harvester.virtualMachine.terminationGracePeriodSeconds.label"),mode:e.mode},null,8,["value","suffix","label","mode","onUpdate:value"])])])}var n=a(91825),i=a(73344),d={name:"DefaultVMTerminationGracePeriodSeconds",components:{UnitInput:i.A},mixins:[n.A],data(){return{terminationGracePeriodSeconds:this.value.value||this.value.default}},methods:{update(){this.value["value"]=String(this.terminationGracePeriodSeconds)},useDefault(){this["terminationGracePeriodSeconds"]=Number(this.value.default),this.update()}}},c=a(47433);const u=(0,c.A)(d,[["render",s]]);var p=u},76143:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"col span-12"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("t"),d=(0,o.resolveComponent)("Banner"),c=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(d,{color:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{k:"harvester.setting.httpProxy.warning",raw:!0})])),_:1}),(0,o.createElementVNode)("div",{class:"row",onInput:t[3]||(t[3]=(...e)=>n.update&&n.update(...e))},[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:s.parseDefaultValue.httpProxy,"onUpdate:value":t[0]||(t[0]=e=>s.parseDefaultValue.httpProxy=e),class:"mb-20",mode:e.mode,label:"http-proxy"},null,8,["value","mode"]),(0,o.createVNode)(c,{value:s.parseDefaultValue.httpsProxy,"onUpdate:value":t[1]||(t[1]=e=>s.parseDefaultValue.httpsProxy=e),class:"mb-20",mode:e.mode,label:"https-proxy"},null,8,["value","mode"]),(0,o.createVNode)(c,{value:s.parseDefaultValue.noProxy,"onUpdate:value":t[2]||(t[2]=e=>s.parseDefaultValue.noProxy=e),class:"mb-20",mode:e.mode,label:"no-proxy"},null,8,["value","mode"])])],32)])}var s=a(91825),n=a(9980),i=a(79380),d={name:"HarvesterHttpProxy",components:{Banner:n.l,LabeledInput:i.o},mixins:[s.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e,errors:[]}},created(){this.update()},methods:{update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},c=a(47433);const u=(0,c.A)(d,[["render",l]]);var p=u},34058:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var o=a(9274);const r={class:"migration-field"},l=["for"];function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("Banner"),c=(0,o.resolveComponent)("LabeledInput"),u=(0,o.resolveComponent)("UnitInput"),p=(0,o.resolveComponent)("RadioGroup");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[n.parseError?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,color:"error"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(n.parseError),1)])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:n.migration.parallelMigrationsPerCluster,"onUpdate:value":t[0]||(t[0]=e=>n.migration.parallelMigrationsPerCluster=e),valueModifiers:{number:!0},label:e.t("harvester.setting.kubevirtMigration.parallelMigrationsPerCluster"),type:"number",min:"1"},null,8,["value","label"]),(0,o.createVNode)(c,{value:n.migration.parallelOutboundMigrationsPerNode,"onUpdate:value":t[1]||(t[1]=e=>n.migration.parallelOutboundMigrationsPerNode=e),valueModifiers:{number:!0},label:e.t("harvester.setting.kubevirtMigration.parallelOutboundMigrationsPerNode"),type:"number",min:"1"},null,8,["value","label"]),(0,o.createVNode)(u,{value:n.migration.bandwidthPerMigration,"onUpdate:value":t[2]||(t[2]=e=>n.migration.bandwidthPerMigration=e),min:"0",label:e.t("harvester.setting.kubevirtMigration.bandwidthPerMigration"),mode:e.mode,suffix:n.MEBIBYTE,tooltip:e.t("harvester.setting.kubevirtMigration.bandwidthPerMigrationTooltip",e._,!0)},null,8,["value","label","mode","suffix","tooltip"]),(0,o.createVNode)(u,{value:n.migration.completionTimeoutPerGiB,"onUpdate:value":t[3]||(t[3]=e=>n.migration.completionTimeoutPerGiB=e),label:e.t("harvester.setting.kubevirtMigration.completionTimeoutPerGiB"),mode:e.mode,suffix:1===n.migration.completionTimeoutPerGiB?"Second":"Seconds",min:"10"},null,8,["value","label","mode","suffix"]),(0,o.createVNode)(u,{value:n.migration.progressTimeout,"onUpdate:value":t[4]||(t[4]=e=>n.migration.progressTimeout=e),label:e.t("harvester.setting.kubevirtMigration.progressTimeout"),mode:e.mode,suffix:1===n.migration.progressTimeout?"Second":"Seconds",min:"10"},null,8,["value","label","mode","suffix"]),((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(["allowAutoConverge","allowPostCopy","unsafeMigrationOverride","allowWorkloadDisruption","disableTLS","matchSELinuxLevelOnMigration"],(t=>(0,o.createElementVNode)("div",{key:t},[(0,o.createElementVNode)("label",{class:"mb-5",for:t},(0,o.toDisplayString)(e.t(`harvester.setting.kubevirtMigration.${t}`)),9,l),(0,o.createVNode)(p,{id:t,value:n.migration[t],"onUpdate:value":e=>n.migration[t]=e,options:[{label:e.t("advancedSettings.edit.trueOption"),value:!0},{label:e.t("advancedSettings.edit.falseOption"),value:!1}]},null,8,["id","value","onUpdate:value","options"])]))),64))])])}var n=a(79380),i=a(10196),d=a(73344),c=a(84757),u=a(9980),p=a(4364),m={name:"KubevirtMigration",components:{LabeledInput:n.o,UnitInput:d.A,RadioGroup:i.z,Banner:u.l},props:{registerBeforeHook:{type:Function,required:!0},value:{type:Object,default:()=>({value:"",default:"{}"})}},data(){const e=this.parseJSON(this.value?.value)||this.parseJSON(this.value?.default)||{};return{MEBIBYTE:c.gJ,migration:e,parseError:null}},created(){this.registerBeforeHook?.(this.willSave,"willSave")},methods:{parseJSON(e){try{return JSON.parse(e)}catch(t){return this.parseError=this.t("kubevirtMigration.parseError",{error:t.message}),p.error("Failed to parse JSON:",t.message),null}},updateValue(){this.value&&(this.value.value=JSON.stringify(this.migration))},useDefault(){if(this.value?.default){const e=this.parseJSON(this.value.default)||{};this.migration=e,this.updateValue()}},async willSave(){return this.updateValue(),Promise.resolve()}}},v=(a(44684),a(47433));const h=(0,v.A)(m,[["render",s],["__scopeId","data-v-24ae0fbe"]]);var b=h},28436:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("ArrayList");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.parseDefaultValue.ntpServers,"onUpdate:value":[t[0]||(t[0]=e=>n.parseDefaultValue.ntpServers=e),i.update],title:e.t("harvester.host.ntp.label"),protip:e.t("harvester.host.ntp.tips"),"value-placeholder":e.t("harvester.host.ntp.placeholder"),mode:e.mode},null,8,["value","title","protip","value-placeholder","mode","onUpdate:value"])])])}var n=a(91825),i=a(64676),d={name:"HarvesterNtpServersConfig",components:{ArrayList:i.A},mixins:[n.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e={ntpServers:[]}}return{parseDefaultValue:e}},watch:{value:{handler(e){let t;try{t=JSON.parse(e.value)}catch(a){t={ntpServers:[]}}this["parseDefaultValue"]=t,this.update()},deep:!0}},methods:{useDefault(){const e={ntpServers:[]};this["parseDefaultValue"]=e},update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e}}},c=a(47433);const u=(0,c.A)(d,[["render",s]]);var p=u},70726:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("UnitInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.parseDefaultValue.cpu,"onUpdate:value":[t[0]||(t[0]=e=>n.parseDefaultValue.cpu=e),i.update],"label-key":"harvester.generic.cpu",suffix:"%",delay:0,required:"",mode:e.mode,class:"mb-20"},null,8,["value","mode","onUpdate:value"]),(0,o.createVNode)(d,{value:n.parseDefaultValue.memory,"onUpdate:value":[t[1]||(t[1]=e=>n.parseDefaultValue.memory=e),i.update],"label-key":"harvester.generic.memory",suffix:"%",delay:0,required:"",mode:e.mode,class:"mb-20"},null,8,["value","mode","onUpdate:value"]),(0,o.createVNode)(d,{value:n.parseDefaultValue.storage,"onUpdate:value":[t[2]||(t[2]=e=>n.parseDefaultValue.storage=e),i.update],"label-key":"harvester.generic.storage",suffix:"%",delay:0,required:"",mode:e.mode,class:"mb-20"},null,8,["value","mode","onUpdate:value"])])])}var n=a(91825),i=a(73344),d={name:"HarvesterOvercommitConfig",components:{UnitInput:i.A},mixins:[n.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e,errors:[]}},created(){this.update()},methods:{update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},c=a(47433);const u=(0,c.A)(d,[["render",s]]);var p=u},89107:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);const r={class:"row mt-20"},l={class:"col span-12"},s={key:0,class:"row mt-20"},n={class:"col span-12"};function i(e,t,a,i,d,c){const u=(0,o.resolveComponent)("RadioGroup"),p=(0,o.resolveComponent)("FileSelector"),m=(0,o.resolveComponent)("YamlEditor");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(u,{value:d.parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted,"onUpdate:value":[t[0]||(t[0]=e=>d.parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted=e),c.update],label:e.t("harvester.setting.rancherCluster.removeUpstreamClusterWhenNamespaceIsDeleted"),name:"removeUpstreamClusterWhenNamespaceIsDeleted",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","label","labels","onUpdate:value"])])]),d.parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(p,{class:"btn btn-sm bg-primary mb-10",label:e.t("generic.readFromFile"),onSelected:c.onKeySelected},null,8,["label","onSelected"]),(0,o.createVNode)(m,{ref:"yaml",value:d.parseDefaultValue.kubeConfig,"onUpdate:value":[t[1]||(t[1]=e=>d.parseDefaultValue.kubeConfig=e),c.update],class:"yaml-editor","editor-mode":"view"===e.mode?"VIEW_CODE":"EDIT_CODE"},null,8,["value","editor-mode","onUpdate:value"])])])):(0,o.createCommentVNode)("",!0)])}var d=a(91825),c=a(10196),u=a(35664),p=a(99726),m=a(20491),v=a(67850),h={name:"HarvesterRancherCluster",components:{RadioGroup:c.z,FileSelector:m.A,YamlEditor:v.A},mixins:[d.A],props:{value:{type:Object,default:()=>({})},registerBeforeHook:{type:Function,required:!1,default:()=>{}}},data(){let e={};try{const t=this.value.value||this.value.default||"{}",a=JSON.parse(t);e={kubeConfig:"",removeUpstreamClusterWhenNamespaceIsDeleted:a.removeUpstreamClusterWhenNamespaceIsDeleted||!1}}catch(p){e={kubeConfig:"",removeUpstreamClusterWhenNamespaceIsDeleted:!1}}return{parseDefaultValue:e,errors:[],existingSecret:null}},async created(){await this.checkExistingSecret(),this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},methods:{onKeySelected:(0,m.B)("parseDefaultValue.kubeConfig"),update(){this.parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted?this.value["value"]=JSON.stringify({removeUpstreamClusterWhenNamespaceIsDeleted:!0}):this.value["value"]=this.value.default||"{}"},async checkExistingSecret(){const e=this.$store.getters["currentProduct"].inStore;await this.$store.dispatch(`${e}/findAll`,{type:u.bB});const t=this.$store.getters[`${e}/all`](u.bB)||[];if(this.existingSecret=t.find((e=>"rancher-cluster-config"===e.metadata.name&&"harvester-system"===e.metadata.namespace)),this.existingSecret?.data?.kubeConfig){const e=atob(this.existingSecret.data.kubeConfig);this.parseDefaultValue.kubeConfig=e,this.$nextTick((()=>{this.update()}))}},async createOrUpdateRancherKubeConfigSecret(){if(this.errors=[],!this.parseDefaultValue.kubeConfig)return this.errors.push(this.t("validation.required",{key:this.t("harvester.setting.rancherCluster.kubeConfig")},!0)),Promise.reject(this.errors);try{let e;if(this.existingSecret)e=this.existingSecret,e.setData("kubeConfig",this.parseDefaultValue.kubeConfig);else{const t=this.$store.getters["currentProduct"].inStore;e=await this.$store.dispatch(`${t}/create`,{apiVersion:"v1",kind:"Secret",metadata:{name:"rancher-cluster-config",namespace:"harvester-system"},type:"secret",data:{kubeConfig:btoa(this.parseDefaultValue.kubeConfig)}})}return await e.save(),Promise.resolve()}catch(e){return this.errors=(0,p.rz)(e),Promise.reject(this.errors)}},async deleteRancherKubeConfigSecret(){this.existingSecret&&this.existingSecret.remove()},async willSave(){return this.parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted?await this.createOrUpdateRancherKubeConfigSecret():await this.deleteRancherKubeConfigSecret(),Promise.resolve()},useDefault(){this.parseDefaultValue={kubeConfig:"",removeUpstreamClusterWhenNamespaceIsDeleted:!1}}},watch:{"parseDefaultValue.removeUpstreamClusterWhenNamespaceIsDeleted"(e,t){e&&!t&&this.existingSecret?.data?.kubeConfig&&(this.parseDefaultValue.kubeConfig=atob(this.existingSecret.data.kubeConfig))},"parseDefaultValue.kubeConfig"(e){this.$refs.yaml?.updateValue(e)}}},b=(a(58180),a(47433));const g=(0,b.A)(h,[["render",i],["__scopeId","data-v-c0399262"]]);var f=g},54122:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(9274);const r={class:"row mb-20"},l={class:"col span-12"},s={class:"mb-10"},n={class:"chooseFile"},i={class:"row mb-20"},d={class:"col span-12"},c={class:"mb-10"},u={class:"chooseFile"},p={class:"row mb-20"},m={class:"col span-12"},v={class:"mb-10"},h={class:"chooseFile"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("FileSelector");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,(0,o.toDisplayString)(e.t("harvester.setting.sslCertificates.publicCertificate")),1),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(k,{"include-file-name":!0,class:"btn btn-sm bg-primary mr-20",label:"Choose File",onSelected:t[0]||(t[0]=e=>f.onKeySelectedCa("publicCertificate",e))}),(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)({"text-muted":!g.publicCertificateFileName})},(0,o.toDisplayString)(g.publicCertificateFileName?g.publicCertificateFileName:e.t("harvester.generic.noFileChosen")),3)])])]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,(0,o.toDisplayString)(e.t("harvester.setting.sslCertificates.privateKey")),1),(0,o.createElementVNode)("div",u,[(0,o.createVNode)(k,{"include-file-name":!0,class:"btn btn-sm bg-primary mr-20",label:"Choose File",onSelected:t[1]||(t[1]=e=>f.onKeySelectedCa("privateKey",e))}),(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)({"text-muted":!g.privateKeyFileName})},(0,o.toDisplayString)(g.privateKeyFileName?g.privateKeyFileName:e.t("harvester.generic.noFileChosen")),3)])])]),(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,(0,o.toDisplayString)(e.t("harvester.setting.sslCertificates.ca")),1),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(k,{"include-file-name":!0,class:"btn btn-sm bg-primary mr-20",label:"Choose File",onSelected:t[2]||(t[2]=e=>f.onKeySelectedCa("ca",e))}),(0,o.createElementVNode)("span",{class:(0,o.normalizeClass)({"text-muted":!g.caFileName})},(0,o.toDisplayString)(g.caFileName?g.caFileName:e.t("harvester.generic.noFileChosen")),3)])])])])}var g=a(91825),f=a(20491),k={name:"HarvesterSSLCertificates",components:{FileSelector:f.A},mixins:[g.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e,caFileName:"",publicCertificateFileName:"",privateKeyFileName:""}},methods:{onKeySelectedCa(e,t){const{name:a,value:o}=t;this.parseDefaultValue[e]=o,this[`${e}FileName`]=a;const r=JSON.stringify(this.parseDefaultValue);this.value["value"]=r}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},y=(a(92427),a(47433));const N=(0,y.A)(k,[["render",b],["__scopeId","data-v-27a09764"]]);var V=N},13515:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var o=a(9274);const r={class:"row mt-10"},l={class:"col span-12"},s={class:"row mt-20"},n={class:"col span-12"};function i(e,t,a,i,d,c){const u=(0,o.resolveComponent)("LabeledSelect"),p=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(u,{value:d.parsedDefaultValue.protocols,"onUpdate:value":[t[0]||(t[0]=e=>d.parsedDefaultValue.protocols=e),c.update],mode:a.mode,"label-key":"harvester.sslParameters.protocols.label",multiple:!0,options:c.protocolOptions},null,8,["value","mode","options","onUpdate:value"])])]),(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(p,{value:d.parsedDefaultValue.ciphers,"onUpdate:value":[t[1]||(t[1]=e=>d.parsedDefaultValue.ciphers=e),c.update],mode:a.mode,"label-key":"harvester.sslParameters.ciphers.label"},null,8,["value","mode","onUpdate:value"])])])])}var d=a(79380),c=a(14220),u=a(89483),p={name:"HarvesterSslParameters",components:{LabeledInput:d.o,LabeledSelect:u.A},props:{mode:{type:String,default:c.G5},value:{type:Object,default:()=>({})},registerBeforeHook:{type:Function,required:!0}},data(){let e={};try{e=JSON.parse(this.value.value)}catch(a){e=JSON.parse(this.value.default)}const t=e.protocols&&(e.protocols||"").split(" ");return{parsedDefaultValue:{protocols:t,ciphers:e.ciphers}}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},computed:{protocolOptions(){return[{label:"TLSv1.3",value:"TLSv1.3"},{label:"TLSv1.2",value:"TLSv1.2"},{label:`TLSv1.1 (${this.t("generic.deprecated")})`,value:"TLSv1.1"},{label:`TLSv1 (${this.t("generic.deprecated")})`,value:"TLSv1"},{label:`SSLv3 (${this.t("generic.deprecated")})`,value:"SSLv3"},{label:`SSLv2 (${this.t("generic.deprecated")})`,value:"SSLv2"}]}},methods:{update(){const e={protocols:(this.parsedDefaultValue.protocols||[]).join(" "),ciphers:this.parsedDefaultValue.ciphers},t=JSON.stringify(e);this.value["value"]=t},willSave(){const e=[],t=this.parsedDefaultValue.ciphers,a=this.parsedDefaultValue.protocols||[];t&&0===a.length&&e.push(this.t("validation.required",{key:this.t("harvester.sslParameters.protocols.label")},!0)),!t&&a.length>0&&e.push(this.t("validation.required",{key:this.t("harvester.sslParameters.ciphers.label")},!0));const o=/^(:?[A-Z0-9]+(?:-[A-Z0-9]+)+)+$/gm;return!t||t.match(o)&&!t.startsWith(":")||e.push(this.t("validation.invalid",{key:this.t("harvester.sslParameters.ciphers.label")},!0)),e.length>0?Promise.reject(e):Promise.resolve()}},watch:{"value.value":{handler(e){e===this.value.default&&(this.parsedDefaultValue.protocols=[],this.parsedDefaultValue.ciphers="")},deep:!0}}},m=a(47433);const v=(0,m.A)(p,[["render",i]]);var h=v},57589:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return x}});var o=a(9274);const r={key:0},l={class:"box"},s={class:"key"},n={class:"key"},i=["onUpdate:modelValue","placeholder"];function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("t"),m=(0,o.resolveComponent)("Banner"),v=(0,o.resolveComponent)("RadioGroup"),h=(0,o.resolveComponent)("LabeledSelect"),b=(0,o.resolveComponent)("LabeledInput"),g=(0,o.resolveComponent)("Tip"),f=(0,o.resolveComponent)("ArrayList");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(a.mode),"onUpdate:value":t[7]||(t[7]=(...e)=>u.update&&u.update(...e))},[(0,o.createVNode)(m,{color:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{k:"harvester.setting.storageNetwork.warning",raw:!0})])),_:1}),(0,o.createVNode)(v,{value:c.openVlan,"onUpdate:value":[t[0]||(t[0]=e=>c.openVlan=e),u.update],class:"mb-20",name:"model",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","labels","onUpdate:value"]),c.openVlan?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(h,{value:c.networkType,"onUpdate:value":t[1]||(t[1]=e=>c.networkType=e),class:"mb-20",options:u.networkTypes,mode:a.mode,label:e.t("harvester.fields.type"),required:""},null,8,["value","options","mode","label"]),u.showVlan?((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,value:c.parsedDefaultValue.vlan,"onUpdate:value":[t[2]||(t[2]=e=>c.parsedDefaultValue.vlan=e),u.inputVlan],valueModifiers:{number:!0},type:"number",class:"mb-20",mode:a.mode,required:"",placeholder:"e.g. 1 - 4094","label-key":"harvester.setting.storageNetwork.vlan"},null,8,["value","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(h,{value:c.parsedDefaultValue.clusterNetwork,"onUpdate:value":[t[3]||(t[3]=e=>c.parsedDefaultValue.clusterNetwork=e),u.update],"label-key":"harvester.setting.storageNetwork.clusterNetwork",class:"mb-20",required:"",options:u.clusterNetworkOptions},null,8,["value","options","onUpdate:value"]),(0,o.createVNode)(b,{value:c.parsedDefaultValue.range,"onUpdate:value":t[4]||(t[4]=e=>c.parsedDefaultValue.range=e),class:"mb-5",mode:a.mode,required:"",placeholder:e.t("harvester.setting.storageNetwork.range.placeholder"),"label-key":"harvester.setting.storageNetwork.range.label"},null,8,["value","mode","placeholder"]),(0,o.createVNode)(g,{class:"mb-20",icon:"icon icon-info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{k:"harvester.setting.storageNetwork.tip",raw:!0,url:u.storageNetworkExampleLink},null,8,["url"])])),_:1}),(0,o.createVNode)(f,{value:c.exclude,"onUpdate:value":[t[6]||(t[6]=e=>c.exclude=e),u.update],"show-header":!0,"default-add-value":c.defaultAddValue,mode:a.mode,"add-label":e.t("harvester.setting.storageNetwork.exclude.addIp")},{"column-headers":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,(0,o.toDisplayString)(e.t("harvester.setting.storageNetwork.exclude.label")),1)])])),columns:(0,o.withCtx)((a=>[(0,o.createElementVNode)("div",n,[(0,o.withDirectives)((0,o.createElementVNode)("input",{"onUpdate:modelValue":e=>a.row.value=e,placeholder:e.t("harvester.setting.storageNetwork.exclude.placeholder"),"onUpdate:value":t[5]||(t[5]=(...e)=>u.update&&u.update(...e))},null,40,i),[[o.vModelText,a.row.value]])])])),_:1},8,["value","default-add-value","mode","add-label","onUpdate:value"])])):(0,o.createCommentVNode)("",!0)],34)}var c=a(79380),u=a(89483),p=a(10196),m=a(64676),v=a(87898),h=a(14220),b=a(9980),g=a(29349),f=a(88339),k=a(35664),y=a(32766),N=a(66242),V=a(3791),C=a(41837);const{L2VLAN:w,UNTAGGED:E}=C.AW;var S={name:"HarvesterEditStorageNetwork",components:{ArrayList:m.A,Tip:g.A,Banner:b.l,LabeledInput:c.o,LabeledSelect:u.A,RadioGroup:p.z},props:{registerBeforeHook:{type:Function,required:!0},mode:{type:String,default:h.G5},value:{type:Object,default:()=>({})}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;await(0,f.kR)({clusterNetworks:this.$store.dispatch(`${e}/findAll`,{type:y.rk.CLUSTER_NETWORK}),vlanStatus:this.$store.dispatch(`${e}/findAll`,{type:y.rk.VLAN_STATUS}),nodes:this.$store.dispatch(`${e}/findAll`,{type:k.NW})})},data(){let e={},t=!1,a=w;try{e=JSON.parse(this.value.value),a="vlan"in e?w:E,t=!0}catch(r){a=w,e={vlan:"",clusterNetwork:"",range:"",exclude:[]}}const o=e?.exclude?.toString().split(",")||[];return{openVlan:t,networkType:a,errors:[],exclude:o,parsedDefaultValue:e,defaultAddValue:""}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},computed:{showVlan(){return this.networkType===w},networkTypes(){const e=[w];return this.untaggedNetworkSettingEnabled&&e.push(E),e},storageNetworkExampleLink(){const e=this.$store.getters["harvester-common/getServerVersion"]();return(0,V.nn)(N.d.STORAGE_NETWORK_EXAMPLE,e)},untaggedNetworkSettingEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("untaggedNetworkSetting")},clusterNetworkOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](y.rk.CLUSTER_NETWORK)||[],a=this.networkType===E?t.filter((e=>"mgmt"!==e.id)):t;return a.map((e=>{const t=!e.isReadyForStorageNetwork;return{label:t?`${e.id} (${this.t("generic.notReady")})`:e.id,value:e.id,disabled:t}}))}},watch:{networkType:{handler(e){this.parsedDefaultValue.clusterNetwork="",e===w?this.parsedDefaultValue.vlan="":delete this.parsedDefaultValue.vlan},deep:!0}},methods:{inputVlan(e){if(""===e)return void(this.parsedDefaultValue.vlan="");const t=Number(e);this.parsedDefaultValue.vlan=t>4094?4094:t<1?1:t},useDefault(){this.openVlan=!1,this.networkType=w,this.parsedDefaultValue={vlan:"",clusterNetwork:"",range:"",exclude:[]}},update(){const e=this.exclude.filter((e=>e));Array.isArray(e)&&e.length>0?this.parsedDefaultValue.exclude=e:delete this.parsedDefaultValue.exclude;const t=JSON.stringify(this.parsedDefaultValue);this.openVlan?this.value["value"]=t:this.value["value"]=""},willSave(){this.update();const e=[];if(!this.openVlan)return Promise.resolve();{const t=!!/^(?:(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(?:[0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\/([1-9]|[1-2]\d|3[0-2])$/.test(this.parsedDefaultValue.range);if(t||e.push(this.t("harvester.setting.storageNetwork.range.invalid",null,!0)),this.networkType!==w||this.parsedDefaultValue.vlan||e.push(this.t("validation.required",{key:this.t("harvester.setting.storageNetwork.vlan")},!0)),this.parsedDefaultValue.clusterNetwork||e.push(this.t("validation.required",{key:this.t("harvester.setting.storageNetwork.clusterNetwork")},!0)),this.exclude){const t=this.exclude.find((e=>!(0,v.z8)(e)));t&&e.push(this.t("harvester.setting.storageNetwork.exclude.invalid",null,!0))}}return e.length>0?Promise.reject(e):Promise.resolve()}}},B=a(47433);const A=(0,B.A)(S,[["render",d]]);var x=A},48749:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"col span-12"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("LabeledInput"),d=(0,o.resolveComponent)("LabeledSelect");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"row",onInput:t[3]||(t[3]=(...e)=>n.update&&n.update(...e))},[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(i,{value:s.parseDefaultValue.repository,"onUpdate:value":t[0]||(t[0]=e=>s.parseDefaultValue.repository=e),class:"mb-20",mode:a.mode,required:"","label-key":"harvester.setting.supportBundleImage.repo"},null,8,["value","mode"]),(0,o.createVNode)(i,{value:s.parseDefaultValue.tag,"onUpdate:value":t[1]||(t[1]=e=>s.parseDefaultValue.tag=e),class:"mb-20",mode:a.mode,required:"","label-key":"harvester.setting.supportBundleImage.tag"},null,8,["value","mode"]),(0,o.createVNode)(d,{value:s.parseDefaultValue.imagePullPolicy,"onUpdate:value":[t[2]||(t[2]=e=>s.parseDefaultValue.imagePullPolicy=e),n.update],class:"mb-20",required:"","label-key":"harvester.setting.supportBundleImage.imagePullPolicy",options:n.imagePolicyOptions},null,8,["value","options","onUpdate:value"])])],32)}var s=a(14220),n=a(79380),i=a(89483),d={name:"HarvesterSupportBundleImage",components:{LabeledInput:n.o,LabeledSelect:i.A},props:{registerBeforeHook:{type:Function,required:!0},mode:{type:String,default:s.G5},value:{type:Object,default:()=>({})}},data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e}},created(){this.update(),this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},computed:{imagePolicyOptions(){return[{label:this.t("generic.imagePullPolicy.always"),value:"Always"},{label:this.t("generic.imagePullPolicy.ifNotPresent"),value:"IfNotPresent"},{label:this.t("generic.imagePullPolicy.never"),value:"Never"}]}},methods:{update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e},willSave(){const e=[];return this.parseDefaultValue.repository||e.push(this.t("validation.required",{key:this.t("harvester.setting.supportBundleImage.repo")},!0)),this.parseDefaultValue.tag||e.push(this.t("validation.required",{key:this.t("harvester.setting.supportBundleImage.tag")},!0)),e.length>0?Promise.reject(e):Promise.resolve()}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},c=a(47433);const u=(0,c.A)(d,[["render",l]]);var p=u},49216:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var o=a(9274);const r={class:"row"},l={class:"col span-12"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("LabeledSelect");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(d,{value:n.namespaces,"onUpdate:value":[t[0]||(t[0]=e=>n.namespaces=e),i.update],loading:n.loading,multiple:!0,"label-key":"nameNsDescription.namespace.label",mode:e.mode,options:i.namespaceOptions},null,8,["value","loading","mode","options","onUpdate:value"])])])}var n=a(35664),i=a(91825),d=a(89483);const c="select_all",u="unselect_all";var p={name:"HarvesterBundleNamespaces",components:{LabeledSelect:d.A},mixins:[i.A],async fetch(){if(this.loading=!0,await this.$store.dispatch("harvester/findAll",{type:n.CU}),this.customSupportBundleFeatureEnabled)try{const e=this.$store.getters["harvester-common/getHarvesterClusterUrl"]("v1/harvester/namespaces?link=supportbundle"),t=await this.$store.dispatch("harvester/request",{url:e});this.defaultNamespaces=t.data||[]}catch(e){this.defaultNamespaces=[]}else this.defaultNamespaces=[];this.loading=!1},data(){const e=this.value?.value||this.value?.default||"",t=e?e.split(","):[];return{namespaces:t,defaultNamespaces:[],loading:!0}},computed:{customSupportBundleFeatureEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("customSupportBundle")},allNamespaces(){return this.$store.getters["harvester/all"](n.CU).map((e=>e.id))},filteredNamespaces(){if(!this.customSupportBundleFeatureEnabled)return this.allNamespaces;const e=this.defaultNamespaces.map((e=>e.id));return this.allNamespaces.filter((t=>!e.includes(t)))},namespaceOptions(){const e=this.filteredNamespaces.map((e=>({label:e,value:e})));if(!this.customSupportBundleFeatureEnabled)return e;const t=this.namespaces.length===this.filteredNamespaces.length&&this.filteredNamespaces.every((e=>this.namespaces.includes(e))),a=t?{label:this.t("harvester.modal.bundle.namespaces.unselectAll"),value:u}:{label:this.t("harvester.modal.bundle.namespaces.selectAll"),value:c};return[a,...e]}},methods:{update(e){e.includes(c)?this.namespaces=[...this.filteredNamespaces]:e.includes(u)?this.namespaces=[]:this.namespaces=e.filter((e=>e!==c&&e!==u)),this.value.value=this.namespaces.join(",")}},watch:{"value.value"(e){const t=e||this.value.default||"";this.namespaces=t?t.split(","):[]}}},m=a(47433);const v=(0,m.A)(p,[["render",s]]);var h=v},14436:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var o=a(9274);const r={class:"col span-12"},l={class:"mb-5"},s={class:"mb-5"},n={key:1,class:"error"};function i(e,t,a,i,d,c){const u=(0,o.resolveComponent)("LabeledSelect"),p=(0,o.resolveComponent)("LabeledInput"),m=(0,o.resolveComponent)("RadioGroup");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",{class:"row",onInput:t[3]||(t[3]=(...e)=>c.update&&c.update(...e))},[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("label",l,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.t("harvester.setting.upgrade.imagePreloadStrategy")),1)]),(0,o.createVNode)(u,{value:d.parseDefaultValue.imagePreloadOption.strategy.type,"onUpdate:value":[t[0]||(t[0]=e=>d.parseDefaultValue.imagePreloadOption.strategy.type=e),c.update],class:"mb-20",mode:e.mode,label:e.t("harvester.setting.upgrade.strategyType"),options:c.strategyOptions},null,8,["value","mode","label","options","onUpdate:value"]),"parallel"===d.parseDefaultValue.imagePreloadOption.strategy.type?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,value:d.parseDefaultValue.imagePreloadOption.strategy.concurrency,"onUpdate:value":t[1]||(t[1]=e=>d.parseDefaultValue.imagePreloadOption.strategy.concurrency=e),valueModifiers:{number:!0},class:"mb-20",mode:e.mode,label:e.t("harvester.setting.upgrade.concurrency"),min:"0",type:"number"},null,8,["value","mode","label"])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("label",s,[(0,o.createElementVNode)("b",null,(0,o.toDisplayString)(e.t("harvester.setting.upgrade.restoreVM")),1)]),(0,o.createVNode)(m,{value:d.parseDefaultValue.restoreVM,"onUpdate:value":[t[2]||(t[2]=e=>d.parseDefaultValue.restoreVM=e),c.update],class:"mb-20",name:"restoreVM",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","labels","onUpdate:value"]),d.errors.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",n,(0,o.toDisplayString)(d.errors[0]),1)):(0,o.createCommentVNode)("",!0)])],32)])}var d=a(91825),c=a(79380),u=a(89483),p=a(10196),m=a(65359),v={name:"HarvesterUpgradeConfig",components:{LabeledInput:c.o,LabeledSelect:u.A,RadioGroup:p.z},mixins:[d.A],data(){let e={};try{e=this.value.value?JSON.parse(this.value.value):JSON.parse(this.value.default)}catch(t){e=JSON.parse(this.value.default)}return e=this.normalizeValue(e),{parseDefaultValue:e,errors:[]}},computed:{...(0,m.L8)({t:"i18n/t"}),strategyOptions(){return[{value:"sequential",label:"sequential"},{value:"skip",label:"skip"},{value:"parallel",label:"parallel"}]}},created(){this.update()},methods:{normalizeValue(e){return e.imagePreloadOption||(e.imagePreloadOption={strategy:{type:"sequential"}}),e.imagePreloadOption.strategy||(e.imagePreloadOption.strategy={type:"sequential"}),e.imagePreloadOption.strategy.type||(e.imagePreloadOption.strategy.type="sequential"),"parallel"===e.imagePreloadOption.strategy.type?"number"!==typeof e.imagePreloadOption.strategy.concurrency&&(e.imagePreloadOption.strategy.concurrency=0):delete e.imagePreloadOption.strategy.concurrency,"boolean"!==typeof e.restoreVM&&(e.restoreVM=!1),e},update(){try{const e=JSON.parse(JSON.stringify(this.parseDefaultValue));e.imagePreloadOption&&e.imagePreloadOption.strategy&&"parallel"!==e.imagePreloadOption.strategy.type&&delete e.imagePreloadOption.strategy.concurrency,this.value["value"]=JSON.stringify(e,null,2),this.errors=[]}catch(e){this.errors=["Invalid JSON"]}}},watch:{value:{handler(e){let t;try{t=JSON.parse(e.value)}catch(a){t=JSON.parse(this.value.default)}t=this.normalizeValue(t),this["parseDefaultValue"]=t,this.update()},deep:!0}}},h=(a(47554),a(47433));const b=(0,h.A)(v,[["render",i],["__scopeId","data-v-0ce3cc75"]]);var g=b},34462:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);const r={class:"col span-12"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("RadioGroup"),d=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"row",onInput:t[2]||(t[2]=(...e)=>n.update&&n.update(...e))},[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(i,{value:s.parseDefaultValue.enable,"onUpdate:value":[t[0]||(t[0]=e=>s.parseDefaultValue.enable=e),n.update],class:"mb-20",name:"model",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","labels","onUpdate:value"]),s.parseDefaultValue.enable?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0,value:s.parseDefaultValue.period,"onUpdate:value":t[1]||(t[1]=e=>s.parseDefaultValue.period=e),valueModifiers:{number:!0},class:"mb-20",mode:e.mode,"label-key":"harvester.setting.vmForceDeletionPolicy.period"},null,8,["value","mode"])):(0,o.createCommentVNode)("",!0)])],32)}var s=a(91825),n=a(79380),i=a(10196),d={name:"HarvesterVMForceDeletePolicy",components:{LabeledInput:n.o,RadioGroup:i.z},mixins:[s.A],data(){let e={};try{e=JSON.parse(this.value.value)}catch(t){e=JSON.parse(this.value.default)}return{parseDefaultValue:e}},created(){this.update()},methods:{update(){const e=JSON.stringify(this.parseDefaultValue);this.value["value"]=e}},watch:{value:{handler(e){const t=JSON.parse(e.value);this["parseDefaultValue"]=t},deep:!0}}},c=(a(86873),a(47433));const u=(0,c.A)(d,[["render",l],["__scopeId","data-v-9dd10f70"]]);var p=u},55348:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("Banner"),i=(0,o.resolveComponent)("RadioGroup"),d=(0,o.resolveComponent)("LabeledSelect"),c=(0,o.resolveComponent)("LabeledInput"),u=(0,o.resolveComponent)("ArrayList");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(s.allErrors,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(n,{key:t,color:"error"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e),1)])),_:2},1024)))),128)),(0,o.createVNode)(i,{value:l.enabled,"onUpdate:value":[t[0]||(t[0]=e=>l.enabled=e),s.update],class:"mb-20",name:"enableMigrationNetwork",options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","labels","onUpdate:value"]),l.enabled?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(d,{value:l.network.clusterNetwork,"onUpdate:value":[t[1]||(t[1]=e=>l.network.clusterNetwork=e),s.update],required:"","label-key":"harvester.setting.vmMigrationNetwork.clusterNetwork",class:"mb-20",mode:a.mode,options:s.clusterNetworkOptions,disabled:s.disableEdit},null,8,["value","mode","options","disabled","onUpdate:value"]),(0,o.createVNode)(c,{value:l.network.vlan,"onUpdate:value":[t[2]||(t[2]=e=>l.network.vlan=e),s.inputVlan],valueModifiers:{number:!0},required:"",type:"number",class:"mb-20",min:1,max:4094,mode:a.mode,placeholder:"e.g. 1 - 4094","label-key":"harvester.setting.vmMigrationNetwork.vlan",disabled:s.disableEdit},null,8,["value","mode","disabled","onUpdate:value"]),(0,o.createVNode)(c,{value:l.network.range,"onUpdate:value":[t[3]||(t[3]=e=>l.network.range=e),s.update],required:"",class:"mb-5",mode:a.mode,placeholder:e.t("harvester.setting.vmMigrationNetwork.range.placeholder"),"label-key":"harvester.setting.vmMigrationNetwork.range.label",disabled:s.disableEdit},null,8,["value","mode","placeholder","disabled","onUpdate:value"]),(0,o.createVNode)(u,{value:l.network.exclude,"onUpdate:value":[t[4]||(t[4]=e=>l.network.exclude=e),s.update],"show-header":!0,"default-add-value":"",mode:a.mode,"add-disabled":s.disableEdit,"add-label":e.t("harvester.setting.vmMigrationNetwork.exclude.addButton"),"value-label":e.t("harvester.setting.vmMigrationNetwork.exclude.label"),"value-placeholder":e.t("harvester.setting.storageNetwork.exclude.placeholder")},null,8,["value","mode","add-disabled","add-label","value-label","value-placeholder","onUpdate:value"])],64)):(0,o.createCommentVNode)("",!0)])}var l=a(79380),s=a(89483),n=a(10196),i=a(9980),d=a(64676),c=a(88339),u=a(87898),p=a(35664),m=a(14220),v=a(32766),h=a(4364);const b={clusterNetwork:"",vlan:"",range:"",exclude:[]};var g={name:"VMMigrationNetwork",components:{LabeledInput:l.o,LabeledSelect:s.A,RadioGroup:n.z,Banner:i.l,ArrayList:d.A},props:{registerBeforeHook:{type:Function,required:!0},mode:{type:String,default:m.G5},value:{type:Object,default:()=>({value:""})}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;try{await(0,c.kR)({clusterNetworks:this.$store.dispatch(`${e}/findAll`,{type:v.rk.CLUSTER_NETWORK}),vlanStatus:this.$store.dispatch(`${e}/findAll`,{type:v.rk.VLAN_STATUS}),nodes:this.$store.dispatch(`${e}/findAll`,{type:p.NW})}),this.fetchError=null}catch(t){h.error("Failed to fetch network data:",t),this.fetchError=this.t("harvester.setting.vmMigrationNetwork.fetchError",{error:t.message||t},!0)}},data(){const{parsed:e,enabled:t,parseError:a}=this.parseInitialValue();return{enabled:t,network:{...b,...e},fetchError:null,parseError:a}},created(){this.registerBeforeHook?.(this.willSave,"willSave")},computed:{allErrors(){return[this.fetchError,this.parseError].filter(Boolean)},clusterNetworkOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](v.rk.CLUSTER_NETWORK)||[];return t.map((e=>({label:e.isReadyForStorageNetwork?e.id:`${e.id} (${this.t("generic.notReady")})`,value:e.id,disabled:!e.isReadyForStorageNetwork})))},disableEdit(){return!(!this.fetchError&&!this.parseError)}},methods:{parseInitialValue(){let e={},t=!1,a=null;try{"string"===typeof this.value.value&&this.value.value.trim()&&(e=JSON.parse(this.value.value),t=!0)}catch(o){h.error("[VMMigrationNetwork] Failed to parse value:",o),a=this.t("harvester.setting.vmMigrationNetwork.parseError",{error:o.message},!0)}return Array.isArray(e.exclude)||(e.exclude=[]),{parsed:e,enabled:t,parseError:a}},clearErrors(){this.fetchError=null,this.parseError=null},inputVlan(e){this.network.vlan=e?Math.min(4094,Math.max(1,Number(e))):"",this.update()},useDefault(){this.network={...b},this.value.value="",this.enabled=!1,this.clearErrors()},update(){try{this.value.value=this.enabled?JSON.stringify({...this.network,exclude:(this.network.exclude||[]).filter((e=>!!e?.trim()))}):""}catch(e){h.error("Failed to stringify network config:",e),this.value.value=""}},validateInputs(){const e=[];if(this.network.clusterNetwork||e.push(this.t("validation.required",{key:this.t("harvester.setting.vmMigrationNetwork.clusterNetwork")},!0)),this.network.range?(0,u.z8)(this.network.range)||e.push(this.t("harvester.setting.vmMigrationNetwork.range.invalid",null,!0)):e.push(this.t("validation.required",{key:this.t("harvester.setting.vmMigrationNetwork.range.label")},!0)),""===this.network.vlan)e.push(this.t("validation.required",{key:this.t("harvester.setting.vmMigrationNetwork.vlan")},!0));else{const t=Number(this.network.vlan);(isNaN(t)||t<1||t>4094)&&e.push(this.t("validation.between",{key:this.t("harvester.setting.vmMigrationNetwork.vlan"),min:1,max:4094},!0))}for(const t of this.network.exclude||[])t&&!(0,u.z8)(t)&&e.push(this.t("harvester.setting.storageNetwork.exclude.invalid",{value:t},!0));return e},async willSave(){if(!this.enabled)return this.useDefault(),Promise.resolve();this.update();const e=this.validateInputs();return e.length?Promise.reject(e):Promise.resolve()}}},f=a(47433);const k=(0,f.A)(g,[["render",r]]);var y=k},48387:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var o=a(9274);const r={class:"text-default-text"},l={class:"pl-10 pr-10"},s={class:"bottom"},n={class:"buttons"};function i(e,t,a,i,d,c){const u=(0,o.resolveComponent)("Banner"),p=(0,o.resolveComponent)("AsyncButton"),m=(0,o.resolveComponent)("Card"),v=(0,o.resolveComponent)("app-modal"),h=(0,o.resolveDirective)("clean-html");return(0,o.openBlock)(),(0,o.createBlock)(v,{class:"restart-modal",name:"restartDialog",width:600,height:"auto","click-to-close":!1,onClose:c.close},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{class:"prompt-restart","show-highlight-border":!1},{title:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("h4",r,null,512),[[h,e.t("harvester.modal.restart.title")]])])),body:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("div",l,null,512),[[h,e.t("harvester.modal.restart.tip")]]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(d.errors,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(u,{key:t,color:"error",label:e},null,8,["label"])))),128))])),actions:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("button",{class:"btn role-secondary mr-10",onClick:t[0]||(t[0]=(...e)=>c.close&&c.close(...e))},(0,o.toDisplayString)(e.t("harvester.modal.restart.cancel")),1),(0,o.createVNode)(p,{mode:"restart",onClick:c.apply},null,8,["onClick"])])])])),_:1})])),_:1},8,["onClose"])}var d=a(65359),c=a(67607),u=a(91364),p=a(9980),m=a(99726),v=a(3679),h=a(4364),b={emits:["close"],components:{AppModal:v.h,Card:u.Z,AsyncButton:c.A,Banner:p.l},props:{vm:{type:Object,required:!0}},data(){return{errors:[],resolve:null}},computed:{...(0,d.L8)({t:"i18n/t"})},methods:{close(){this.resolve(),this.$emit("close")},apply(e){try{this.vm.doActionGrowl("restart",{}),e(!0),this.close()}catch(t){h.error(t),this.errors=(0,m.rz)(t),e(!1)}}}},g=(a(13503),a(47433));const f=(0,g.A)(b,[["render",i],["__scopeId","data-v-0f53a5eb"]]);var k=f},18324:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("NameNsDescription"),i=(0,o.resolveComponent)("LabelValue"),d=(0,o.resolveComponent)("LabeledInput"),c=(0,o.resolveComponent)("Tab"),u=(0,o.resolveComponent)("Tabbed"),p=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(p,{"done-route":e.doneRoute,resource:a.value,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,"finish-button-mode":"enable",onFinish:e.save,onError:t[0]||(t[0]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:a.value,mode:e.mode},null,8,["value","mode"]),(0,o.createVNode)(u,(0,o.mergeProps)(e.$attrs,{class:"mt-15","side-tabs":!0}),{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{name:"profileSpec",label:e.t("harvester.migconfiguration.profileSpec"),weight:1,class:"bordered-table"},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(l.profileSpec,((t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:a},[(0,o.createVNode)(i,{value:s.labelTitle(t),class:"mb-10"},null,8,["value"]),(0,o.createVNode)(d,{value:t.requested,"onUpdate:value":[e=>t.requested=e,e=>s.updateRequested(e,t)],min:0,disabled:s.isView,type:"number",class:"mb-20",label:`${e.t("harvester.migconfiguration.requested")}`},null,8,["value","onUpdate:value","disabled","label"])])))),128))])),_:1},8,["label"])])),_:1},16)])),_:1},8,["done-route","resource","mode","errors","apply-hooks","onFinish"])}var l=a(63209),s=a(42411),n=a(43094),i=a(79380),d=a(40527),c=a(39412),u=a(91825),p={name:"HarvesterEditMIGConfiguration",components:{Tab:s.A,Tabbed:l.A,CruResource:n.A,LabeledInput:i.o,NameNsDescription:d.A,LabelValue:c.A},mixins:[u.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},data(){const{profileSpec:e}=this.value.spec;return{profileSpec:e||[]}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.updateBeforeSave)},computed:{isView(){return"view"===this.mode}},methods:{updateBeforeSave(){delete this.value.metadata.namespace,this.value.spec.enabled=!0},labelTitle(e){return`${e.name} (available : ${this.available(e)})`},available(e){const t=this.value.status?.profileStatus?.find((t=>t.id===e.id))?.available;return t||0},updateRequested(e,t){if(null===e||""===e)return;const a=Number(e),o=this.available(t);t.requested=a<0?0:a>o?o:a}}},m=a(47433);const v=(0,m.A)(p,[["render",r]]);var h=v},26370:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("RadioGroup"),i=(0,o.resolveComponent)("Tab"),d=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createBlock)(d,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{name:"basic",label:e.t("generic.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])),_:1},8,["label"])])),_:1})}var l=a(63209),s=a(42411),n=a(10196),i=a(91825),d={name:"EditGenericAddon",components:{Tabbed:l.A,Tab:s.A,RadioGroup:n.z},mixins:[i.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}}},c=(a(21030),a(47433));const u=(0,c.A)(d,[["render",r],["__scopeId","data-v-24a677c4"]]);var p=u},17438:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("RadioGroup"),i=(0,o.resolveComponent)("Tab"),d=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createBlock)(d,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{name:"basic",label:e.t("harvester.addons.vmImport.titles.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])),_:1},8,["label"])])),_:1})}var l=a(63209),s=a(42411),n=a(10196),i=a(91825),d={name:"EditSeederAddon",components:{Tabbed:l.A,Tab:s.A,RadioGroup:n.z},mixins:[i.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}}},c=(a(19949),a(47433));const u=(0,c.A)(d,[["render",r],["__scopeId","data-v-4b980a18"]]);var p=u},20668:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(n,{resource:a.value,mode:e.mode,errors:e.errors,onFinish:e.save,onError:t[0]||(t[0]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(s.currentComponent),{value:a.value,"register-before-hook":e.registerBeforeHook,mode:e.mode},null,8,["value","register-before-hook","mode"]))])),_:1},8,["resource","mode","errors","onFinish"])}var l=a(91825),s=a(43094),n={name:"EditAddon",components:{CruResource:s.A},mixins:[l.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},computed:{currentComponent(){const e=this.value.metadata.name;try{return a(2467)(`./${e}.vue`).default}catch{return a(26370)["default"]}}}},i=a(47433);const d=(0,i.A)(n,[["render",r]]);var c=d},6633:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var o=a(9274);const r={key:0},l={key:0,class:"row mb-15"},s={class:"col span-6"},n={class:"col span-6"},i={class:"row mb-15"};function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("Banner"),m=(0,o.resolveComponent)("RadioGroup"),v=(0,o.resolveComponent)("LabeledInput"),h=(0,o.resolveComponent)("Tab"),b=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[u.parsingSpecError?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,color:"error",label:e.t("harvester.addons.nvidiaDriverToolkit.parsingSpecError",null,{raw:!0})},null,8,["label"])):((0,o.openBlock)(),(0,o.createBlock)(b,{key:1,"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{name:"basic",label:e.t("harvester.addons.nvidiaDriverToolkit.titles.basic"),weight:1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{value:a.value.spec.enabled,class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")],"onUpdate:value":u.toggleEnable},null,8,["value","mode","labels","onUpdate:value"]),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[c.valuesContentJson.image?((0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(v,{value:c.valuesContentJson.image.repository,"onUpdate:value":t[0]||(t[0]=e=>c.valuesContentJson.image.repository=e),mode:a.mode,required:!0,"label-key":"harvester.addons.nvidiaDriverToolkit.image.repository"},null,8,["value","mode"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(v,{value:c.valuesContentJson.image.tag,"onUpdate:value":t[1]||(t[1]=e=>c.valuesContentJson.image.tag=e),mode:a.mode,required:!0,class:"col span-6","label-key":"harvester.addons.nvidiaDriverToolkit.image.tag"},null,8,["value","mode"])])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{value:c.valuesContentJson.driverLocation,"onUpdate:value":t[2]||(t[2]=e=>c.valuesContentJson.driverLocation=e),mode:a.mode,required:!0,"label-key":"harvester.addons.nvidiaDriverToolkit.driver.location"},null,8,["value","mode"])])])):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])])),_:1}))])}var c=a(82451),u=a.n(c),p=a(20246),m=a.n(p),v=a(76978),h=a(63209),b=a(42411),g=a(10196),f=a(79380),k=a(9980),y=a(91825);const N={image:{repository:"rancher/harvester-nvidia-driver-toolkit"}};var V={name:"EditAddonNvidiaDriverToolkit",components:{Banner:k.l,LabeledInput:f.o,RadioGroup:g.z,Tabbed:h.A,Tab:b.A},mixins:[y.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},data(){return{initSpec:(0,v.o8)(this.value.spec),valuesContentJson:this.parseValuesContent()}},watch:{valuesContentJson:{handler(e){this.update(e)},deep:!0}},computed:{parsingSpecError(){return this.valuesContentJson&&(void 0===this.valuesContentJson.image||void 0===this.valuesContentJson.driverLocation)}},methods:{parseValuesContent(){try{return u()({},N,m().load(this.value.spec.valuesContent))}catch(e){return this.$store.dispatch("growl/fromError",{title:this.$store.getters["i18n/t"]("generic.notification.title.error"),err:e.data||e},{root:!0}),N}},toggleEnable(e){this.resetSpec(),this.value.spec.enabled=e},resetSpec(){this.value.spec=(0,v.o8)(this.initSpec),this.valuesContentJson=this.parseValuesContent()},update(e){this.value.spec.valuesContent=m().dump(e)}}},C=(a(57010),a(47433));const w=(0,C.A)(V,[["render",d],["__scopeId","data-v-365beeb4"]]);var E=w},55821:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("RadioGroup"),i=(0,o.resolveComponent)("Tab"),d=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createBlock)(d,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{name:"basic",label:e.t("harvester.addons.vmImport.titles.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])),_:1},8,["label"])])),_:1})}var l=a(63209),s=a(42411),n=a(10196),i=a(91825),d={name:"EditAddonPCI",components:{Tabbed:l.A,Tab:s.A,RadioGroup:n.z},mixins:[i.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}}},c=(a(71318),a(47433));const u=(0,c.A)(d,[["render",r],["__scopeId","data-v-bdc3ab06"]]);var p=u},70927:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var o=a(9274);const r={class:"row mt-20"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mt-20"},i={class:"col span-6"},d={class:"col span-6"},c={class:"row mt-20"},u={class:"col span-6"},p={class:"col span-6"},m={class:"row mt-20"},v={class:"col span-6"},h={class:"col span-6"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("RadioGroup"),y=(0,o.resolveComponent)("Tab"),N=(0,o.resolveComponent)("LabeledInput"),V=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createBlock)(V,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{name:"basic",label:e.t("harvester.addons.vmImport.titles.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])),_:1},8,["label"]),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createBlock)(y,{key:0,name:"fluentbit",label:e.t("harvester.logging.configuration.section.fluentbit"),weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentbit.resources.requests.cpu,"onUpdate:value":t[1]||(t[1]=e=>g.valuesContentJson.fluentbit.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentbit.resources.requests.memory,"onUpdate:value":t[2]||(t[2]=e=>g.valuesContentJson.fluentbit.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentbit.resources.limits.cpu,"onUpdate:value":t[3]||(t[3]=e=>g.valuesContentJson.fluentbit.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentbit.resources.limits.memory,"onUpdate:value":t[4]||(t[4]=e=>g.valuesContentJson.fluentbit.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createBlock)(y,{key:1,name:"fluentd",label:e.t("harvester.logging.configuration.section.fluentd"),weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentd.resources.requests.cpu,"onUpdate:value":t[5]||(t[5]=e=>g.valuesContentJson.fluentd.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentd.resources.requests.memory,"onUpdate:value":t[6]||(t[6]=e=>g.valuesContentJson.fluentd.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentd.resources.limits.cpu,"onUpdate:value":t[7]||(t[7]=e=>g.valuesContentJson.fluentd.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(N,{value:g.valuesContentJson.fluentd.resources.limits.memory,"onUpdate:value":t[8]||(t[8]=e=>g.valuesContentJson.fluentd.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1})}var g=a(82451),f=a.n(g),k=a(63209),y=a(42411),N=a(10196),V=a(79380),C=a(91825),w=a(20246),E=a.n(w);const S={fluentbit:{resources:{limits:{cpu:"200m",memory:"200Mi"},requests:{cpu:"50m",memory:"50Mi"}}},fluentd:{resources:{limits:{cpu:"1000m",memory:"800Mi"},requests:{cpu:"100m",memory:"20Mi"}}}};var B={name:"EditAddonLogging",components:{Tabbed:k.A,Tab:y.A,RadioGroup:N.z,LabeledInput:V.o},mixins:[C.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},data(){let e=S;try{e=f()({},S,E().load(this.value.spec.valuesContent))}catch(t){e=S,this.$store.dispatch("growl/fromError",{title:this.$store.getters["i18n/t"]("generic.notification.title.error"),err:t.data||t},{root:!0})}return{valuesContentJson:e}},watch:{valuesContentJson:{handler(e){this.value.spec["valuesContent"]=E().dump(e)},deep:!0,immediate:!0}}},A=(a(82002),a(47433));const x=(0,A.A)(B,[["render",b],["__scopeId","data-v-4ac8f18c"]]);var D=x},59289:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ke}});var o=a(9274);const r=["disabled","href"],l={class:"subtype-content"},s={class:"title"},n={class:"subtype-logo round-image"},i={class:"row"},d={class:"col span-6"},c={class:"col span-6"},u={class:"row mt-10"},p={class:"col span-6"},m={class:"col span-6"},v={class:"row mt-10"},h={class:"col span-12 mt-5"},b={class:"mb-0"},g={class:"row mt-10"},f={class:"col span-6"},k={class:"col span-6"},y={class:"row mt-10"},N={class:"col span-6"},V={class:"col span-6"},C={class:"row mt-10"},w={class:"col span-6"},E={class:"col span-6"},S={class:"row mt-10"},B={class:"col span-6"},A={class:"col span-6"},x=["disabled","href"],D={class:"subtype-content"},M={class:"title"},U={class:"subtype-logo round-image"},T={class:"row mt-10"},I={class:"col span-6"},O={class:"col span-6"},_={class:"row mt-10"},P={class:"col span-6"},$={class:"col span-6"},R=["disabled","href"],L={class:"subtype-content"},q={class:"title"},F={class:"subtype-logo round-image"},H={key:1},G={class:"row mt-10"},j={class:"col span-6"},J={class:"row mt-10"},K={class:"col span-6"},z={class:"col span-6"},W={class:"row mt-10"},Y={class:"col span-6"},Z={class:"col span-6"};function Q(e,t,a,Q,X,ee){const te=(0,o.resolveComponent)("RadioGroup"),ae=(0,o.resolveComponent)("Tab"),oe=(0,o.resolveComponent)("LazyImage"),re=(0,o.resolveComponent)("t"),le=(0,o.resolveComponent)("LabeledInput"),se=(0,o.resolveComponent)("Tabbed"),ne=(0,o.resolveDirective)("clean-tooltip");return(0,o.openBlock)(),(0,o.createBlock)(se,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(ae,{name:"basic",label:e.t("harvester.addons.vmImport.titles.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(te,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])),_:1},8,["label"]),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createBlock)(ae,{key:0,name:"prometheus",label:e.t("harvester.setting.harvesterMonitoring.section.prometheus"),weight:-1},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{disabled:!X.externalLinks.prometheus.enabled,href:X.externalLinks.prometheus.link,target:"_blank",rel:"noopener noreferrer",class:"subtype-banner m-0 mt-10 mb-10"},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(oe,{src:X.externalLinks.prometheus.iconSrc},null,8,["src"])]),(0,o.createElementVNode)("h5",null,[(0,o.createElementVNode)("span",null,[(0,o.createVNode)(re,{k:X.externalLinks.prometheus.label},null,8,["k"])])]),t[23]||(t[23]=(0,o.createElementVNode)("div",{class:"flex-right"},[(0,o.createElementVNode)("i",{class:"icon icon-external-link mr-10"})],-1))])])],8,r)),[[ne,X.externalLinks.prometheus.enabled?void 0:e.t("monitoring.overview.linkedList.na")]]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.scrapeInterval,"onUpdate:value":t[1]||(t[1]=e=>X.valuesContentJson.prometheus.prometheusSpec.scrapeInterval=e),label:e.t("monitoring.prometheus.config.scrape"),tooltip:e.t("harvester.setting.harvesterMonitoring.tips.scrape"),required:!0,mode:a.mode},null,8,["value","label","tooltip","mode"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.evaluationInterval,"onUpdate:value":t[2]||(t[2]=e=>X.valuesContentJson.prometheus.prometheusSpec.evaluationInterval=e),label:e.t("monitoring.prometheus.config.evaluation"),tooltip:e.t("harvester.setting.harvesterMonitoring.tips.evaluation"),required:!0,mode:a.mode},null,8,["value","label","tooltip","mode"])])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.retention,"onUpdate:value":t[3]||(t[3]=e=>X.valuesContentJson.prometheus.prometheusSpec.retention=e),label:e.t("monitoring.prometheus.config.retention"),tooltip:e.t("harvester.setting.harvesterMonitoring.tips.retention"),required:!0,mode:a.mode},null,8,["value","label","tooltip","mode"])]),(0,o.createElementVNode)("div",m,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.retentionSize,"onUpdate:value":t[4]||(t[4]=e=>X.valuesContentJson.prometheus.prometheusSpec.retentionSize=e),label:e.t("monitoring.prometheus.config.retentionSize"),tooltip:e.t("harvester.setting.harvesterMonitoring.tips.retentionSize"),required:!0,mode:a.mode},null,8,["value","label","tooltip","mode"])])]),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createElementVNode)("h4",b,(0,o.toDisplayString)(e.t("monitoring.prometheus.config.resourceLimits")),1)])]),(0,o.createElementVNode)("div",g,[(0,o.createElementVNode)("div",f,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.resources.requests.cpu,"onUpdate:value":t[5]||(t[5]=e=>X.valuesContentJson.prometheus.prometheusSpec.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",k,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.resources.requests.memory,"onUpdate:value":t[6]||(t[6]=e=>X.valuesContentJson.prometheus.prometheusSpec.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",y,[(0,o.createElementVNode)("div",N,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.resources.limits.cpu,"onUpdate:value":t[7]||(t[7]=e=>X.valuesContentJson.prometheus.prometheusSpec.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",V,[(0,o.createVNode)(le,{value:X.valuesContentJson.prometheus.prometheusSpec.resources.limits.memory,"onUpdate:value":t[8]||(t[8]=e=>X.valuesContentJson.prometheus.prometheusSpec.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createBlock)(ae,{key:1,name:"nodeExporter",label:e.t("harvester.setting.harvesterMonitoring.section.prometheusNodeExporter"),weight:-2},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",C,[(0,o.createElementVNode)("div",w,[(0,o.createVNode)(le,{value:ee.prometheusNodeExporter.resources.limits.cpu,"onUpdate:value":t[9]||(t[9]=e=>ee.prometheusNodeExporter.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",E,[(0,o.createVNode)(le,{value:ee.prometheusNodeExporter.resources.limits.memory,"onUpdate:value":t[10]||(t[10]=e=>ee.prometheusNodeExporter.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",S,[(0,o.createElementVNode)("div",B,[(0,o.createVNode)(le,{value:ee.prometheusNodeExporter.resources.requests.cpu,"onUpdate:value":t[11]||(t[11]=e=>ee.prometheusNodeExporter.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",A,[(0,o.createVNode)(le,{value:ee.prometheusNodeExporter.resources.requests.memory,"onUpdate:value":t[12]||(t[12]=e=>ee.prometheusNodeExporter.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),a.value.spec.enabled&&X.valuesContentJson.grafana.resources?((0,o.openBlock)(),(0,o.createBlock)(ae,{key:2,name:"grafana",label:e.t("harvester.setting.harvesterMonitoring.section.grafana"),weight:-3},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{disabled:!X.externalLinks.grafana.enabled,href:X.externalLinks.grafana.link,target:"_blank",rel:"noopener nofollow",class:"subtype-banner m-0 mt-10 mb-10"},[(0,o.createElementVNode)("div",D,[(0,o.createElementVNode)("div",M,[(0,o.createElementVNode)("div",U,[(0,o.createVNode)(oe,{src:X.externalLinks.grafana.iconSrc},null,8,["src"])]),(0,o.createElementVNode)("h5",null,[(0,o.createElementVNode)("span",null,[(0,o.createVNode)(re,{k:X.externalLinks.grafana.label},null,8,["k"])])]),t[24]||(t[24]=(0,o.createElementVNode)("div",{class:"flex-right"},[(0,o.createElementVNode)("i",{class:"icon icon-external-link mr-10"})],-1))])])],8,x)),[[ne,X.externalLinks.grafana.enabled?void 0:e.t("monitoring.overview.linkedList.na")]]),(0,o.createElementVNode)("div",T,[(0,o.createElementVNode)("div",I,[(0,o.createVNode)(le,{value:X.valuesContentJson.grafana.resources.requests.cpu,"onUpdate:value":t[13]||(t[13]=e=>X.valuesContentJson.grafana.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",O,[(0,o.createVNode)(le,{value:X.valuesContentJson.grafana.resources.requests.memory,"onUpdate:value":t[14]||(t[14]=e=>X.valuesContentJson.grafana.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",_,[(0,o.createElementVNode)("div",P,[(0,o.createVNode)(le,{value:X.valuesContentJson.grafana.resources.limits.cpu,"onUpdate:value":t[15]||(t[15]=e=>X.valuesContentJson.grafana.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",$,[(0,o.createVNode)(le,{value:X.valuesContentJson.grafana.resources.limits.memory,"onUpdate:value":t[16]||(t[16]=e=>X.valuesContentJson.grafana.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createBlock)(ae,{key:3,name:"alertmanager",label:e.t("harvester.setting.harvesterMonitoring.section.alertmanager"),weight:-4},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(te,{value:X.valuesContentJson.alertmanager.enabled,"onUpdate:value":t[17]||(t[17]=e=>X.valuesContentJson.alertmanager.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"]),X.valuesContentJson.alertmanager.enabled?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:0,disabled:!X.externalLinks.alertmanager.enabled,href:X.externalLinks.alertmanager.link,target:"_blank",rel:"noopener noreferrer",class:"subtype-banner m-0 mt-10 mb-10"},[(0,o.createElementVNode)("div",L,[(0,o.createElementVNode)("div",q,[(0,o.createElementVNode)("div",F,[(0,o.createVNode)(oe,{src:X.externalLinks.alertmanager.iconSrc},null,8,["src"])]),(0,o.createElementVNode)("h5",null,[(0,o.createElementVNode)("span",null,[(0,o.createVNode)(re,{k:X.externalLinks.alertmanager.label},null,8,["k"])])]),t[25]||(t[25]=(0,o.createElementVNode)("div",{class:"flex-right"},[(0,o.createElementVNode)("i",{class:"icon icon-external-link mr-10"})],-1))])])],8,R)),[[ne,X.externalLinks.alertmanager.enabled?void 0:e.t("monitoring.overview.linkedList.na")]]):(0,o.createCommentVNode)("",!0),X.valuesContentJson.alertmanager.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",H,[(0,o.createElementVNode)("div",G,[(0,o.createElementVNode)("div",j,[(0,o.createVNode)(le,{value:X.valuesContentJson.alertmanager.alertmanagerSpec.retention,"onUpdate:value":t[18]||(t[18]=e=>X.valuesContentJson.alertmanager.alertmanagerSpec.retention=e),label:e.t("monitoring.prometheus.config.retention"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",J,[(0,o.createElementVNode)("div",K,[(0,o.createVNode)(le,{value:X.valuesContentJson.alertmanager.alertmanagerSpec.resources.limits.cpu,"onUpdate:value":t[19]||(t[19]=e=>X.valuesContentJson.alertmanager.alertmanagerSpec.resources.limits.cpu=e),label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",z,[(0,o.createVNode)(le,{value:X.valuesContentJson.alertmanager.alertmanagerSpec.resources.limits.memory,"onUpdate:value":t[20]||(t[20]=e=>X.valuesContentJson.alertmanager.alertmanagerSpec.resources.limits.memory=e),label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",W,[(0,o.createElementVNode)("div",Y,[(0,o.createVNode)(le,{value:X.valuesContentJson.alertmanager.alertmanagerSpec.resources.requests.cpu,"onUpdate:value":t[21]||(t[21]=e=>X.valuesContentJson.alertmanager.alertmanagerSpec.resources.requests.cpu=e),label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",Z,[(0,o.createVNode)(le,{value:X.valuesContentJson.alertmanager.alertmanagerSpec.resources.requests.memory,"onUpdate:value":t[22]||(t[22]=e=>X.valuesContentJson.alertmanager.alertmanagerSpec.resources.requests.memory=e),label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode"])])])])):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1})}var X=a(82451),ee=a.n(X),te=a(3514),ae=a.n(te),oe=a(20246),re=a.n(oe),le=a(88339),se=a(68851),ne=a(79380),ie=a(10196),de=a(12478),ce=a(63209),ue=a(42411),pe=a(91825),me=a(35664);const ve="cattle-monitoring-system",he={prometheus:{prometheusSpec:{resources:{limits:{cpu:"1000m",memory:"3000Mi"},requests:{cpu:"750m",memory:"750Mi"}},evaluationInterval:"1m",scrapeInterval:"1m",retention:"5d",retentionSize:"50GiB"}},"prometheus-node-exporter":{resources:{limits:{cpu:"200m",memory:"180Mi"},requests:{cpu:"100m",memory:"30Mi"}}},grafana:{resources:{limits:{cpu:"200m",memory:"500Mi"},requests:{cpu:"100m",memory:"200Mi"}}},alertmanager:{enabled:!1,alertmanagerSpec:{retention:"120h",resources:{limits:{cpu:"1000m",memory:"600Mi"},requests:{cpu:"100m",memory:"100Mi"}}}}};var be={name:"EditAddonMonitoring",components:{LabeledInput:ne.o,RadioGroup:ie.z,LazyImage:de.A,Tabbed:ce.A,Tab:ue.A},mixins:[pe.A],async fetch(){const{$store:e,externalLinks:t}=this;if(!e.getters["harvester/schemaFor"](me.Hr))return;const a=await(0,le.kR)({endpoints:e.dispatch("harvester/findAll",{type:me.Hr})});if(!ae()(a.endpoints)){const e=t.alertmanager,o=t.grafana,r=t.prometheus,l=(0,se.jq)(a.endpoints,"id",`${ve}/rancher-monitoring-alertmanager`),s=(0,se.jq)(a.endpoints,"id",`${ve}/rancher-monitoring-grafana`),n=(0,se.jq)(a.endpoints,"id",`${ve}/rancher-monitoring-prometheus`);ae()(l)||ae()(l.subsets)||(e.enabled=!0),ae()(s)||ae()(s.subsets)||(o.enabled=!0),ae()(n)||ae()(n.subsets)||(r.enabled=!0)}},props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},data(){const e=a(59826),t=a(91258),o=this.$store.getters["currentCluster"];let r=he;try{r=ee()({},he,re().load(this.value.spec.valuesContent))}catch(l){r=he,this.$store.dispatch("growl/fromError",{title:this.$store.getters["i18n/t"]("generic.notification.title.error"),err:l.data||l},{root:!0})}return{valuesContentJson:r,externalLinks:{alertmanager:{enabled:!1,iconSrc:t,label:"monitoring.overview.linkedList.alertManager.label",description:"monitoring.overview.linkedList.alertManager.description",link:`/k8s/clusters/${o.id}/api/v1/namespaces/${ve}/services/http:rancher-monitoring-alertmanager:9093/proxy`},grafana:{enabled:!1,iconSrc:e,label:"monitoring.overview.linkedList.grafana.label",description:"monitoring.overview.linkedList.grafana.description",link:`/k8s/clusters/${o.id}/api/v1/namespaces/${ve}/services/http:rancher-monitoring-grafana:80/proxy`},prometheus:{enabled:!1,iconSrc:t,label:"monitoring.overview.linkedList.prometheusPromQl.label",description:"monitoring.overview.linkedList.prometheusPromQl.description",link:`/k8s/clusters/${o.id}/api/v1/namespaces/${ve}/services/http:rancher-monitoring-prometheus:9090/proxy`}}}},computed:{prometheusNodeExporter(){return this.valuesContentJson["prometheus-node-exporter"]}},watch:{valuesContentJson:{handler(e){this.value.spec["valuesContent"]=re().dump(e)},deep:!0,immediate:!0}}},ge=(a(18813),a(47433));const fe=(0,ge.A)(be,[["render",Q],["__scopeId","data-v-077b6bf4"]]);var ke=fe},95627:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(9274);const r={class:"row"},l={class:"col span-12"},s={class:"row mb-20"},n={class:"col span-6"},i={class:"col span-6"},d={class:"row mt-20"},c={class:"col span-6"};function u(e,t,a,u,p,m){const v=(0,o.resolveComponent)("RadioGroup"),h=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(v,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"])])]),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(h,{value:p.valuesContentJson.hostname,"onUpdate:value":t[1]||(t[1]=e=>p.valuesContentJson.hostname=e),"label-key":"harvester.addons.rancherVcluster.hostname",required:!0,mode:a.mode,placeholder:"rancher.$vip.nip.io"},null,8,["value","mode"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(h,{value:p.valuesContentJson.rancherVersion,"onUpdate:value":t[2]||(t[2]=e=>p.valuesContentJson.rancherVersion=e),"label-key":"harvester.addons.rancherVcluster.rancherVersion",required:!0,disabled:!0},null,8,["value"])])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(h,{value:p.valuesContentJson.bootstrapPassword,"onUpdate:value":t[3]||(t[3]=e=>p.valuesContentJson.bootstrapPassword=e),"label-key":"harvester.addons.rancherVcluster.password",mode:a.mode,required:!0,type:"password"},null,8,["value","mode"])])])],64)):(0,o.createCommentVNode)("",!0)])}var p=a(82451),m=a.n(p),v=a(20246),h=a.n(v),b=a(79380),g=a(10196);const f={hostname:"",rancherVersion:"",bootstrapPassword:""};var k={name:"EditAddonVcluster",components:{LabeledInput:b.o,RadioGroup:g.z},inheritAttrs:!1,props:{value:{type:Object,required:!0},mode:{type:String,required:!0},registerBeforeHook:{type:Function,required:!0}},data(){let e={};try{e=m()({},f,h().load(this.value.spec.valuesContent))}catch(t){e=f,this.$store.dispatch("growl/fromError",{title:this.$store.getters["i18n/t"]("generic.notification.title.error"),err:t.data||t},{root:!0})}return{valuesContentJson:e}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave")},methods:{willSave(){const e=[];return this.value.spec.enabled?(this.valuesContentJson.hostname||e.push(this.t("validation.required",{key:this.t("harvester.addons.rancherVcluster.hostname")},!0)),this.valuesContentJson.bootstrapPassword||e.push(this.t("validation.required",{key:this.t("harvester.addons.rancherVcluster.password")},!0)),e.length>0?Promise.reject(e):Promise.resolve()):Promise.resolve()}},watch:{valuesContentJson:{handler(e){this.value.spec["valuesContent"]=h().dump(e)},deep:!0,immediate:!0}}},y=(a(11221),a(47433));const N=(0,y.A)(k,[["render",u],["__scopeId","data-v-b9cb7bba"]]);var V=N},32415:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var o=a(9274);const r={key:0},l={class:"row mt-10"},s={class:"col span-6"},n={class:"col span-6"},i={class:"row mt-10"},d={class:"col span-6"},c={class:"col span-6"},u={key:0},p={key:0},m={class:"row mt-10"},v={class:"col span-6"},h={class:"col span-6"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("RadioGroup"),y=(0,o.resolveComponent)("LabeledInput"),N=(0,o.resolveComponent)("LabeledSelect"),V=(0,o.resolveComponent)("Tab"),C=(0,o.resolveComponent)("Tabbed");return(0,o.openBlock)(),(0,o.createBlock)(C,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{name:"basic",label:e.t("harvester.addons.vmImport.titles.basic"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:a.value.spec.enabled,"onUpdate:value":t[0]||(t[0]=e=>a.value.spec.enabled=e),class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels"]),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(y,{value:g.valuesContent.resources.limits.cpu,"onUpdate:value":[t[1]||(t[1]=e=>g.valuesContent.resources.limits.cpu=e),f.update],label:e.t("monitoring.prometheus.config.limits.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode","onUpdate:value"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(y,{value:g.valuesContent.resources.limits.memory,"onUpdate:value":[t[2]||(t[2]=e=>g.valuesContent.resources.limits.memory=e),f.update],label:e.t("monitoring.prometheus.config.limits.memory"),required:!0,mode:a.mode},null,8,["value","label","mode","onUpdate:value"])])]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(y,{value:g.valuesContent.resources.requests.cpu,"onUpdate:value":[t[3]||(t[3]=e=>g.valuesContent.resources.requests.cpu=e),f.update],label:e.t("monitoring.prometheus.config.requests.cpu"),required:!0,mode:a.mode},null,8,["value","label","mode","onUpdate:value"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(y,{value:g.valuesContent.resources.requests.memory,"onUpdate:value":[t[4]||(t[4]=e=>g.valuesContent.resources.requests.memory=e),f.update],label:e.t("monitoring.prometheus.config.requests.memory"),required:!0,mode:a.mode},null,8,["value","label","mode","onUpdate:value"])])]),t[8]||(t[8]=(0,o.createElementVNode)("br",null,null,-1)),(0,o.createElementVNode)("h2",null,(0,o.toDisplayString)(e.t("harvester.addons.vmImport.titles.pvc")),1),a.value.spec.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",u,[(0,o.createVNode)(k,{value:g.valuesContent.pvcClaim.enabled,"onUpdate:value":[t[5]||(t[5]=e=>g.valuesContent.pvcClaim.enabled=e),f.update],class:"mb-20",name:"model",mode:a.mode,options:[!0,!1],labels:[e.t("generic.enabled"),e.t("generic.disabled")]},null,8,["value","mode","labels","onUpdate:value"]),g.valuesContent.pvcClaim.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(y,{value:g.valuesContent.pvcClaim.size,"onUpdate:value":[t[6]||(t[6]=e=>g.valuesContent.pvcClaim.size=e),f.update],label:e.t("harvester.volume.size"),required:!0,mode:a.mode},null,8,["value","label","mode","onUpdate:value"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(N,{value:g.valuesContent.pvcClaim.storageClassName,"onUpdate:value":[t[7]||(t[7]=e=>g.valuesContent.pvcClaim.storageClassName=e),f.update],options:f.storageClassOptions,label:e.t("harvester.storage.storageClass.label"),mode:a.mode,class:"mb-20"},null,8,["value","options","label","mode","onUpdate:value"])])])])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])])),_:1})}var g=a(82451),f=a.n(g),k=a(20246),y=a.n(k),N=a(79380),V=a(63209),C=a(42411),w=a(10196),E=a(89483),S=a(91825),B=a(35664),A=a(88339);const x={resources:{requests:{cpu:"0.5",memory:"2Gi"},limits:{cpu:"2",memory:"4Gi"}},pvcClaim:{enabled:!1,size:"200Gi",storageClassName:""}};var D={name:"EditHarvesterLogging",components:{LabeledInput:N.o,Tabbed:V.A,Tab:C.A,RadioGroup:w.z,LabeledSelect:E.A},mixins:[S.A],props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={storages:this.$store.dispatch(`${e}/findAll`,{type:B.fJ})};await(0,A.kR)(t)},data(){const e=this.parseValuesContent();return{valuesContent:e}},computed:{storageClassOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](B.fJ),a=t.filter((e=>!e.parameters?.backingImage)).map((e=>{const t=e.isDefault?`${e.name} (${this.t("generic.default")})`:e.name;return{label:t,value:e.name}}))||[];return a}},methods:{parseValuesContent(){try{return f()({},x,y().load(this.value.spec.valuesContent))}catch(e){return this.$store.dispatch("growl/fromError",{title:this.$store.getters["i18n/t"]("generic.notification.title.error"),err:e.data||e},{root:!0}),x}},update(){this.value.spec.valuesContent=y().dump(this.valuesContent)},setDefaultClassName(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](B.fJ).find((e=>e.isDefault));this.valuesContent.pvcClaim["storageClassName"]=this.valuesContent?.pvcClaim?.storageClassName||t?.metadata?.name||"longhorn",this.update()}},watch:{"valuesContent.pvcClaim.enabled"(e){e&&this.setDefaultClassName()}}},M=(a(27639),a(47433));const U=(0,M.A)(D,[["render",b],["__scopeId","data-v-7d4cbfa3"]]);var T=U},41690:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);const r={class:"mb-20"},l={class:"resource-yaml"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("NameNsDescription"),c=(0,o.resolveComponent)("LabeledSelect"),u=(0,o.resolveComponent)("YamlEditor"),p=(0,o.resolveComponent)("Tab"),m=(0,o.resolveComponent)("Tabbed"),v=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(v,{"done-route":e.doneRoute,mode:e.mode,resource:e.value,errors:e.errors,"apply-hooks":e.applyHooks,onFinish:e.save,onCancel:e.done,onError:t[3]||(t[3]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{value:e.value,mode:e.mode,namespaced:!0,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(m,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{name:"basics",label:e.t("harvester.host.tabs.basics"),weight:1},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:n.type,"onUpdate:value":t[1]||(t[1]=e=>n.type=e),label:e.t("harvester.cloudTemplate.templateType"),disabled:!e.isCreate,options:i.types},null,8,["value","label","disabled","options"])]),(0,o.createElementVNode)("div",l,[(0,o.createVNode)(u,{ref:"yamlUser",value:n.config,"onUpdate:value":t[2]||(t[2]=e=>n.config=e),class:"yaml-editor","editor-mode":"view"===e.mode?"VIEW_CODE":"EDIT_CODE",onOnChanges:i.update},null,8,["value","editor-mode","onOnChanges"])])])),_:1},8,["label"])])),_:1})])),_:1},8,["done-route","mode","resource","errors","apply-hooks","onFinish","onCancel"])}var n=a(63209),i=a(42411),d=a(43094),c=a(89483),u=a(40527),p=a(67850),m=a(91825),v=a(2602),h={name:"HarvesterEditCloudTemplate",emits:["update:value"],components:{Tab:i.A,Tabbed:n.A,YamlEditor:p.A,CruResource:d.A,LabeledSelect:c.A,NameNsDescription:u.A},mixins:[m.A],inheritAttrs:!1,data(){return{config:this.value.data?.cloudInit||"",type:this.value?.metadata?.labels?.[v.r.CLOUD_INIT]||"user"}},computed:{types(){return[{label:"User Data",value:"user"},{label:"Network Data",value:"network"}]}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.updateBeforeSave)},methods:{update(){this.value.data={cloudInit:this.config}},updateBeforeSave(){this.isCreate&&(this.value.metadata.labels={...this.value.metadata.labels,[v.r.CLOUD_INIT]:this.type},this.value.data={cloudInit:this.config})}}},b=(a(66592),a(47433));const g=(0,b.A)(h,[["render",s],["__scopeId","data-v-1ecffc0e"]]);var f=g},75851:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var o=a(9274);const r={key:3},l={class:"row"},s={class:"col span-12"},n={class:"row mt-10"},i={class:"col span-12"},d={class:"pull-left"},c={class:"pull-right"},u={key:0,class:"row mt-30"},p={class:"col flex span-12"},m={class:"row mt-10"},v={class:"col span-12"},h={class:"row mt-10"},b={key:0,class:"col span-6"},g={key:1,class:"col span-6"};function f(e,t,a,f,k,y){const N=(0,o.resolveComponent)("Banner"),V=(0,o.resolveComponent)("Tags"),C=(0,o.resolveComponent)("RadioGroup"),w=(0,o.resolveComponent)("BadgeState"),E=(0,o.resolveComponent)("LabelValue"),S=(0,o.resolveComponent)("LabeledInput"),B=(0,o.resolveComponent)("LabeledSelect"),A=(0,o.resolveComponent)("ModalWithCard"),x=(0,o.resolveDirective)("clean-tooltip");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:"disk","onUpdate:value":t[7]||(t[7]=(...e)=>y.update&&y.update(...e))},[t[9]||(t[9]=(0,o.createElementVNode)("div",{class:"mt-10"},null,-1)),y.mountedMessage&&y.isProvisioned?((0,o.openBlock)(),(0,o.createBlock)(N,{key:0,color:"error",label:y.mountedMessage},null,8,["label"])):(0,o.createCommentVNode)("",!0),y.isFormatting?((0,o.openBlock)(),(0,o.createBlock)(N,{key:1,color:"info",label:e.t("harvester.host.disk.fileSystem.formatting")},null,8,["label"])):y.isFormatted&&y.isLonghornV1&&!y.isCorrupted?((0,o.openBlock)(),(0,o.createBlock)(N,{key:2,color:"info",label:y.formattedBannerLabel},null,8,["label"])):(0,o.createCommentVNode)("",!0),a.value.isNew?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(V,{value:a.value.tags,"onUpdate:value":t[0]||(t[0]=e=>a.value.tags=e),label:e.t("harvester.host.disk.tags.label"),"add-label":e.t("harvester.host.disk.tags.addLabel"),mode:a.mode},null,8,["value","label","add-label","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(C,{value:a.value.allowScheduling,"onUpdate:value":t[1]||(t[1]=e=>a.value.allowScheduling=e),name:"diskScheduling",label:e.t("harvester.host.disk.allowScheduling.label"),mode:a.mode,options:y.allowSchedulingOptions,row:!0},null,8,["value","label","mode","options"])]),(0,o.createElementVNode)("div",c,[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.host.disk.conditions"))+": ",1),(0,o.withDirectives)((0,o.createVNode)(w,{color:"True"===e.readyCondition.status?"bg-success":"bg-error",icon:"True"===e.readyCondition.status?"icon-checkmark":"icon-warning",label:"Ready",class:"mr-10 ml-10 state"},null,8,["color","icon"]),[[x,e.readyCondition.message]]),(0,o.withDirectives)((0,o.createVNode)(w,{color:"True"===e.schedulableCondition.status&&y.targetDisk?.allowScheduling?"bg-success":"bg-error",icon:"True"===e.schedulableCondition.status&&y.targetDisk?.allowScheduling?"icon-checkmark":"icon-warning",label:"Schedulable",class:"mr-10 state"},null,8,["color","icon"]),[[x,y.schedulableTooltipMessage]]),y.provisionPhase.label?((0,o.openBlock)(),(0,o.createBlock)(w,{key:0,color:y.provisionPhase.color,icon:y.provisionPhase.icon,label:y.provisionPhase.label,class:"mr-10 state"},null,8,["color","icon","label"])):(0,o.createCommentVNode)("",!0)])])]),a.value.isNew?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(E,{name:e.t("harvester.host.disk.storageAvailable.label"),value:a.value.storageAvailable},null,8,["name","value"]),(0,o.createVNode)(E,{name:e.t("harvester.host.disk.storageScheduled.label"),value:a.value.storageScheduled},null,8,["name","value"]),(0,o.createVNode)(E,{name:e.t("harvester.host.disk.storageMaximum.label"),value:a.value.storageMaximum},null,8,["name","value"])])])),t[8]||(t[8]=(0,o.createElementVNode)("hr",{class:"mt-10"},null,-1))])),(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(S,{value:a.value.displayName,"onUpdate:value":t[2]||(t[2]=e=>a.value.displayName=e),label:e.t("generic.name"),disabled:!0},null,8,["value","label"])])]),(0,o.createElementVNode)("div",h,[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)("col span-"+(a.value.isNew?"6":"12"))},[(0,o.createVNode)(B,{value:k.provisioner,"onUpdate:value":t[3]||(t[3]=e=>k.provisioner=e),mode:a.mode,"label-key":"harvester.host.disk.provisioner","localized-label":!0,searchable:!0,options:y.provisioners,disabled:y.isProvisioned||!a.value.isNew,tooltip:y.provisionerTooltip,onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","mode","options","disabled","tooltip","onKeydown"])],2),a.value.isNew&&y.isLonghornV1||y.isCorrupted?((0,o.openBlock)(),(0,o.createElementBlock)("div",b,[(0,o.createVNode)(C,{value:a.value.forceFormatted,"onUpdate:value":t[4]||(t[4]=e=>a.value.forceFormatted=e),mode:a.mode,name:"forceFormatted","label-key":"harvester.host.disk.forceFormatted.label",labels:[e.t("generic.no"),e.t("harvester.host.disk.forceFormatted.yes")],options:[!1,!0],disabled:y.forceFormattedDisabled,"tooltip-key":"harvester.host.disk.forceFormatted.toolTip"},null,8,["value","mode","labels","disabled"])])):(0,o.createCommentVNode)("",!0),a.value.isNew&&y.isLvm?((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createVNode)(B,{value:a.value.lvmVolumeGroup,"onUpdate:value":t[5]||(t[5]=e=>a.value.lvmVolumeGroup=e),mode:a.mode,"label-key":"harvester.host.disk.lvmVolumeGroup.label","localized-label":!0,searchable:!1,taggable:!0,multiple:!1,required:!0,disabled:y.isProvisioned,options:y.lvmVolumeGroups,onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","mode","disabled","options","onKeydown"])])):(0,o.createCommentVNode)("",!0)]),k.isOpen?((0,o.openBlock)(),(0,o.createBlock)(A,{key:4,ref:k.randomStr,name:k.randomStr,width:"30%",onFinish:y.saveCreateVolumeGroup,onClose:y.hideCreateVolumeGroup},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.host.disk.lvmVolumeGroup.label")),1)])),content:(0,o.withCtx)((()=>[(0,o.createVNode)(S,{value:k.volumeGroupDialog,"onUpdate:value":t[6]||(t[6]=e=>k.volumeGroupDialog=e),label:e.t("generic.name"),class:"mb-20",required:"",onKeydown:(0,o.withKeys)((0,o.withModifiers)((()=>{}),["prevent"]),["native","enter"])},null,8,["value","label","onKeydown"])])),_:1},8,["name","onFinish","onClose"])):(0,o.createCommentVNode)("",!0)],32)}var k=a(88339),y=a(35664),N=a(79380),V=a(39412),C=a(41418),w=a(9980),E=a(89483),S=a(10196),B=a(154),A=a(49306),x=a(32766),D=a(2602),M=a(35237),U=a(82877),T=a(24151),I=a(92043),O=a(14220);const _="_NEW";var P={components:{LabeledInput:N.o,LabeledSelect:E.A,LabelValue:V.A,BadgeState:C.j,Banner:w.l,RadioGroup:S.z,ModalWithCard:T.A,Tags:A.A},mixins:[B.A],props:{value:{type:Object,default:()=>({})},disks:{type:Array,default:()=>[]},node:{type:Object,default:()=>({})},mode:{type:String,default:"edit"}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;await(0,k.kR)({csiDrivers:this.$store.dispatch(`${e}/findAll`,{type:y.Zq}),lvmVolumeGroups:this.$store.dispatch(`${e}/findAll`,{type:x.rk.LVM_VOLUME_GROUP})})},data(){let e=`${this.value.provisioner||y.lI}`;return e===y.lI&&(e=`${e}_${this.value.provisionerVersion||y.Zd}`),{provisioner:e,volumeGroupDialog:null,randomStr:(0,I.vx)(10).toLowerCase(),isOpen:!1}},computed:{provisioners(){const e=[],t=this.$store.getters["currentProduct"].inStore,a=this.$store.getters[`${t}/all`](y.Zq)||[];return a.forEach((({name:t})=>{switch(t){case y.lI:e.push({label:`harvester.host.disk.storage.longhorn.${y.Zd}.label`,value:`${t}_${y.Zd}`}),this.longhornSystemVersion!==y.SB&&this.value.provisionerVersion!==y.SB||e.push({label:`harvester.host.disk.storage.longhorn.${y.SB}.label`,value:`${t}_${y.SB}`,disabled:this.forceLonghornV1});break;case U.LVM_DRIVER:e.push({label:"harvester.host.disk.storage.lvm.label",value:t});break}})),e},lvmVolumeGroups(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](x.rk.LVM_VOLUME_GROUP)||[],a=t.filter((e=>e.spec.nodeName===this.node.name)).map((e=>e.spec.vgName));return a.unshift({label:this.t("harvester.host.disk.lvmVolumeGroup.create"),value:_}),a},targetDisk(){return this.disks.find((e=>e.name===this.value.name))},schedulableTooltipMessage(){const{name:e,path:t}=this.value;return this.targetDisk&&!this.targetDisk.allowScheduling&&e&&t?this.t("harvester.host.disk.allowScheduling.tooltip",{name:e,path:t}):this.schedulableCondition.message},allowSchedulingOptions(){return[{label:this.t("generic.enabled"),value:!0},{label:this.t("generic.disabled"),value:!1}]},evictionRequestedOptions(){return[{label:this.t("generic.yes"),value:!0},{label:this.t("generic.no"),value:!1}]},mountedMessage(){const e=this.blockDevice?.metadata?.state||{};return e?.error?e?.message:""},isProvisioned(){return this.blockDevice?.isProvisioned},forceFormattedDisabled(){const e=this.blockDevice?.status?.deviceStatus?.fileSystem.type,t=["ext4","XFS"];return this.blockDevice?.childParts?.length>0||!t.includes(e)&&(!e||!this.canEditPath)},canEditPath(){return!!this.mountedMessage||!(!this.value.isNew||this.value.originPath)},isFormatted(){return!!this.blockDevice?.status?.deviceStatus?.fileSystem?.LastFormattedAt},formattedBannerLabel(){const e=this.blockDevice?.status?.deviceStatus?.fileSystem?.type,t=this.t("harvester.host.disk.lastFormattedAt.info");return e?`${t} ${this.t("harvester.host.disk.fileSystem.info",{system:e})}`:t},provisionPhase(){return this.blockDevice?.provisionPhase||{}},blockDevice(){const e=this.$store.getters["currentProduct"].inStore,t=this.value?.name;return this.$store.getters[`${e}/byId`](x.rk.BLOCK_DEVICE,`${M.LONGHORN_SYSTEM}/${t}`)||{}},isCorrupted(){return this.blockDevice?.status?.deviceStatus?.fileSystem?.corrupted},isFormatting(){return this.blockDevice.isFormatting},longhornSystemVersion(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/byId`](y.oe.SETTINGS,M.LONGHORN_V2_DATA_ENGINE)||{};return"true"===t.value?y.SB:y.Zd},forceLonghornV1(){return"true"===this.node?.labels[D.r.DISABLE_LONGHORN_V2_ENGINE]},isLvm(){return this.value.provisioner===U.LVM_DRIVER},isLonghorn(){return this.value.provisioner===y.lI},isLonghornV1(){return this.isLonghorn&&this.value.provisionerVersion===y.Zd},provisionerTooltip(){return this.mode===O.G5&&this.isLonghorn&&this.longhornSystemVersion===y.SB&&this.forceLonghornV1?this.t("harvester.storage.storageClass.longhorn.versionTooltip"):null}},watch:{provisioner(e){this.randomStr=(0,I.vx)(10).toLowerCase();const[t,a]=e?.split("_");this.value.provisioner=t,t===y.lI?this.value.provisionerVersion=a||y.Zd:this.value.provisionerVersion=void 0},"value.lvmVolumeGroup"(e){e===_&&(this.value.lvmVolumeGroup=null,this.showCreateVolumeGroup())}},methods:{showCreateVolumeGroup(){this.volumeGroupDialog=null,this.isOpen=!0},hideCreateVolumeGroup(){this.isOpen=!1},saveCreateVolumeGroup(e){e(!0),this.value.lvmVolumeGroup=this.volumeGroupDialog,this.hideCreateVolumeGroup()},update(){this.$emit("update:value",this.value)}}},$=(a(5564),a(47433));const R=(0,$.A)(P,[["render",f],["__scopeId","data-v-a5bf4cfc"]]);var L=R},45137:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f},hugepagesTHPDefragMode:function(){return v},hugepagesTHPEnabledMode:function(){return p},hugepagesTHPShmemEnabledMode:function(){return m}});var o=a(9274);const r={class:"row mb-20"},l={class:"col span-4"},s={class:"col span-4"},n={class:"col span-4"};function i(e,t,a,i,d,c){const u=(0,o.resolveComponent)("t"),p=(0,o.resolveComponent)("LabeledSelect");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",null,[t[3]||(t[3]=(0,o.createElementVNode)("hr",{class:"divider"},null,-1)),(0,o.createElementVNode)("h3",null,[(0,o.createVNode)(u,{k:"harvester.host.hugepages.transparent.title",raw:!0,url:c.docsTransparentHugepagesLink},null,8,["url"])]),(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(p,{value:d.spec.transparent.enabled,"onUpdate:value":t[0]||(t[0]=e=>d.spec.transparent.enabled=e),label:e.t("harvester.host.hugepages.transparent.enabled"),options:d.hugepagesTHPEnabledMode},null,8,["value","label","options"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(p,{value:d.spec.transparent.shmemEnabled,"onUpdate:value":t[1]||(t[1]=e=>d.spec.transparent.shmemEnabled=e),label:e.t("harvester.host.hugepages.transparent.shmemEnabled"),options:d.hugepagesTHPShmemEnabledMode},null,8,["value","label","options"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(p,{value:d.spec.transparent.defrag,"onUpdate:value":t[2]||(t[2]=e=>d.spec.transparent.defrag=e),label:e.t("harvester.host.hugepages.transparent.defrag"),options:d.hugepagesTHPDefragMode},null,8,["value","label","options"])])])])])}var d=a(89483),c=a(32766),u=a(66242);const p=[{label:"Always",value:"always"},{label:"Madvise",value:"madvise"},{label:"Never",value:"never"}],m=[{label:"Always",value:"always"},{label:"Within Size",value:"within_size"},{label:"Advise",value:"advise"},{label:"Never",value:"never"},{label:"Deny",value:"deny"},{label:"Force",value:"force"}],v=[{label:"Always",value:"always"},{label:"Defer",value:"defer"},{label:"Defer+Madvise",value:"defer+madvise"},{label:"Madvise",value:"madvise"},{label:"Never",value:"never"}];var h={name:"HarvesterHugepages",components:{LabeledSelect:d.A},props:{node:{type:Object,required:!0},registerBeforeHook:{type:Function,required:!0}},computed:{docsTransparentHugepagesLink(){return u.d.TRANSPARENT_HUGEPAGES}},methods:{async saveHugepages(){this.hugepages["spec"]=this.spec,await this.hugepages.save().catch((e=>{if("error"===e?.type)return this.$store.dispatch("growl/error",{title:this.t("harvester.notification.title.error"),message:e?.message},{root:!0}),Promise.reject(new Error("saveHugepages error"))}))}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t=await this.$store.dispatch(`${e}/findAll`,{type:c.rk.HUGEPAGES});this.hugepages=t.find((e=>e.id===this.node.id)),this.spec=this.hugepages.spec},data(){return{hugepages:{},spec:{transparent:{}},hugepagesTHPEnabledMode:p,hugepagesTHPShmemEnabledMode:m,hugepagesTHPDefragMode:v}},created(){this.registerBeforeHook(this.saveHugepages,"saveHugepages")}},b=a(47433);const g=(0,b.A)(h,[["render",i]]);var f=g},65864:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var o=a(9274);const r={key:0},l={class:"row"},s={class:"col span-6"},n={key:1},i={class:"row mt-10"},d={class:"col span-6"},c={class:"col span-6"},u={class:"row mt-20"},p={class:"col span-6"},m={class:"row mt-20"},v={class:"col span-6"},h={key:0,class:"col span-6 mt-20"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("Banner"),y=(0,o.resolveComponent)("RadioGroup"),N=(0,o.resolveComponent)("LabeledInput"),V=(0,o.resolveComponent)("Checkbox"),C=(0,o.resolveComponent)("LabeledSelect"),w=(0,o.resolveComponent)("NameNsDescription"),E=(0,o.resolveComponent)("ModalWithCard");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[a.inventory.warningMessages.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.inventory.warningMessages,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(k,{key:t,color:"error",label:e.text},null,8,["label"])))),128))])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(y,{value:g.enableInventory,"onUpdate:value":t[0]||(t[0]=e=>g.enableInventory=e),options:[{label:e.t("generic.enabled"),value:!0},{label:e.t("generic.disabled"),value:!1}],mode:a.mode,name:"enableInventory"},null,8,["value","options","mode"])])]),g.enableInventory?((0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(N,{value:g.value.spec.baseboardSpec.connection.host,"onUpdate:value":t[1]||(t[1]=e=>g.value.spec.baseboardSpec.connection.host=e),label:e.t("harvester.seeder.inventory.host.label"),placeholder:e.t("harvester.seeder.inventory.host.placeholder"),mode:a.mode,required:""},null,8,["value","label","placeholder","mode"]),(0,o.createVNode)(V,{value:g.value.spec.baseboardSpec.connection.insecureTLS,"onUpdate:value":t[2]||(t[2]=e=>g.value.spec.baseboardSpec.connection.insecureTLS=e),class:"mt-5",mode:a.mode,label:e.t("harvester.seeder.inventory.insecureTLS.label")},null,8,["value","mode","label"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(N,{value:g.value.spec.baseboardSpec.connection.port,"onUpdate:value":t[3]||(t[3]=e=>g.value.spec.baseboardSpec.connection.port=e),valueModifiers:{number:!0},label:e.t("harvester.seeder.inventory.port.label"),placeholder:e.t("harvester.seeder.inventory.port.placeholder"),mode:a.mode,required:""},null,8,["value","label","placeholder","mode"])])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(C,{value:f.selectedSecret,"onUpdate:value":t[4]||(t[4]=e=>f.selectedSecret=e),label:e.t("harvester.seeder.inventory.secret.label"),mode:a.mode,options:f.secretOption,required:""},null,8,["value","label","mode","options"])])]),(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(y,{value:g.value.spec.events.enabled,"onUpdate:value":t[5]||(t[5]=e=>g.value.spec.events.enabled=e),name:"enabled",options:[!0,!1],label:e.t("harvester.seeder.inventory.event.label"),labels:[e.t("generic.enabled"),e.t("generic.disabled")],mode:a.mode},null,8,["value","label","labels","mode"])])]),g.value.spec.events.enabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createVNode)(N,{value:g.value.spec.events.pollingInterval,"onUpdate:value":t[6]||(t[6]=e=>g.value.spec.events.pollingInterval=e),label:e.t("harvester.seeder.inventory.pollingInterval.label"),mode:a.mode},null,8,["value","label","mode"])])):(0,o.createCommentVNode)("",!0),g.isOpen?((0,o.openBlock)(),(0,o.createBlock)(E,{key:1,width:"80%",errors:g.errors,name:"secretModal",onFinish:f.saveSecret,onClose:f.cancel},{title:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.seeder.inventory.secret.create.title")),1)])),content:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{value:g.secret,namespaced:!0,mode:"create","onUpdate:value":t[7]||(t[7]=t=>e.$emit("update:value",t))},null,8,["value"]),(0,o.createVNode)(N,{value:f.username,"onUpdate:value":t[8]||(t[8]=e=>f.username=e),label:e.t("harvester.virtualMachine.input.username"),class:"mb-20",required:""},null,8,["value","label"]),(0,o.createVNode)(N,{value:f.password,"onUpdate:value":t[9]||(t[9]=e=>f.password=e),type:"password",label:e.t("harvester.virtualMachine.input.password"),class:"mb-20",required:""},null,8,["value","label"])])),_:1},8,["errors","onFinish","onClose"])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0)])}var g=a(89483),f=a(79380),k=a(10196),y=a(42200),N=a(35664),V=a(24151),C=a(40527),w=a(9980),E=a(4514),S=a(99726);const B="_NEW";var A={name:"HarvesterSeeder",emits:["update:value"],components:{Checkbox:y.S,LabeledInput:f.o,LabeledSelect:g.A,RadioGroup:k.z,ModalWithCard:V.A,NameNsDescription:C.A,Banner:w.l},props:{mode:{type:String,required:!0},node:{type:Object,required:!0},registerAfterHook:{type:Function,required:!0},inventory:{type:Object,required:!0}},data(){const e=!!this.inventory?.id;return{enableInventory:e,value:this.inventory,secret:{},errors:[],newSecretSelected:!1,isOpen:!1}},created(){this.registerAfterHook(this.saveInventory,"saveInventory")},async fetch(){const e=this.$store.getters["currentProduct"].inStore;this.secret=await this.$store.dispatch(`${e}/create`,{type:N.bB,data:{username:"",password:""},metadata:{namespace:"",name:"",describe:""}})},computed:{secretOption(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](N.bB).filter((e=>e.data?.username&&e.data?.password)).map((e=>({label:e.id,value:e.id})));return t.unshift({label:this.t("harvester.virtualMachine.createSSHKey"),value:B}),t},selectedSecret:{get(){const e=this.value.spec?.baseboardSpec?.connection?.authSecretRef?.namespace,t=this.value?.spec?.baseboardSpec?.connection?.authSecretRef?.name;return e&&t?`${e}/${t}`:""},set(e){if(e===B)this.newSecretSelected=!0;else{const[t,a]=e.split("/");this.value.spec.baseboardSpec.connection.authSecretRef["namespace"]=t,this.value.spec.baseboardSpec.connection.authSecretRef["name"]=a}}},username:{get(){return(0,E.u)(this.secret?.data?.username)},set(e){this.secret.data["username"]=(0,E.KA)(e)}},password:{get(){return(0,E.u)(this.secret?.data?.password)},set(e){this.secret.data["password"]=(0,E.KA)(e)}}},methods:{async saveInventory(){if(this.enableInventory){const e=[];return this.value.spec.baseboardSpec.connection.host||e.push(this.t("validation.required",{key:this.t("harvester.seeder.inventory.host.label")},!0)),this.value.spec.baseboardSpec.connection.port||e.push(this.t("validation.required",{key:this.t("harvester.seeder.inventory.port.label")},!0)),this.selectedSecret||e.push(this.t("validation.required",{key:this.t("harvester.seeder.inventory.secret.label")},!0)),e.length>0?Promise.reject((0,S.rz)(e)):(this.value.id||(this.value.metadata.annotations["metal.harvesterhci.io/local-node-name"]=this.node.id),this.value.metadata.annotations["metal.harvesterhci.io/local-inventory"]="true",await this.value.save())}return this.value.id?await this.value.remove():Promise.resolve()},show(){this.isOpen=!0},hide(){this.isOpen=!1,this.newSecretSelected=!1},cancel(){this.hide()},async saveSecret(e){if(this.errors=[],this.username||this.errors.push(this.t("validation.required",{key:this.t("harvester.virtualMachine.input.username")},!0)),this.password||this.errors.push(this.t("validation.required",{key:this.t("harvester.virtualMachine.input.password")},!0)),this.errors.length>0)e(!1);else try{const t=await this.secret.save();t.id&&this.secretOption.push({label:t.id,value:t.id}),this.selectedSecret=t.id,e(!0),this.cancel()}catch(t){this.errors=[t.message],e(!1)}}},watch:{newSecretSelected(e){e&&this.show()}}},x=a(47433);const D=(0,x.A)(A,[["render",b]]);var M=D},35237:function(e,t,a){"use strict";a.r(t),a.d(t,{LONGHORN_SYSTEM:function(){return W},LONGHORN_V2_DATA_ENGINE:function(){return Y},default:function(){return ee}});var o=a(9274);const r={key:1,id:"node"},l={class:"content"},s={key:0,class:"row mb-20"},n={class:"col span-12"},i={key:0},d={key:1},c=["onClick"],u={key:1},p={key:1},m={key:2};function v(e,t,a,v,h,b){const g=(0,o.resolveComponent)("Loading"),f=(0,o.resolveComponent)("NameNsDescription"),k=(0,o.resolveComponent)("LabeledInput"),y=(0,o.resolveComponent)("Tab"),N=(0,o.resolveComponent)("Tags"),V=(0,o.resolveComponent)("HarvesterDisk"),C=(0,o.resolveComponent)("ButtonDropdown"),w=(0,o.resolveComponent)("ArrayListGrouped"),E=(0,o.resolveComponent)("HarvesterHugepages"),S=(0,o.resolveComponent)("HarvesterKsmtuned"),B=(0,o.resolveComponent)("HarvesterSeeder"),A=(0,o.resolveComponent)("Banner"),x=(0,o.resolveComponent)("MessageLink"),D=(0,o.resolveComponent)("KeyValue"),M=(0,o.resolveComponent)("Tabbed"),U=(0,o.resolveComponent)("Footer");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0})):((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(f,{value:a.value,namespaced:!1,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(M,{ref:"tabbed",class:"mt-15","side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{name:"basics",weight:100,label:e.t("harvester.host.tabs.basics")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{value:h.customName,"onUpdate:value":t[1]||(t[1]=e=>h.customName=e),label:e.t("harvester.host.detail.customName"),class:"mb-20",mode:e.mode},null,8,["value","label","mode"]),(0,o.createVNode)(k,{value:h.consoleUrl,"onUpdate:value":t[2]||(t[2]=e=>h.consoleUrl=e),label:e.t("harvester.host.detail.consoleUrl"),class:"mb-20",mode:e.mode},null,8,["value","label","mode"])])),_:1},8,["label"]),b.hasBlockDevicesSchema?((0,o.openBlock)(),(0,o.createBlock)(y,{key:0,name:"disk",weight:80,label:e.t("harvester.host.tabs.storage")},{default:(0,o.withCtx)((()=>[b.longhornNode?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(N,{value:b.longhornNode.spec.tags,"onUpdate:value":t[3]||(t[3]=e=>b.longhornNode.spec.tags=e),label:e.t("harvester.host.tags.label"),"add-label":e.t("harvester.host.tags.addLabel"),mode:e.mode},null,8,["value","label","add-label","mode"])])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(w,{value:h.newDisks,"onUpdate:value":t[5]||(t[5]=e=>h.newDisks=e),mode:e.mode,"initial-empty-row":!1},{default:(0,o.withCtx)((t=>[(0,o.createVNode)(V,{value:t.row.value,"onUpdate:value":e=>t.row.value=e,class:"mb-20",mode:e.mode,disks:h.disks,node:a.value},null,8,["value","onUpdate:value","mode","disks","node"])])),add:(0,o.withCtx)((()=>[e.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(C,{key:0,"button-label":e.t("harvester.host.disk.add"),"dropdown-options":h.blockDeviceOpts,size:"sm",selectable:b.selectable,onClickAction:t[4]||(t[4]=e=>b.addDisk(e.value)),onDdButtonAction:b.ddButtonAction},{option:(0,o.withCtx)((e=>["group"===e.kind?((0,o.openBlock)(),(0,o.createElementBlock)("b",i,(0,o.toDisplayString)(e.label),1)):((0,o.openBlock)(),(0,o.createElementBlock)("div",d,(0,o.toDisplayString)(e.label),1))])),_:1},8,["button-label","dropdown-options","selectable","onDdButtonAction"]))])),"remove-button":(0,o.withCtx)((a=>[b.canRemove(a.row,a.i)&&!e.isView?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-link close btn-sm",onClick:()=>b.onRemove(a)},t[6]||(t[6]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,c)):((0,o.openBlock)(),(0,o.createElementBlock)("span",u))])),_:1},8,["value","mode"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),b.hasHugepagesSchema?((0,o.openBlock)(),(0,o.createBlock)(y,{key:1,name:"Hugepages",weight:70,label:e.t("harvester.host.tabs.hugepages")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(E,{node:a.value,"register-before-hook":e.registerBeforeHook},null,8,["node","register-before-hook"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),b.hasKsmtunedSchema?((0,o.openBlock)(),(0,o.createBlock)(y,{key:2,name:"Ksmtuned",weight:70,label:e.t("harvester.host.tabs.ksmtuned")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(S,{mode:e.mode,node:a.value,"register-before-hook":e.registerBeforeHook},null,8,["mode","node","register-before-hook"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),b.hasAddonSchema?((0,o.openBlock)(),(0,o.createBlock)(y,{key:3,name:"seeder",weight:60,label:e.t("harvester.host.tabs.seeder")},{default:(0,o.withCtx)((()=>[b.seederEnabled&&b.hasInventorySchema?((0,o.openBlock)(),(0,o.createBlock)(B,{key:0,mode:e.mode,node:a.value,"register-after-hook":e.registerAfterHook,inventory:h.inventory},null,8,["mode","node","register-after-hook","inventory"])):b.seederEnabled&&!b.hasInventorySchema?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(A,{color:"info",label:e.t("harvester.seeder.banner.noInventory")},null,8,["label"])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[b.hasSeederAddon?((0,o.openBlock)(),(0,o.createBlock)(A,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{to:b.toEnableSeederAddon,"prefix-label":"harvester.seeder.banner.enable.prefix","middle-label":"harvester.seeder.banner.enable.middle","suffix-label":"harvester.seeder.banner.enable.suffix"},null,8,["to"])])),_:1})):((0,o.openBlock)(),(0,o.createBlock)(A,{key:1,color:"warning",label:e.t("harvester.seeder.banner.noAddon")},null,8,["label"]))]))])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(y,{name:"labels","label-key":"harvester.host.tabs.labels"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{key:"labels",value:h.filteredLabels,"add-label":e.t("labels.addLabel"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":b.updateHostLabels},null,8,["value","add-label","mode","onUpdate:value"])])),_:1})])),_:1},512),b.showFormattedWarning?((0,o.openBlock)(),(0,o.createBlock)(A,{key:0,color:"warning",label:e.t("harvester.host.disk.forceFormatted.toolTip")},null,8,["label"])):(0,o.createCommentVNode)("",!0)]),(0,o.createVNode)(U,{class:"footer",mode:e.mode,errors:e.errors,onSave:e.save,onDone:e.done},null,8,["mode","errors","onSave","onDone"])]))}var h=a(65359),b=a(63209),g=a(42411),f=a(77262),k=a(40527),y=a(79380),N=a(31097),V=a(8552),C=a(91825),w=a(2602),E=a(35664),S=a(88339),B=a(95799),A=a(68851),x=a(76978),D=a(99726),M=a(38094),U=a(87619),T=a(96413),I=a(66905),O=a(20652),_=a(84757),P=a(14220),$=a(74302),R=a(9980),L=a(32766),q=a(75851),F=a(65864),H=a(77768),G=a(45137),j=a(49306),J=a(82877),K=a(46343),z=a.n(K);const W="longhorn-system",Y="longhorn-system/v2-data-engine";var Z={name:"HarvesterEditNode",emits:["update:value"],components:{Footer:f.A,Tabbed:b.A,Tab:g.A,LabeledInput:y.o,NameNsDescription:k.A,ArrayListGrouped:N.A,HarvesterDisk:q["default"],HarvesterKsmtuned:H["default"],HarvesterHugepages:G["default"],ButtonDropdown:V.A,KeyValue:M.A,Banner:R.l,Tags:j.A,Loading:U.A,HarvesterSeeder:F["default"],MessageLink:T.A},mixins:[C.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={longhornNodes:this.$store.dispatch(`${e}/findAll`,{type:E.oe.NODES}),blockDevices:this.$store.dispatch(`${e}/findAll`,{type:L.rk.BLOCK_DEVICE}),addons:this.$store.dispatch(`${e}/findAll`,{type:L.rk.ADD_ONS}),secrets:this.$store.dispatch(`${e}/findAll`,{type:E.bB})};this.longhornV2LVMSupport&&(t.longhornV2DataEngine=this.$store.dispatch(`${e}/find`,{type:E.oe.SETTINGS,id:Y})),this.$store.getters[`${e}/schemaFor`](L.rk.INVENTORY)&&(t.inventories=this.$store.dispatch(`${e}/findAll`,{type:L.rk.INVENTORY})),await(0,S.kR)(t);const a=this.$store.getters[`${e}/all`](L.rk.BLOCK_DEVICE),o=a.filter((e=>{const t=e?.spec?.nodeName===this.value.id,a=(0,A.jq)(this.longhornDisks,"name",e.metadata.name);return e?.isProvisioned&&t&&!a})).map((e=>{const t=e?.status?.deviceStatus?.fileSystem?.corrupted;return{isNew:!0,name:e?.metadata?.name,originPath:e?.spec?.fileSystem?.mountPoint,path:e?.spec?.fileSystem?.mountPoint,blockDevice:e,displayName:e?.displayName,forceFormatted:!!t||(e?.spec?.fileSystem?.forceFormatted||!1),provisioner:e?.spec?.provisioner?.lvm?J.LVM_DRIVER:E.lI,provisionerVersion:e?.spec?.provisioner?.longhorn?.engineVersion||E.Zd,lvmVolumeGroup:e?.spec?.provisioner?.lvm?.vgName}})),r=[...this.longhornDisks,...o];this.disks=r,this.newDisks=(0,x.o8)(r),this.blockDeviceOpts=this.getBlockDeviceOpts();const l=this.$store.getters[`${e}/all`](L.rk.ADD_ONS),s=l.find((e=>e.id===`harvester-system/${I.Jo.HARVESTER_SEEDER}`)),n=!!s&&s?.spec?.enabled;if(n){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](L.rk.INVENTORY)||[],a=t.find((e=>e.id===`harvester-system/${this.value.id}`));a?this.inventory=await this.$store.dispatch(`${e}/clone`,{resource:a}):(this.inventory=await this.$store.dispatch(`${e}/create`,{type:L.rk.INVENTORY,metadata:{name:this.value.id,namespace:"harvester-system"}}),this.inventory.applyDefaults())}},data(){const e=this.value.metadata?.annotations?.[w.r.HOST_CUSTOM_NAME]||"",t=this.value.metadata?.annotations?.[w.r.HOST_CONSOLE_URL]||"";return{customName:e,consoleUrl:t,disks:[],newDisks:[],blockDevice:[],blockDeviceOpts:[],filteredLabels:(0,x.o8)(this.value.filteredSystemLabels),inventory:{},originValue:(0,x.o8)(this.value)}},computed:{...(0,h.L8)({t:"i18n/t"}),longhornV2LVMSupport(){return this.$store.getters["harvester-common/getFeatureEnabled"]("longhornV2LVMSupport")},removedDisks(){const e=this.disks.filter((e=>!(0,A.jq)(this.newDisks,"name",e.name)))||[];return e},longhornDisks(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/byId`](E.oe.NODES,`${W}/${this.value.id}`),a=t?.status?.diskStatus||{},o=t?.spec?.disks||{},r={increment:1024,minExponent:3,maxExponent:3,maxPrecision:2,suffix:_.jx},l=Object.keys(a).map((t=>{const l=this.$store.getters[`${e}/byId`](L.rk.BLOCK_DEVICE,`${W}/${t}`);return{...a[t],...o?.[t],name:t,isNew:!1,storageReserved:(0,B.Mo)(o[t]?.storageReserved,r),storageAvailable:(0,B.Mo)(a[t]?.storageAvailable,r),storageMaximum:(0,B.Mo)(a[t]?.storageMaximum,r),storageScheduled:(0,B.Mo)(a[t]?.storageScheduled,r),blockDevice:l,displayName:l?.displayName||t,forceFormatted:l?.spec?.fileSystem?.forceFormatted||!1,tags:o?.[t]?.tags||[],provisioner:l?.spec?.provisioner?.lvm?J.LVM_DRIVER:E.lI,provisionerVersion:l?.spec?.provisioner?.longhorn?.engineVersion||E.Zd,lvmVolumeGroup:l?.spec?.provisioner?.lvm?.vgName}}));return l},showFormattedWarning(){const e=this.newDisks.filter((e=>e.forceFormatted&&e.isNew&&e.provisionerVersion===E.Zd))||[];return e.length>0},hasKsmtunedSchema(){const e=this.$store.getters["currentProduct"].inStore;return!!this.$store.getters[`${e}/schemaFor`](L.rk.KSTUNED)},hasHugepagesSchema(){const e=this.$store.getters["currentProduct"].inStore;return!!this.$store.getters[`${e}/schemaFor`](L.rk.HUGEPAGES)},hasBlockDevicesSchema(){const e=this.$store.getters["currentProduct"].inStore;return!!this.$store.getters[`${e}/schemaFor`](L.rk.BLOCK_DEVICE)},longhornNode(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](E.oe.NODES);return t.find((e=>e.id===`${W}/${this.value.id}`))},seederEnabled(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](L.rk.ADD_ONS),a=t.find((e=>e.id===`harvester-system/${I.Jo.HARVESTER_SEEDER}`));return!!a&&a?.spec?.enabled},toEnableSeederAddon(){const{cluster:e}=this.$router?.currentRoute?.params||{};return{name:`${O.KR}-c-cluster-resource-namespace-id`,params:{resource:`${L.rk.ADD_ONS}`,namespace:"harvester-system",cluster:e,id:`${I.Jo.HARVESTER_SEEDER}`},query:{mode:P.G5}}},hasAddonSchema(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/schemaFor`](L.rk.ADD_ONS)},hasSeederAddon(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](L.rk.ADD_ONS);return t.find((e=>e.id===`harvester-system/${I.Jo.HARVESTER_SEEDER}`))},hasInventorySchema(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/schemaFor`](L.rk.INVENTORY)}},watch:{customName(e){this.value.setAnnotation(w.r.HOST_CUSTOM_NAME,e)},consoleUrl(e){this.value.setAnnotation(w.r.HOST_CONSOLE_URL,e)},newDisks(){this.blockDeviceOpts=this.getBlockDeviceOpts()}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.willSave,"willSave"),this.registerAfterHook&&(this.registerAfterHook(this.saveDisk),this.registerAfterHook(this.saveLonghornNode))},methods:{addDisk(e){const t=(0,A.jq)(this.removedDisks,"blockDevice.id",e);if(t)return this.newDisks.push(t);const a=this.$store.getters["currentProduct"].inStore,o=this.$store.getters[`${a}/byId`](L.rk.BLOCK_DEVICE,e),r=o?.spec?.fileSystem?.mountPoint,l=o?.status?.deviceStatus?.fileSystem?.LastFormattedAt;let s=!0;const n=["ext4","XFS"];o.childParts?.length>0?s=!0:(l||n.includes(o?.status?.deviceStatus?.fileSystem?.type))&&(s=!1);const i=o?.metadata?.name;this.newDisks.push({name:i,path:r,allowScheduling:!1,evictionRequested:!1,storageReserved:0,isNew:!0,originPath:o?.spec?.fileSystem?.mountPoint,blockDevice:o,displayName:o?.displayName,forceFormatted:s,provisioner:E.lI,provisionerVersion:E.Zd,lvmVolumeGroup:null})},async saveDisk(){const e=this.$store.getters["currentProduct"].inStore,t=this.newDisks.filter((e=>e.isNew)),a=this.disks.filter((e=>!(0,A.jq)(this.newDisks,"name",e.name)&&e.blockDevice));if(0===t.length&&0===a.length)return Promise.resolve();if(0!==t.length&&0===a.length){const a=t.filter((t=>{const a=this.$store.getters[`${e}/byId`](L.rk.BLOCK_DEVICE,`${W}/${t.name}`),{forceFormatted:o}=a.spec.fileSystem,{provisioner:r}=a.spec;return!(a.isProvisioned&&o===t.forceFormatted&&z()(r,t.provisioner))}));if(0===a.length)return Promise.resolve()}try{await Promise.all(t.map((t=>{const a=this.$store.getters[`${e}/byId`](L.rk.BLOCK_DEVICE,`${W}/${t.name}`);switch(a.spec.provision=!0,a.spec.fileSystem.forceFormatted=t.forceFormatted,t.provisioner){case E.lI:a.spec.provisioner={longhorn:{engineVersion:t.provisionerVersion}};break;case J.LVM_DRIVER:a.spec.provisioner={lvm:{vgName:t.lvmVolumeGroup}};break}return a.save()}))),await Promise.all(a.map((t=>{const a=this.$store.getters[`${e}/byId`](L.rk.BLOCK_DEVICE,`${W}/${t.name}`);return a.spec.provision=!1,a.save()}))),this.$store.dispatch("growl/success",{title:this.t("generic.notification.title.succeed"),message:this.t("harvester.host.disk.notification.success",{name:this.value.metadata?.name||""})},{root:!0})}catch(o){return Promise.reject((0,D.rz)(o))}},canRemove(e){return!!e?.value?.blockDevice},onRemove(e){e.remove()},updateHostLabels(e){this.filteredLabels=e},selectable(e){return!e.disabled},getBlockDeviceOpts(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](L.rk.BLOCK_DEVICE),a=t.filter((e=>{const t=(0,A.jq)(e?.status?.conditions||[],"type","AddedToNode"),a=(0,A.jq)(this.newDisks,"name",e.metadata.name),o=(0,A.jq)(this.removedDisks,"name",e.metadata.name),r=e.status?.deviceStatus?.details?.deviceType;return"disk"===r&&"Active"===e?.status?.state&&!(((0,A.jq)(this.disks||[],"name",e.metadata.name)||e?.spec?.nodeName!==this.value.id||t&&"False"!==t?.status||e?.isProvisioned||a)&&!o)})).map((e=>{const t=e.spec?.devPath,a=e.status?.deviceStatus?.details?.deviceType,o=e.status?.deviceStatus?.capacity?.sizeBytes,r=(0,B.Mo)(o,{increment:1024,suffix:_.jx}),l=e.status?.deviceStatus?.parentDevice,s=this.newDisks.find((e=>e.blockDevice?.status?.deviceStatus?.parentDevice===t)),n=e.displayName;let i=`${n} (Type: ${a}, Size: ${r})`;return l&&(i=`- ${i}`),{label:i,value:e.id,action:this.addDisk,kind:l?"":"group",disabled:!!s,group:l||t,isParent:!!l}}));return(0,$.Ul)(a,["group","isParent","label"])},ddButtonAction(){this.blockDeviceOpts=this.getBlockDeviceOpts()},willSave(){const e=this.filteredLabels||{};this.value.metadata.labels={...this.value.metadata.labels,...e};const t=this.value.filteredSystemLabels;Object.keys(t).map((t=>{e[t]||delete this.value.metadata.labels[t]}))},async saveLonghornNode(){const e=this.$store.getters["currentProduct"].inStore,t=this.longhornNode?.spec?.disks||{};this.newDisks.map((e=>{(t[e.name]||{}).tags=e.tags,(t[e.name]||{}).allowScheduling=e.allowScheduling}));let a=0;const o=async()=>{try{await this.longhornNode.save()}catch(t){if(409!==t.status&&403!==t.status||!(a<3))return Promise.reject((0,D.rz)(t));a++,await this.$store.dispatch(`${e}/find`,{type:E.oe.NODES,id:this.longhornNode.id,opt:{force:!0}}),await new Promise((e=>setTimeout(e,"5000"))),await o()}};this.longhornNode&&await o()}}},Q=(a(60754),a(47433));const X=(0,Q.A)(Z,[["render",v],["__scopeId","data-v-dfe6cb52"]]);var ee=X},22278:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var o=a(9274);const r={class:"header mb-20"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("FileSelector"),d=(0,o.resolveComponent)("NameNsDescription"),c=(0,o.resolveComponent)("LabeledInput"),u=(0,o.resolveComponent)("Tab"),p=(0,o.resolveComponent)("Tabbed"),m=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(m,{"done-route":e.doneRoute,resource:a.value,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,onFinish:e.save,onError:t[2]||(t[2]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[e.isCreate?((0,o.openBlock)(),(0,o.createBlock)(i,{key:0,class:"btn btn-sm bg-primary mt-10",label:e.t("generic.readFromFile"),accept:".pub",onSelected:n.onKeySelected},null,8,["label","onSelected"])):(0,o.createCommentVNode)("",!0)]),((0,o.openBlock)(),(0,o.createBlock)(d,{ref:"nd",key:s.randomString,value:a.value,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"])),(0,o.createVNode)(p,(0,o.mergeProps)(e.$attrs,{class:"mt-15","side-tabs":!0}),{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{name:"basic",label:e.t("harvester.sshKey.tabs.basics"),weight:1,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{value:s.publicKey,"onUpdate:value":t[1]||(t[1]=e=>s.publicKey=e),type:"multiline",mode:e.mode,"min-height":160,label:e.t("harvester.sshKey.keypair"),required:""},null,8,["value","mode","label"])])),_:1},8,["label"])])),_:1},16)])),_:1},8,["done-route","resource","mode","errors","apply-hooks","onFinish"])}var s=a(63209),n=a(42411),i=a(43094),d=a(79380),c=a(40527),u=a(20491),p=a(92043),m=a(91825),v={name:"HarvesterEditKeypair",emits:["update:value"],components:{Tab:n.A,Tabbed:s.A,CruResource:i.A,LabeledInput:d.o,FileSelector:u.A,NameNsDescription:c.A},mixins:[m.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},data(){return this.value.spec||(this.value.spec={},this.value.metadata={name:""}),{publicKey:this.value.spec.publicKey||"",randomString:""}},watch:{publicKey(e){const t=e.trim();this.value.spec.publicKey=t;const a=t.split(/\s+/);if(3===a.length&&!this.value.metadata.name){const e=a[2];this.randomString=(0,p.vx)(10).toLowerCase(),this.value.metadata.name=e.includes("@")?e.split("@")[0]:e}}},methods:{onKeySelected:(0,u.B)("publicKey")}},h=(a(64308),a(47433));const b=(0,h.A)(v,[["render",l],["__scopeId","data-v-9e3db54e"]]);var g=b},70675:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var o=a(91462),r=a(35664),l=a(45426),s={extends:l.A,created(){this.isCreate&&this.value.type===r.cm.CLUSTER_FLOW&&(this.value.metadata.namespace="cattle-logging-system"),this.registerBeforeHook(this.willSave,"willSave"),this.registerAfterHook((()=>{const e=this.$store.getters["allNamespaces"],t=e.find((e=>"default"===e.id)),a=t?.id||e?.[0]?.id||"";this.value.$dispatch("prefs/set",{key:o.Ri,value:a},{root:!0}),this.willSave()}))}};const n=s;var i=n},17733:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var o=a(91462),r=a(64576),l={extends:r["default"],created(){this.isCreate&&(this.value.metadata.namespace="cattle-logging-system"),this.registerAfterHook((()=>{const e=this.$store.getters["allNamespaces"],t=e.find((e=>"default"===e.id)),a=t?.id||e?.[0]?.id||"";this.value.$dispatch("prefs/set",{key:o.Ri,value:a},{root:!0})}))}};const s=l;var n=s},65647:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("Flow");return(0,o.openBlock)(),(0,o.createBlock)(n,(0,o.normalizeProps)((0,o.guardReactiveProps)(e.$attrs)),null,16)}var l=a(45426),s={components:{Flow:l.A}},n=a(47433);const i=(0,n.A)(s,[["render",r]]);var d=i},64576:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var o=a(9274);const r={class:"output"},l={class:"row"},s={class:"col span-6"},n={class:"row"},i={class:"col span-6"};function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("NameNsDescription"),m=(0,o.resolveComponent)("Banner"),v=(0,o.resolveComponent)("LabeledSelect"),h=(0,o.resolveComponent)("Tab"),b=(0,o.resolveComponent)("YamlEditor"),g=(0,o.resolveComponent)("Labels"),f=(0,o.resolveComponent)("Tabbed"),k=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(k,{"done-route":e.doneRoute,mode:u.cruMode,resource:e.value,subtypes:[],"validation-passed":!0,errors:e.errors,"can-yaml":!0,onError:t[5]||(t[5]=t=>e.errors=t),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[e.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,value:e.value,mode:e.mode,label:"generic.name","register-before-hook":e.registerBeforeHook,namespaced:e.value.type!==c.LOGGING.CLUSTER_OUTPUT,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","register-before-hook","namespaced"])),c.selectedProviders.length>1?((0,o.openBlock)(),(0,o.createBlock)(m,{key:1,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("logging.output.tips.singleProvider")),1)])),_:1})):e.value.allProvidersSupported?((0,o.openBlock)(),(0,o.createBlock)(f,{key:3,ref:"tabbed","side-tabs":!0,onChanged:t[4]||(t[4]=e=>u.tabChanged(e))},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{name:"Output",label:"Output",weight:2},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(v,{value:c.loggingType,"onUpdate:value":t[1]||(t[1]=e=>c.loggingType=e),class:"mb-20",options:u.outputTypeOptions,disabled:!e.isCreate,mode:e.mode,label:e.t("generic.type")},null,8,["value","options","disabled","mode","label"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{value:u.outputProvider,"onUpdate:value":t[2]||(t[2]=e=>u.outputProvider=e),label:"Output",options:c.providers,mode:e.mode},null,8,["value","options","mode"])])]),t[6]||(t[6]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(u.getComponent(c.selectedProvider)),{value:e.value.spec[c.selectedProvider],namespace:e.value.namespace,mode:e.mode},null,8,["value","namespace","mode"]))])),_:1,__:[6]}),(0,o.createVNode)(h,{name:"buffer",label:e.t("logging.output.buffer.label"),weight:1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{ref:"yaml",value:c.bufferYaml,"onUpdate:value":t[3]||(t[3]=e=>c.bufferYaml=e),scrolling:!1,"initial-yaml-values":c.initialBufferYaml,"editor-mode":e.isView?u.EDITOR_MODES.VIEW_CODE:u.EDITOR_MODES.EDIT_CODE,onOnReady:u.onYamlEditorReady},null,8,["value","initial-yaml-values","editor-mode","onOnReady"])])),_:1},8,["label"]),e.isView?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,name:"labels-and-annotations","label-key":"generic.labelsAndAnnotations",weight:0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{"default-container-class":"labels-and-annotations-container",value:e.value,mode:e.mode,"display-side-by-side":!1},null,8,["value","mode"])])),_:1}))])),_:1},512)):((0,o.openBlock)(),(0,o.createBlock)(m,{key:2,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("logging.output.tips.multipleProviders")),1)])),_:1}))])),_:1},8,["done-route","mode","resource","errors","onFinish","onCancel"])])}var c=a(91825),u=a(35664),p=a(63209),m=a(42411),v=a(43094),h=a(40527),b=a(51449),g=a(89483),f=a(9980),k=a(44931),y=a(14220),N=a(76978),V=a(46343),C=a.n(V),w=a(3514),E=a.n(w),S=a(20246),B=a.n(S),A=a(37648),x=a(67850),D=a(66905);const M="Logging/Event",U="Audit Only",T=[M,U];var I={emits:["update:value"],components:{Banner:f.l,CruResource:v.A,Labels:b.A,LabeledSelect:g.A,NameNsDescription:h.A,Tab:m.A,Tabbed:p.A,YamlEditor:x.A},mixins:[c.A],inheritAttrs:!1,async fetch(){const e=this.$store.getters["harvester/all"](u.yx),t=this.$store.getters["harvester/byId"](u.yx,u.cm.OUTPUT),a=await t.fetchResourceFields();let o="";E()(this.value.spec[this.selectedProvider]?.buffer)?a&&(o=(0,A.mH)(e,`io.banzaicloud.logging.v1beta1.Output.spec.${this.selectedProvider}.buffer`,{},!0,1,"",u.cm.OUTPUT),o=o.substring(o.indexOf("\n")+1).replace(/# {2}/g,"#")):o=B().dump(this.value.spec[this.selectedProvider].buffer),o.length&&(this.bufferYaml=o,this.initialBufferYaml=o,this.$refs.yaml.updateValue(this.bufferYaml))},data(){this.isCreate&&(this.value.metadata.namespace="default"),(0,N.hZ)(this.value,"spec",this.value.spec||{});const e=k.PROVIDERS.map((e=>({...e,value:e.name,label:this.t(e.labelKey)}))),t=e.filter((e=>{const t=this.value.spec[e.name],a="forward"===e.name?t?.servers?.[0]||{}:t;return!E()(a)&&!C()(a,e.default)})),a=t?.[0]?.value||e[0].value,o=e.find((e=>e.name===a))?.default||e[0].default;return this.mode!==y.nW&&(0,N.hZ)(this.value.spec,a,this.value.spec[a]||(0,N.o8)(o)),{bufferYaml:"",initialBufferYaml:"",providers:e,selectedProvider:a,hasMultipleProvidersSelected:t.length>1,selectedProviders:t,LOGGING:u.cm,loggingType:this.value.loggingType!==D.UQ.AUDIT?M:U}},computed:{EDITOR_MODES(){return x.j},enabledProviders(){return this.providers.filter((e=>e.enabled))},cruMode(){return this.selectedProviders.length>1||!this.value.allProvidersSupported?y.nW:this.mode},outputTypeOptions(){return T},outputProvider:{get(){return this.selectedProvider},set(e){this.selectedProvider=e;const t=this.providers.find((t=>t.name===e))?.default||{};this.value.spec={[e]:this.value.spec[e]||(0,N.o8)(t)}}}},created(){this.registerBeforeHook(this.willSave,"willSave")},methods:{getComponent(e){return a(28431)(`./${e}`).default},launch(e){this.$refs.tabbed.select(e.name)},willSave(){const e=B().load(this.bufferYaml);E()(e)?delete this.value.spec[this.selectedProvider]["buffer"]:this.value.spec[this.selectedProvider].buffer=e,this.loggingType===U&&(this.value.spec["loggingRef"]="harvester-kube-audit-log-ref")},tabChanged({tab:e}){"buffer"===e.name&&this.$nextTick((()=>{this.$refs.yaml&&(this.$refs.yaml.refresh(),this.$refs.yaml.focus())}))},onYamlEditorReady(e){e.getMode().fold="yamlcomments",e.execCommand("foldAll"),e.execCommand("unfold")}}},O=(a(94547),a(47433));const _=(0,O.A)(I,[["render",d]]);var P=_},36605:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var o=a(9274);const r=["disabled","tooltip"],l={key:0,class:"icon icon-info"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("Loading"),c=(0,o.resolveComponent)("NameNsDescription"),u=(0,o.resolveComponent)("RouteConfig"),p=(0,o.resolveComponent)("Tab"),m=(0,o.resolveComponent)("router-link"),v=(0,o.resolveComponent)("ResourceTable"),h=(0,o.resolveComponent)("Tabbed"),b=(0,o.resolveComponent)("ActionMenu"),g=(0,o.resolveComponent)("CruResource"),f=(0,o.resolveDirective)("clean-tooltip");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(d,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,class:"route","done-route":e.doneRoute,errors:e.errors,mode:e.mode,resource:e.value,subtypes:[],"cancel-event":!0,onError:t[2]||(t[2]=t=>e.errors=t),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{value:e.value,mode:e.mode,namespaced:e.isNamespaced,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","namespaced"]),(0,o.createVNode)(h,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{label:e.t("monitoring.route.label"),weight:1,name:"route"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{value:e.value.spec.route,mode:e.mode,"receiver-options":n.receiverOptions},null,8,["value","mode","receiver-options"])])),_:1},8,["label"]),(0,o.createVNode)(p,{label:e.t("alertmanagerConfigReceiver.receivers"),weight:2,name:"receivers"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{headers:n.receiverTableHeaders,schema:n.receiverSchema,rows:e.value.spec.receivers||[],"get-custom-detail-link":i.getReceiverDetailLink,"table-actions":!1,"custom-actions":e.value.receiverActions,onClickedActionButton:i.setActionMenuState},{"header-button":(0,o.withCtx)((()=>[n.createReceiverLink&&n.createReceiverLink.name?((0,o.openBlock)(),(0,o.createBlock)(m,{key:0,to:e.mode!==n.create?n.createReceiverLink:{}},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{class:"btn role-primary",disabled:e.mode===n.create,tooltip:e.t("monitoring.alertmanagerConfig.disabledReceiverButton")},[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("monitoring.receiver.addReceiver"))+" ",1),e.mode===n.create?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("i",l,null,512)),[[f,e.t("monitoring.alertmanagerConfig.disabledReceiverButton")]]):(0,o.createCommentVNode)("",!0)],8,r)])),_:1},8,["to"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["headers","schema","rows","get-custom-detail-link","custom-actions","onClickedActionButton"])])),_:1},8,["label"])])),_:1}),(0,o.createVNode)(b,{"custom-actions":n.receiverActions,open:n.receiverActionMenuIsOpen,"use-custom-target-element":!0,"custom-target-element":n.actionMenuTargetElement,"custom-target-event":n.actionMenuTargetEvent,onClose:t[1]||(t[1]=e=>n.receiverActionMenuIsOpen=!1),onGoToEdit:i.goToEdit,onGoToEditYaml:i.goToEditYaml,onPromptRemove:i.promptRemove},null,8,["custom-actions","open","custom-target-element","custom-target-event","onGoToEdit","onGoToEditYaml","onPromptRemove"])])),_:1},8,["done-route","errors","mode","resource","onFinish","onCancel"]))}var n=a(43094),i=a(91825),d=a(63209),c=a(42411),u=a(35664),p=a(87619),m=a(40527),v=a(67850),h=a(57e3),b=a(45947),g=a(65633),f=a(80252),k=a(14220),y={emits:["update:value"],components:{ActionMenu:f.A,CruResource:n.A,Loading:p.A,NameNsDescription:m.A,ResourceTable:g.A,RouteConfig:b.A,Tab:c.A,Tabbed:d.A},mixins:[i.A],inheritAttrs:!1,async fetch(){const e=this.$store.getters["currentProduct"].inStore,t=this.value.id,a=await this.$store.dispatch(`${e}/find`,{type:u.Rp.ALERTMANAGERCONFIG,id:t});this.alertmanagerConfigId=t,this.alertmanagerConfigResource=a,this.alertmanagerConfigDetailRoute=a._detailLocation;const o=a.availableActions,r=a.getReceiverActions(o);this.receiverActions=r},data(){this.value.applyDefaults();const e={},t=this.$store.getters["harvester/schemaFor"](u.Rp.SPOOFED.ALERTMANAGERCONFIG_RECEIVER_SPEC),a=this.$store.getters["harvester/schemaFor"](u.Rp.SPOOFED.ALERTMANAGERCONFIG_ROUTE_SPEC),o=(this.value?.spec?.receivers||[]).map((e=>e.name));return{actionMenuTargetElement:null,actionMenuTargetEvent:null,config:k.au,create:k.YQ,createReceiverLink:this.value.getCreateReceiverRoute(),defaultReceiverValues:e,receiverActionMenuIsOpen:!1,receiverTableHeaders:[{name:"name",labelKey:"tableHeaders.name",value:"name",sort:["nameSort"],formatter:"LinkDetail",canBeVariable:!0},{name:"type",labelKey:"tableHeaders.type",value:"name",formatter:"ReceiverIcons",canBeVariable:!0}],newReceiverType:null,receiverActions:[],receiverOptions:o,receiverTypes:h.RECEIVERS_TYPES,routeSchema:a,receiverSchema:t,selectedReceiverName:"",selectedRowValue:null,view:k.nW}},computed:{editorMode(){return this.mode===k.nW?v.j.VIEW_CODE:v.j.EDIT_CODE}},methods:{translateReceiverTypes(){return this.receiverTypes.map((e=>({...e,label:this.t(e.label)})))},getReceiverDetailLink(e){if(e&&e.name)return this.value.getReceiverDetailLink(e.name)},toggleReceiverActionMenu(){this.receiverActionMenuIsOpen=!0},setActionMenuState(e){const{event:t,targetElement:a}=e;if(!t||!a)throw new Error("Could not find action menu target element.");this.actionMenuTargetElement=a,this.actionMenuTargetEvent=t,this.selectedReceiverName=a.id.split("+").slice(2).join(""),this.toggleReceiverActionMenu()},goToEdit(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverConfigRoute(this.selectedReceiverName,k.G5))},goToEditYaml(){this.$router.push(this.alertmanagerConfigResource.getEditReceiverYamlRoute(this.selectedReceiverName,k.G5))},promptRemove(){const e=this.selectedReceiverName,t=this.alertmanagerConfigResource.spec.receivers||[],a=t.filter((t=>t.name!==e));this.alertmanagerConfigResource.spec.receivers=a,this.alertmanagerConfigResource.save(...arguments)}}},N=(a(27589),a(47433));const V=(0,N.A)(y,[["render",s],["__scopeId","data-v-3585e2fe"]]);var C=V},91600:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return H}});var o=a(9274);const r={key:1},l={class:"row mt-10"},s={class:"col trunk-span"},n={class:"col trunk-span"},i={class:"col remove-btn mb-20"},d=["disabled","aria-label","onClick"],c=["disabled"],u={class:"row mt-10"},p={class:"col span-6"},m={key:0,class:"row mt-10"},v={class:"col span-6"},h={key:1,class:"row mt-10"},b={class:"col span-6"},g={class:"col span-6"};function f(e,t,a,f,k,y){const N=(0,o.resolveComponent)("NameNsDescription"),V=(0,o.resolveComponent)("LabeledSelect"),C=(0,o.resolveComponent)("LabeledInput"),w=(0,o.resolveComponent)("Tab"),E=(0,o.resolveComponent)("RadioGroup"),S=(0,o.resolveComponent)("Tabbed"),B=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(B,{"done-route":e.doneRoute,resource:a.value,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,onFinish:y.saveNetwork,onError:t[10]||(t[10]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{ref:"nd",value:a.value,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(S,(0,o.mergeProps)(e.$attrs,{class:"mt-15","side-tabs":!0}),{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{name:"basics",label:e.t("harvester.network.tabs.basics"),weight:99,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{value:k.type,"onUpdate:value":t[1]||(t[1]=e=>k.type=e),class:"mb-20",options:y.networkTypes,mode:e.mode,disabled:e.isEdit,label:e.t("harvester.fields.type"),required:""},null,8,["value","options","mode","disabled","label"]),y.isL2VlanNetwork&&y.l2VlanTrunkModeFeatureEnabled?((0,o.openBlock)(),(0,o.createBlock)(V,{key:0,value:k.l2VlanMode,"onUpdate:value":t[2]||(t[2]=e=>k.l2VlanMode=e),class:"mb-20",options:y.l2VlanModeOptions,mode:e.mode,disabled:e.isEdit,label:e.t("harvester.vlanStatus.vlanConfig.l2VlanMode.label"),required:""},null,8,["value","options","mode","disabled","label"])):(0,o.createCommentVNode)("",!0),y.isL2VlanTrunkMode&&y.l2VlanTrunkModeFeatureEnabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(k.vlanTrunk,((t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:a},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(C,{value:t.minID,"onUpdate:value":[e=>t.minID=e,y.vlanTrunkChange],valueModifiers:{number:!0},class:"mb-20",required:"",placeholder:"e.g. 1-4094",min:1,max:4094,type:"number",label:e.t("harvester.vlanStatus.vlanConfig.vlanTrunk.minId"),mode:e.mode},null,8,["value","onUpdate:value","label","mode"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(C,{value:t.maxID,"onUpdate:value":[e=>t.maxID=e,y.vlanTrunkChange],valueModifiers:{number:!0},class:"mb-20",max:4094,min:1,placeholder:"e.g. 1-4094",required:"",type:"number",label:e.t("harvester.vlanStatus.vlanConfig.vlanTrunk.maxId"),mode:e.mode},null,8,["value","onUpdate:value","label","mode"])]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("button",{type:"button",disabled:e.isView||k.vlanTrunk.length<=1,"aria-label":e.t("generic.ariaLabel.remove",{index:a+1}),role:"button",class:"btn role-link",onClick:e=>y.removeVlanTrunk(t)},(0,o.toDisplayString)(e.t("harvester.fields.remove")),9,d)])])])))),128)),y.isL2VlanTrunkMode?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn btn-sm bg-primary mb-20",disabled:e.isView,onClick:t[3]||(t[3]=(...e)=>y.addVlanTrunk&&y.addVlanTrunk(...e))},(0,o.toDisplayString)(e.t("harvester.vlanStatus.vlanConfig.vlanTrunk.add")),9,c)):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0),y.isL2VlanAccessMode?((0,o.openBlock)(),(0,o.createBlock)(C,{key:2,value:k.config.vlan,"onUpdate:value":[t[4]||(t[4]=e=>k.config.vlan=e),y.input],valueModifiers:{number:!0},class:"mb-20",required:"",type:"number",placeholder:"e.g. 1-4094",label:e.t("tableHeaders.networkVlan"),mode:e.mode},null,8,["value","label","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0),y.isOverlayNetwork?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(V,{key:3,value:y.clusterBridge,"onUpdate:value":t[5]||(t[5]=e=>y.clusterBridge=e),class:"mb-20",label:e.t("harvester.network.clusterNetwork.label"),required:"",disabled:e.isEdit,options:y.clusterNetworkOptions,mode:e.mode,placeholder:e.t("harvester.network.clusterNetwork.selectPlaceholder")},null,8,["value","label","disabled","options","mode","placeholder"]))])),_:1},8,["label"]),y.isL2VlanAccessMode?((0,o.openBlock)(),(0,o.createBlock)(w,{key:0,name:"layer3Network",label:e.t("harvester.network.tabs.layer3Network"),weight:98,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(E,{value:k.layer3Network.mode,"onUpdate:value":t[6]||(t[6]=e=>k.layer3Network.mode=e),name:"layer3NetworkMode",label:e.t("harvester.network.layer3Network.mode.label"),mode:e.mode,options:y.modeOptions},null,8,["value","label","mode","options"])])]),"auto"===k.layer3Network.mode?((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(C,{value:k.layer3Network.serverIPAddr,"onUpdate:value":t[7]||(t[7]=e=>k.layer3Network.serverIPAddr=e),class:"mb-20",label:e.t("harvester.network.layer3Network.serverIPAddr.label"),mode:e.mode},null,8,["value","label","mode"])])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createElementVNode)("div",b,[(0,o.createVNode)(C,{value:k.layer3Network.cidr,"onUpdate:value":t[8]||(t[8]=e=>k.layer3Network.cidr=e),class:"mb-20",label:e.t("harvester.network.layer3Network.cidr.label"),placeholder:e.t("harvester.network.layer3Network.cidr.placeholder"),mode:e.mode,required:""},null,8,["value","label","placeholder","mode"])]),(0,o.createElementVNode)("div",g,[(0,o.createVNode)(C,{value:k.layer3Network.gateway,"onUpdate:value":t[9]||(t[9]=e=>k.layer3Network.gateway=e),class:"mb-20",label:e.t("harvester.network.layer3Network.gateway.label"),placeholder:e.t("harvester.network.layer3Network.gateway.placeholder"),mode:e.mode,required:""},null,8,["value","label","placeholder","mode"])])]))])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1},16)])),_:1},8,["done-route","resource","mode","errors","apply-hooks","onFinish"])}var k=a(63209),y=a(42411),N=a(43094),V=a(79380),C=a(10196),w=a(40527),E=a(89483),S=a(2602),B=a(91825),A=a(88339),x=a(32766),D=a(41837),M=a(68851);const{L2VLAN:U,UNTAGGED:T,OVERLAY:I,L2TRUNK_VLAN:O}=D.AW,{ACCESS:_,TRUNK:P}=D.QD,$="auto",R="manual";var L={emits:["update:value"],components:{Tab:y.A,Tabbed:k.A,CruResource:N.A,LabeledInput:V.o,NameNsDescription:w.A,RadioGroup:C.z,LabeledSelect:E.A},mixins:[B.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},data(){const e=JSON.parse(this.value.spec.config),t=this.value?.metadata?.annotations||{},a=JSON.parse(t[S.r.NETWORK_ROUTE]||"{}"),o=this.value.vlanType||U;return{config:e,type:o,l2VlanMode:this.value.vlanType===O?P:_,vlanTrunk:this.parseVlanTrunk(e),layer3Network:{mode:a.mode||$,serverIPAddr:a.serverIPAddr||"",cidr:a.cidr||"",gateway:a.gateway||""}}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;await(0,A.kR)({clusterNetworks:this.$store.dispatch(`${e}/findAll`,{type:x.rk.CLUSTER_NETWORK})})},created(){this.registerBeforeHook&&this.registerBeforeHook(this.updateBeforeSave)},computed:{clusterBridge:{get(){return this.config.bridge&&this.config?.bridge?.endsWith("-br")?this.config.bridge.slice(0,-3):""},set(e){""!==e?e.endsWith("-br")?this.config.bridge=e:this.config.bridge=`${e}-br`:this.config.bridge=""}},modeOptions(){return[{label:this.t("harvester.network.layer3Network.mode.auto"),value:$},{label:this.t("harvester.network.layer3Network.mode.manual"),value:R}]},l2VlanTrunkModeFeatureEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("l2VlanTrunkMode")},kubeovnVpcSubnetSupport(){return this.$store.getters["harvester-common/getFeatureEnabled"]("kubeovnVpcSubnet")},longhornV2LVMSupport(){return this.$store.getters["harvester-common/getFeatureEnabled"]("longhornV2LVMSupport")},clusterNetworkOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](x.rk.CLUSTER_NETWORK)||[];return t.map((e=>{const t=!e.isReady;return{label:t?`${e.id} (${this.t("generic.notReady")})`:e.id,value:e.id,disabled:t}}))},l2VlanModeOptions(){return[{label:this.t("harvester.vlanStatus.vlanConfig.l2VlanMode.access"),value:_},{label:this.t("harvester.vlanStatus.vlanConfig.l2VlanMode.trunk"),value:P}]},networkTypes(){const e=[U,T];return this.kubeovnVpcSubnetSupport&&e.push(I),e},isL2VlanNetwork(){return this.isView?this.value.vlanType===U:this.type===U},isL2VlanTrunkMode(){return this.isView?this.value.vlanType===O&&this.l2VlanMode===P:this.type===O||this.l2VlanMode===P&&this.type===U},isL2VlanAccessMode(){return this.isView?this.value.vlanType===U&&this.l2VlanMode===_:this.type===U&&this.l2VlanMode===_},isOverlayNetwork(){return this.isView?this.value.vlanType===I:this.type===I},isUntaggedNetwork(){return this.isView?this.value.vlanType===T:this.type===T}},watch:{type(e){e===I?(this.config.type="kube-ovn",this.config.provider=`${this.value.metadata.name}.${this.value.metadata.namespace}.ovn`,this.config.server_socket="/run/openvswitch/kube-ovn-daemon.sock"):(this.config.type="bridge",this.config.promiscMode=!0,this.config.ipam={},this.config.bridge="",delete this.config.provider,delete this.config.server_socket)},l2VlanMode(e){this.type===U&&(e===P?(this.config.vlan=0,this.config.vlanTrunk=this.vlanTrunk):(delete this.config.vlanTrunk,this.config.vlan=""))}},methods:{async saveNetwork(e){const t=[];if(this.isL2VlanNetwork||this.isUntaggedNetwork){if(this.isL2VlanTrunkMode&&this.vlanTrunk.some((e=>""===e.minID))&&t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("harvester.vlanStatus.vlanConfig.vlanTrunk.minId")})),this.isL2VlanTrunkMode&&this.vlanTrunk.some((e=>""===e.maxID))&&t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("harvester.vlanStatus.vlanConfig.vlanTrunk.maxId")})),!this.isL2VlanAccessMode||this.config.vlan||this.isUntaggedNetwork||t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("tableHeaders.networkVlan")})),this.config.bridge||t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("harvester.network.clusterNetwork.label")})),this.layer3Network.mode===R&&(this.layer3Network.gateway||t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("harvester.network.layer3Network.gateway.label")})),this.layer3Network.cidr||t.push(this.$store.getters["i18n/t"]("validation.required",{key:this.t("harvester.network.layer3Network.cidr.label")}))),t.length>0)return e(!1),this.errors=t,!1;this.value.setAnnotation(S.r.NETWORK_ROUTE,JSON.stringify(this.layer3Network))}await this.save(e)},parseVlanTrunk(e){return e?.vlanTrunk&&e?.vlanTrunk?.length>0?e.vlanTrunk:[{minID:"",maxID:""}]},removeVlanTrunk(e){(0,M.Gj)(this.vlanTrunk,e)},addVlanTrunk(){this.config.vlanTrunk||(this.config.vlanTrunk=[]),this.vlanTrunk.push({minID:this.minId,maxID:this.maxId}),this.config.vlanTrunk=this.vlanTrunk},vlanTrunkChange(){this.config.vlanTrunk=this.vlanTrunk},input(e){if(""===e)return void(this.config.vlan="");const t=Number(e);this.config.vlan=t>4094?4094:t<1?1:t},updateBeforeSave(){this.config.name=this.value.metadata.name,this.isOverlayNetwork&&(this.config.provider=`${this.value.metadata.name}.${this.value.metadata.namespace}.ovn`,delete this.config.bridge,delete this.config.promiscMode,delete this.config.vlan,delete this.config.ipam),this.isUntaggedNetwork&&delete this.config.vlan,this.value.spec.config=JSON.stringify({...this.config})}}},q=(a(45820),a(47433));const F=(0,q.A)(L,[["render",f],["__scopeId","data-v-73ede312"]]);var H=F},92183:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return U}});var o=a(9274);const r={class:"banner"},l={class:"mb-30"},s={class:"row mb-30"},n={class:"col span-6"},i={class:"col span-6"};function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("MessageLink"),m=(0,o.resolveComponent)("Banner"),v=(0,o.resolveComponent)("RadioGroup"),h=(0,o.resolveComponent)("LabeledSelect"),b=(0,o.resolveComponent)("LabeledInput"),g=(0,o.resolveComponent)("Tab"),f=(0,o.resolveComponent)("Tabbed"),k=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(k,{"done-route":e.doneRoute,resource:a.value,mode:a.mode,errors:e.errors,"apply-hooks":e.applyHooks,"validation-passed":u.canSave,onFinish:e.save,onError:t[6]||(t[6]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[u.isBackupTargetUnAvailable?((0,o.openBlock)(),(0,o.createBlock)(m,{key:0,color:"error"},{default:(0,o.withCtx)((()=>[u.isEmptyValue?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,to:u.toBackupTargetSetting,target:e._blank,"prefix-label":"harvester.backup.message.noSetting.prefix","middle-label":"harvester.backup.message.noSetting.middle","suffix-label":"harvester.schedule.message.noSetting.suffix"},null,8,["to","target"])):((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,to:u.toBackupTargetSetting,"prefix-label":"harvester.backup.message.errorTip.prefix","middle-label":"harvester.backup.message.errorTip.middle"},{suffix:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.backup.message.errorTip.suffix"))+" "+(0,o.toDisplayString)(u.errorMessage),1)])),_:1},8,["to"]))])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",l,[(0,o.createVNode)(v,{value:a.value.spec.vmbackup.type,"onUpdate:value":[t[0]||(t[0]=e=>a.value.spec.vmbackup.type=e),u.onTypeChange],name:"model",options:u.scheduleTypeOptions,labels:[e.t("harvester.schedule.type.backup"),e.t("harvester.schedule.type.snapshot")],disabled:e.isEdit||e.isView,mode:a.mode,row:""},null,8,["value","options","labels","disabled","mode","onUpdate:value"])]),(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(h,{value:a.value.metadata.namespace,"onUpdate:value":t[1]||(t[1]=e=>a.value.metadata.namespace=e),label:e.t("nameNsDescription.namespace.label"),options:u.namespaces,required:"",disabled:u.isBackupTargetUnAvailable||e.isEdit||e.isView},null,8,["value","label","options","disabled"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(h,{value:a.value.spec.vmbackup.source.name,"onUpdate:value":t[2]||(t[2]=e=>a.value.spec.vmbackup.source.name=e),label:e.t("harvester.schedule.virtualMachine.title"),placeholder:e.t("harvester.schedule.virtualMachine.placeholder"),options:u.vmOptions,required:"",disabled:u.isBackupTargetUnAvailable||e.isEdit||e.isView},null,8,["value","label","placeholder","options","disabled"])])])]),(0,o.createVNode)(f,(0,o.mergeProps)(e.$attrs,{class:"mt-15","side-tabs":!0}),{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{name:"basics",label:e.t("harvester.network.tabs.basics"),weight:99,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{value:a.value.spec.cron,"onUpdate:value":t[3]||(t[3]=e=>a.value.spec.cron=e),class:"mb-30",type:"cron",required:"",mode:a.mode,label:e.t("harvester.schedule.cron"),placeholder:"0 * * * *",disabled:u.isBackupTargetUnAvailable||e.isView},null,8,["value","mode","label","disabled"]),(0,o.createVNode)(b,{value:a.value.spec.retain,"onUpdate:value":t[4]||(t[4]=e=>a.value.spec.retain=e),valueModifiers:{number:!0},class:"mb-30",min:2,max:250,type:"number",label:e.t("harvester.schedule.retain.label"),required:"",tooltip:e.t("harvester.schedule.retain.tooltip"),disabled:u.isBackupTargetUnAvailable||e.isView},null,8,["value","label","tooltip","disabled"]),(0,o.createVNode)(b,{value:a.value.spec.maxFailure,"onUpdate:value":t[5]||(t[5]=e=>a.value.spec.maxFailure=e),valueModifiers:{number:!0},class:"mb-30",min:2,type:"number",label:e.t("harvester.schedule.maxFailure.label"),required:"",tooltip:e.t("harvester.schedule.maxFailure.tooltip"),disabled:u.isBackupTargetUnAvailable||e.isView,onInput:u.validateFailure},null,8,["value","label","tooltip","disabled","onInput"])])),_:1},8,["label"])])),_:1},16)])),_:1},8,["done-route","resource","mode","errors","apply-hooks","validation-passed","onFinish"])}var c=a(10196),u=a(9980),p=a(79380),m=a(43094),v=a(63209),h=a(42411),b=a(96413),g=a(89483),f=a(91825),k=a(37021),y=a.n(k);function N(e=""){try{const t=y().toString(e);return!!t}catch(t){return!1}}var V=a(20652),C=a(88339),w=a(32766),E=a(74302),S=a(41837),B=a(14220),A=a(14127),x={name:"CreateVMSchedule",components:{CruResource:m.A,Tabbed:v.A,Tab:h.A,RadioGroup:c.z,LabeledInput:p.o,LabeledSelect:g.A,MessageLink:b.A,Banner:u.l},mixins:[f.A],inheritAttrs:!1,async fetch(){const e=await(0,C.kR)({settings:this.$store.dispatch("harvester/findAll",{type:w.rk.SETTING}),vms:this.$store.dispatch("harvester/findAll",{type:w.rk.VM})});this.allVms=e.vms,this.settings=e.settings},props:{value:{type:Object,required:!0},mode:{type:String,required:!0}},data(){if(this.mode===B.YQ){const e=this.$store.getters["defaultNamespace"],t=this.$route.query?.vmNamespace||e,a=this.$route.query?.vmName;delete this.value.metadata.annotations,delete this.value.metadata.labels,this.value["metadata"]={namespace:t,name:a?`svmbackup-${a}`:""},this.value.spec||(this.value["spec"]={cron:"",retain:8,maxFailure:4,vmbackup:{source:{apiGroup:"kubevirt.io",kind:"VirtualMachine",name:a||""},type:S.aS.BACKUP}})}return{settings:[]}},computed:{backupTargetResource(){return this.settings.find((e=>"backup-target"===e.id))},isEmptyValue(){return(0,A.z)(this.backupTargetResource)},canUpdate(){return this?.backupTargetResource?.canUpdate},errorMessage(){return this.backupTargetResource?.errMessage},canSave(){return!!this.value.spec.cron&&N(this.value.spec.cron)&&!!this.value.metadata.name&&!!this.value.metadata.namespace&&!!this.value.spec.retain&&!!this.value.spec.maxFailure},isBackupTargetUnAvailable(){return this.value.spec.vmbackup.type===S.aS.BACKUP&&(0,A.S)(this.backupTargetResource)},vmOptions(){const e=this.$store.getters["harvester/all"](w.rk.VM).filter((e=>e.metadata.namespace===this.value.metadata.namespace)),t=e.map((e=>({label:e.nameDisplay,value:e.name})));return(0,E.Ul)(t,"label")},namespaces(){const e=this.$store.getters["allNamespaces"],t=(0,E.Ul)(e.map((e=>({label:e.nameDisplay,value:e.id}))),"label");return t},toBackupTargetSetting(){const{cluster:e}=this.$router?.currentRoute?.params||{};return{name:`${V.KR}-c-cluster-resource-id`,params:{resource:`${w.rk.SETTING}`,cluster:e,id:"backup-target"},query:{mode:B.G5}}},scheduleTypeOptions(){return[S.aS.BACKUP,S.aS.SNAPSHOT]}},watch:{"value.metadata.namespace"(){this.value.spec.vmbackup.source.name=""},"value.spec.vmbackup.source.name"(e){this.value.metadata.name=`svm${this.value.spec.vmbackup.type}-${e}`}},methods:{onTypeChange(e){this.value.metadata.name=`svm${e}-${this.value.spec.vmbackup.source.name}`},validateFailure(e){this.value.spec.retain&&e>this.value.spec.retain&&(this.value.spec["maxFailure"]=this.value.spec.retain)}}},D=a(47433);const M=(0,D.A)(x,[["render",d]]);var U=M},74583:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var o=a(9274);const r={class:"filled-height"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("Loading"),d=(0,o.resolveComponent)("NameNsDescription"),c=(0,o.resolveComponent)("Tab"),u=(0,o.resolveComponent)("Labels"),p=(0,o.resolveComponent)("Tabbed"),m=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createElementBlock)("form",r,[e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(i,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(m,{key:1,mode:e.mode,"validation-passed":!0,"selected-subtype":e.value._type,resource:e.value,errors:e.errors,onFinish:n.saveSecret,onError:t[2]||(t[2]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{value:e.value,mode:e.mode,namespaced:!s.isCloud,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","namespaced"]),t[3]||(t[3]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),s.isCloud?((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(n.cloudComponent),{key:0,ref:"cloudComponent","driver-name":n.driverName,value:e.value,mode:e.mode,"hide-sensitive-data":n.hideSensitiveData},null,8,["driver-name","value","mode","hide-sensitive-data"])):((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,"side-tabs":!0,"default-tab":"data"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{name:"data",label:n.dataLabel,weight:99},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(n.dataComponent),{value:e.value,mode:e.mode,"hide-sensitive-data":n.hideSensitiveData},null,8,["value","mode","hide-sensitive-data"]))])),_:1},8,["label"]),(0,o.createVNode)(c,{name:"labels","label-key":"generic.labelsAndAnnotations",weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{value:e.value,"onUpdate:value":t[1]||(t[1]=t=>e.value=t),mode:e.mode},null,8,["value","mode"])])),_:1})])),_:1}))])),_:1,__:[3]},8,["mode","selected-subtype","resource","errors","onFinish"]))])}var s=a(17259),n=a(35664),i=a(91825),d=a(40527),c=a(79380),u=a(89483),p=a(43094),m=a(14220),v=a(87619),h=a(63209),b=a(42411),g=a(51449),f=a(91462),k=a(2841),y=a(68851),N=a(27436),V=a(5895),C=a(92043),w={name:"CruSecret",emits:["update:value"],components:{LabeledInput:c.o,LabeledSelect:u.A,Loading:v.A,NameNsDescription:d.A,CruResource:p.A,Tabbed:h.A,Tab:b.A,Labels:g.A,SelectIconGrid:V.A},mixins:[i.A],inheritAttrs:!1,async fetch(){this.isCloud&&(this.nodeDrivers=await this.$store.dispatch("management/findAll",{type:n.Mc.NODE_DRIVER}))},data(){const e=this.$route.query[m.Sd]===m.Qp,t=this.mode===m.G5&&this.value._type===s.J.CLOUD_CREDENTIAL,a=this.realMode===m.dT&&this.liveValue._type===s.J.CLOUD_CREDENTIAL,o=e||t||a;e&&(this.value.metadata.namespace=n.eo,this.value.metadata["name"]="",this.value["data"]={});const r=[{label:"Custom",value:"custom"},{label:"divider",disabled:!0,kind:"divider"}];return Object.values(s.J).forEach((e=>{r.push({label:e,value:e})})),this.mode===m.YQ&&(this.value["_type"]=s.J.OPAQUE),this.realMode===m.dT&&(this.value["_type"]=this.liveValue._type),{isCloud:o,nodeDrivers:null,secretTypes:r,secretType:this.value._type,initialSecretType:this.value._type}},computed:{typeKey(){if(this.isCloud)return"cloud";switch(this.value._type){case s.J.TLS:return"tls";case s.J.BASIC:return"basic";case s.J.DOCKER_JSON:return"registry";case s.J.SSH:return"ssh"}return"generic"},dataComponent(){return a(48254)(`./${this.typeKey}`).default},driverName(){const e=this.value.metadata?.annotations?.[k.qt.CREDENTIAL_DRIVER];return e},cloudComponent(){const e=this.driverName,t=this.$store.getters["plugins/credentialDrivers"];return t.includes(e)?(0,N.qq)(e):(0,N.qq)("generic")},namespaces(){return this.$store.getters["cluster/all"](n.CU).map((e=>({label:e.nameDisplay,value:e.id})))},hideSensitiveData(){return this.$store.getters["prefs/get"](f.qv)},dataLabel(){switch(this.value._type){case s.J.TLS:return this.t("secret.certificate.certificate");case s.J.SSH:return this.t("secret.ssh.keys");case s.J.BASIC:return this.t("secret.authentication");default:return this.t("secret.data")}}},created(){this.registerAfterHook((()=>{const e=this.$store.getters["allNamespaces"],t=e.find((e=>"default"===e.id)),a=t?.id||e?.[0]?.id||"";this.value.$dispatch("prefs/set",{key:f.Ri,value:a},{root:!0})}))},methods:{async saveSecret(e){if(this.errors&&(0,y.IU)(this.errors),"function"===typeof this.$refs.cloudComponent?.test)try{const t=await this.$refs.cloudComponent.test();if(!t||t?.errors)return this.errors=t?.errors?t.errors:["Authentication test failed, please check your credentials"],void e(!1)}catch(t){return this.errors=[t],void e(!1)}return this.save(e)},typeDisplay(e,t){if(e===k.qt.CREDENTIAL_DRIVER)return this.$store.getters["i18n/withFallback"](`cluster.provider."${t}"`,null,t);{const t=e.replace(/^kubernetes.io\//,"");return this.$store.getters["i18n/withFallback"](`secret.types."${e}"`,null,t)}},initialDisplayFor(e){const t=((0,C.TF)(this.typeDisplay(e)||"").replace(/[^A-Z]/g,"")||e).substr(0,3);return this.$store.getters["i18n/withFallback"](`secret.initials."${e}"`,null,t)},selectCustomType(e){"custom"!==e&&(this.value["_type"]=e)}}},E=a(47433);const S=(0,E.A)(w,[["render",l]]);var B=S},78407:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var o=a(9274);const r={key:0,class:"edit-help"},l={class:"edit-change mt-20"},s=["disabled"],n={class:"mt-20"},i={key:0},d={key:1},c={key:2},u={key:3},p={key:4},m={key:5};function v(e,t,a,v,h,b){const g=(0,o.resolveComponent)("LabeledSelect"),f=(0,o.resolveComponent)("RadioGroup"),k=(0,o.resolveComponent)("TextAreaAutoGrow"),y=(0,o.resolveComponent)("LabeledInput"),N=(0,o.resolveComponent)("CruResource"),V=(0,o.resolveDirective)("clean-html"),C=(0,o.resolveDirective)("t");return(0,o.openBlock)(),(0,o.createBlock)(N,{class:"route",errors:h.errors,mode:e.mode,resource:e.value,subtypes:[],"can-yaml":!1,"cancel-event":!0,onError:t[7]||(t[7]=e=>h.errors=e),onFinish:b.saveSettings,onCancel:b.done},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("h4",null,null,512),[[V,h.description]]),h.editHelp?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("h5",r,null,512)),[[V,h.editHelp]]):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",l,[(0,o.withDirectives)((0,o.createElementVNode)("h5",null,null,512),[[C,"advancedSettings.edit.changeSetting"]]),(0,o.createElementVNode)("button",{disabled:!h.canReset,type:"button",class:"btn role-primary",onClick:t[0]||(t[0]=(...e)=>b.useDefault&&b.useDefault(...e))},(0,o.toDisplayString)(e.t("advancedSettings.edit.useDefault")),9,s)]),(0,o.createElementVNode)("div",n,["import"===h.setting.from?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[h.hasCustomComponent?((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(h.customComponent),{key:0,ref:"settingComp",value:e.value,"onUpdate:value":t[1]||(t[1]=t=>e.value=t),"register-before-hook":e.registerBeforeHook,mode:e.mode},null,40,["value","register-before-hook","mode"])):(0,o.createCommentVNode)("",!0)])):"enum"===h.setting.kind?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createVNode)(g,{value:e.value.value,"onUpdate:value":t[2]||(t[2]=t=>e.value.value=t),label:e.t("advancedSettings.edit.value"),"localized-label":!0,mode:e.mode,options:h.enumOptions},null,8,["value","label","mode","options"])])):"boolean"===h.setting.kind?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createVNode)(f,{value:e.value.value,"onUpdate:value":t[3]||(t[3]=t=>e.value.value=t),name:"settings_value",labels:[e.t("advancedSettings.edit.trueOption"),e.t("advancedSettings.edit.falseOption")],options:["true","false"]},null,8,["value","labels"])])):"multiline"===h.setting.kind||"json"===h.setting.kind?((0,o.openBlock)(),(0,o.createElementBlock)("div",u,[(0,o.createVNode)(k,{value:e.value.value,"onUpdate:value":t[4]||(t[4]=t=>e.value.value=t),"min-height":254},null,8,["value"])])):"number"===h.setting.kind?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createVNode)(y,{value:e.value.value,"onUpdate:value":t[5]||(t[5]=t=>e.value.value=t),label:e.t("advancedSettings.edit.value"),type:"number"},null,8,["value","label"])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",m,[(0,o.createVNode)(y,{value:e.value.value,"onUpdate:value":t[6]||(t[6]=t=>e.value.value=t),label:e.t("advancedSettings.edit.value")},null,8,["value","label"])]))])])),_:1},8,["errors","mode","resource","onFinish","onCancel"])}var h=a(43094),b=a(10196),g=a(79380),f=a(89483),k=a(6879),y=a(73344),N=a(91825),V=a(66242),C=a(3791),w=a(50889),E={components:{CruResource:h.A,LabeledInput:g.o,LabeledSelect:f.A,RadioGroup:b.z,TextAreaAutoGrow:k.V,UnitInput:y.A},mixins:[N.A],inheritAttrs:!1,data(){const e=this.$store.getters["i18n/t"],t=w.gh[this.value.id]||w.LP[this.value.id];let o=[];"enum"===t.kind&&(o=t.options.map((e=>({label:`advancedSettings.enum.harv-${this.value.id}.${e}`,value:e}))));const r=t.canReset||!!this.value.default||this.value.canReset;void 0===this.value.value&&(this.value["value"]=null),this.value.value=this.value.value||this.value.default||"";const l=this.value.value,s=this.value?.type?.includes("harvesterhci"),n=a(26190).keys().map((e=>e.replace(/(\.\/)|(.vue)/g,"")));return{setting:t,description:e(s?`advancedSettings.descriptions.harv-${this.value.id}`:`advancedSettings.descriptions.${this.value.id}`,this.getDocLinkParams()),editHelp:e(`advancedSettings.editHelp.${this.value.id}`),enumOptions:o,canReset:r,errors:[],hasCustomComponent:!1,customComponent:null,customSettingComponents:n,oldValue:l}},computed:{doneLocationOverride(){return this.value.doneOverride}},created(){let e=!1;const t=this.customSettingComponents.includes(this.value.id);if(t)try{e=a(88292)(`./${this.value.id}.vue`).default}catch{}else{const t=this.$route.params.resource,o=this.value.metadata.name;try{e=a(80373)(`./${t}/${o}.vue`).default}catch{}}this.hasCustomComponent=!!e,this.customComponent=e,this.registerAfterHook((()=>{this.value.id===w.EP.RANCHER_MANAGER_SUPPORT&&this.$store.commit("isRancherInHarvester","true"===this.value.value)}))},methods:{done(){this.$router.go(-1)},async saveSettings(e){const t=this.$store.getters["i18n/t"];if("json"===this.setting.kind&&this.value.default)try{JSON.parse(this.value.value),this.errors=[]}catch(a){return this.errors=[t("advancedSettings.edit.invalidJSON")],e(!1)}if(this.value.metadata.name===w.EP.CLUSTER_REGISTRATION_URL&&this.oldValue&&this.value.value!==this.oldValue&&await this.clusterRegistrationUrlTip(),"number"===this.setting.kind&&this.value.value){const e=Number(this.value.value);this.value.value=isNaN(e)?0:`${e}`}this.save(e)},clusterRegistrationUrlTip(){return new Promise((e=>{this.$store.dispatch("harvester/promptModal",{component:"MessageBox",callback:t=>{"ok"===t&&e()},contentKey:"harvester.setting.clusterRegistrationUrl.message"},{root:!0})}))},useDefault(e){e&&e.srcElement&&e.srcElement.blur(),this.value.id===w.EP.VLAN?(this.value.enable=!1,this.value.config&&(this.value.config.defaultPhysicalNIC="")):this.value.value=this.value.default||"","function"===typeof this.$refs.settingComp?.useDefault&&this.$refs.settingComp.useDefault()},getDocLinkParams(){const e=w.gh[this.value.id]||w.LP[this.value.id];if(e?.docPath){const t=this.$store.getters["harvester-common/getServerVersion"](),a=(0,C.nn)(V.d[e.docPath],t);return{url:a}}return{}}}},S=(a(33123),a(47433));const B=(0,S.A)(E,[["render",v],["__scopeId","data-v-45d7bc4b"]]);var A=B},8716:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return E}});var o=a(9274);const r={class:"column-headers"},l={class:"col span-3 value text-label mb-10",for:"volumeMode"},s={class:"col span-9 value text-label mb-10",for:"accessModes"},n={class:"row"},i={class:"col span-3"},d={id:"accessModes",class:"col span-9"};function c(e,t,a,c,u,p){const m=(0,o.resolveComponent)("LabeledSelect"),v=(0,o.resolveComponent)("Checkbox"),h=(0,o.resolveComponent)("ArrayList"),b=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,null,[(0,o.createVNode)(h,{value:u.cdiSettings.volumeModeAccessModes,"onUpdate:value":t[0]||(t[0]=e=>u.cdiSettings.volumeModeAccessModes=e),"initial-empty-row":!0,"show-header":!0,mode:a.mode,title:e.t("harvester.storage.cdiSettings.volumeModeAccessModes.label"),"add-label":e.t("harvester.storage.cdiSettings.volumeModeAccessModes.add"),"default-add-value":u.defaultAddValue,protip:e.t("harvester.storage.cdiSettings.volumeModeAccessModes.tooltip"),"add-disabled":p.allVolumeModesSelected},{"column-headers":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["row",{custom:p.isCustomClass}])},[(0,o.createElementVNode)("label",l,(0,o.toDisplayString)(e.t("harvester.storage.cdiSettings.volumeModeAccessModes.volumeMode")),1),(0,o.createElementVNode)("label",s,(0,o.toDisplayString)(e.t("harvester.storage.cdiSettings.volumeModeAccessModes.accessModes.label")),1)],2)])])),columns:(0,o.withCtx)((({row:e})=>[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(m,{id:"volumeMode",value:e.value.volumeMode,"onUpdate:value":t=>e.value.volumeMode=t,mode:a.mode,options:p.volumeModeOptions},null,8,["value","onUpdate:value","mode","options"])]),(0,o.createElementVNode)("div",d,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(p.accessModeOptions,(t=>((0,o.openBlock)(),(0,o.createBlock)(v,{key:t.value,value:e.value.accessModes,"onUpdate:value":t=>e.value.accessModes=t,"value-when-true":t.value,label:t.label,type:"checkbox",mode:a.mode},null,8,["value","onUpdate:value","value-when-true","label","mode"])))),128))])])])),_:1},8,["value","mode","title","add-label","default-add-value","protip","add-disabled"]),(0,o.createVNode)(m,{value:u.cdiSettings.volumeSnapshotClass,"onUpdate:value":t[1]||(t[1]=e=>u.cdiSettings.volumeSnapshotClass=e),class:"select mt-20 mb-20",label:e.t("harvester.storage.cdiSettings.volumeSnapshotClass.label"),tooltip:e.t("harvester.storage.cdiSettings.volumeSnapshotClass.tooltip"),mode:a.mode,options:p.volumeSnapshotClassOptions},null,8,["value","label","tooltip","mode","options"]),(0,o.createVNode)(m,{value:u.cdiSettings.cloneStrategy,"onUpdate:value":t[2]||(t[2]=e=>u.cdiSettings.cloneStrategy=e),class:"select mb-20",label:e.t("harvester.storage.cdiSettings.cloneStrategy.label"),tooltip:e.t("harvester.storage.cdiSettings.cloneStrategy.tooltip"),mode:a.mode,options:p.cloneStrategyOptions},null,8,["value","label","tooltip","mode","options"]),(0,o.createVNode)(b,{value:u.cdiSettings.filesystemOverhead,"onUpdate:value":t[3]||(t[3]=e=>u.cdiSettings.filesystemOverhead=e),class:"select mb-20",label:e.t("harvester.storage.cdiSettings.fileSystemOverhead.label"),tooltip:e.t("harvester.storage.cdiSettings.fileSystemOverhead.tooltip"),mode:a.mode,type:"number",min:0,max:1,step:.001,placeholder:e.t("harvester.storage.cdiSettings.fileSystemOverhead.placeholder"),status:p.isFilesystemOverheadValid?null:"error",onInput:p.validateFilesystemOverhead},null,8,["value","label","tooltip","mode","placeholder","status","onInput"])],64)}var u=a(41837),p=a(2602),m=a(64676),v=a(42200),h=a(8746),b=a(89483),g=a(32766),f=a(50889),k=a(88339),y=a(14220),N=a(4364),V={name:"CDISettings",props:{value:{type:Object,required:!0},mode:{type:String,required:!0},provisioner:{type:String,required:!0}},components:{ArrayList:m.A,Checkbox:v.S,LabeledInput:h.A,LabeledSelect:b.A},emits:["update:cdiSettings"],async fetch(){const e={volumeSnapshotClasses:this.$store.dispatch(`${this.inStore}/findAll`,{type:g.nE}),csiDriverConfigSetting:this.$store.dispatch(`${this.inStore}/find`,{type:g.rk.SETTING,id:f.EP.CSI_DRIVER_CONFIG})};await(0,k.kR)(e),this.mode===y.YQ?this.setDefaultVolumeSnapshotClass():this.initCDISettingsFromAnnotations()},data(){return{cdiSettings:{volumeModeAccessModes:[],volumeSnapshotClass:null,cloneStrategy:null,filesystemOverhead:null},defaultAddValue:{volumeMode:null,accessModes:[]},noneOption:{label:"None",value:""}}},computed:{inStore(){return this.$store.getters["currentProduct"].inStore},allVolumeModeOptions(){return Object.values(u.vU).map((e=>({label:e,value:e})))},selectedVolumeModes(){return this.cdiSettings.volumeModeAccessModes.map((e=>e.volumeMode)).filter(Boolean)},volumeModeOptions(){return[this.noneOption,...this.allVolumeModeOptions].filter((e=>!this.selectedVolumeModes.includes(e.value)))},allVolumeModesSelected(){return this.selectedVolumeModes.length===this.allVolumeModeOptions.length},accessModeOptions(){return[{label:"ReadWriteOnce",value:"ReadWriteOnce"},{label:"ReadOnlyMany",value:"ReadOnlyMany"},{label:"ReadWriteMany",value:"ReadWriteMany"},{label:"ReadWriteOncePod",value:"ReadWriteOncePod"}]},cloneStrategyOptions(){return[this.noneOption,{label:this.t("harvester.storage.cdiSettings.cloneStrategy.copy"),value:"copy"},{label:this.t("harvester.storage.cdiSettings.cloneStrategy.snapshot"),value:"snapshot"},{label:this.t("harvester.storage.cdiSettings.cloneStrategy.csiClone"),value:"csi-clone"}]},volumeSnapshotClassOptions(){const e=this.$store.getters[`${this.inStore}/all`](g.nE)||[],t=e.filter((e=>e.driver===this.provisioner));return[this.noneOption,...t.map((e=>({label:e.name,value:e.name})))]},isFilesystemOverheadValid(){const e=this.cdiSettings.filesystemOverhead;if(null===e||""===e)return!0;const t=/^(0(\.\d{1,3})?|1(\.0{1,3})?)$/;return t.test(e)},isCustomClass(){return this.mode===y.YQ||this.mode===y.G5}},watch:{provisioner(){this.resetCdiSettings(),this.$nextTick(this.setDefaultVolumeSnapshotClass)},cdiSettings:{handler(e){this.$emit("update:cdiSettings",e)},deep:!0,immediate:!0}},methods:{setDefaultVolumeSnapshotClass(){try{const e=this.$store.getters[`${this.inStore}/byId`](g.rk.SETTING,f.EP.CSI_DRIVER_CONFIG),t=JSON.parse(e?.value||e?.default||"{}"),a=t?.[this.provisioner]?.volumeSnapshotClassName||null,o=this.$store.getters[`${this.inStore}/all`](g.nE)||[],r=o.find((e=>e.name===a&&e.driver===this.provisioner));this.cdiSettings.volumeSnapshotClass=r?.name||null}catch(e){N.error("Failed to parse CSI config:",e),this.cdiSettings.volumeSnapshotClass=null}},initCDISettingsFromAnnotations(){const e=this.value?.metadata?.annotations||{};let t=[];const a=e[p.r.VOLUME_MODE_ACCESS_MODES];if(a)try{const e=JSON.parse(a);t=Object.entries(e).map((([e,t])=>({volumeMode:e,accessModes:Array.isArray(t)?t:[]})))}catch(o){N.error("Failed to parse annotation:",o)}t.length&&(this.cdiSettings.volumeModeAccessModes=t),e[p.r.VOLUME_SNAPSHOT_CLASS]&&(this.cdiSettings.volumeSnapshotClass=e[p.r.VOLUME_SNAPSHOT_CLASS]),e[p.r.CLONE_STRATEGY]&&(this.cdiSettings.cloneStrategy=e[p.r.CLONE_STRATEGY]),e[p.r.FILESYSTEM_OVERHEAD]&&(this.cdiSettings.filesystemOverhead=e[p.r.FILESYSTEM_OVERHEAD])},resetCdiSettings(){this.cdiSettings.volumeModeAccessModes=[this.defaultAddValue],this.cdiSettings.volumeSnapshotClass=null,this.cdiSettings.cloneStrategy=null,this.cdiSettings.filesystemOverhead=null},validateFilesystemOverhead(e){const t=e.target.value;this.cdiSettings.filesystemOverhead=t}}},C=(a(1980),a(47433));const w=(0,C.A)(V,[["render",c],["__scopeId","data-v-f04994c6"]]);var E=w},14787:function(e,t,a){"use strict";a.r(t),a.d(t,{LVM_TOPOLOGY_LABEL:function(){return $},default:function(){return j}});var o=a(9274);const r={class:"row mt-20"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mt-20"},i={class:"col span-6"},d={class:"box"},c={class:"row"},u={class:"col span-4 key"},p={class:"col span-8 value"},m={class:"row custom-headers"},v={class:"col span-4 key"},h={class:"col span-8 value"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("Loading"),y=(0,o.resolveComponent)("NameNsDescription"),N=(0,o.resolveComponent)("LabeledSelect"),V=(0,o.resolveComponent)("Tab"),C=(0,o.resolveComponent)("RadioGroup"),w=(0,o.resolveComponent)("LabeledInput"),E=(0,o.resolveComponent)("Tags"),S=(0,o.resolveComponent)("ArrayList"),B=(0,o.resolveComponent)("CDISettings"),A=(0,o.resolveComponent)("Tabbed"),x=(0,o.resolveComponent)("CruResource");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(k,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(x,{key:1,"done-route":e.doneRoute,mode:e.mode,resource:e.value,subtypes:[],"validation-passed":!0,"apply-hooks":e.applyHooks,errors:e.errors,onError:t[7]||(t[7]=t=>e.errors=t),onFinish:e.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{namespaced:!1,value:e.value,mode:e.mode,"register-before-hook":e.registerBeforeHook,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","register-before-hook"]),(0,o.createVNode)(N,{value:g.provisioner,"onUpdate:value":t[1]||(t[1]=e=>g.provisioner=e),label:"Provisioner",options:f.provisioners,"localized-label":!0,mode:f.modeOverride,searchable:!0,taggable:!0,class:"mb-20"},null,8,["value","options","mode"]),(0,o.createVNode)(A,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{name:"parameters",label:e.t("storageClass.parameters.label"),weight:2},{default:(0,o.withCtx)((()=>[((0,o.openBlock)(),(0,o.createBlock)((0,o.resolveDynamicComponent)(f.getComponent(g.provisioner)),{key:g.provisioner,value:e.value,mode:f.modeOverride,"real-mode":e.realMode},null,8,["value","mode","real-mode"]))])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"customize",label:e.t("storageClass.customize.label")},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(C,{value:e.value.reclaimPolicy,"onUpdate:value":t[2]||(t[2]=t=>e.value.reclaimPolicy=t),name:"reclaimPolicy",label:e.t("storageClass.customize.reclaimPolicy.label"),mode:f.modeOverride,options:g.reclaimPolicyOptions},null,8,["value","label","mode","options"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(C,{value:e.value.allowVolumeExpansion,"onUpdate:value":t[3]||(t[3]=t=>e.value.allowVolumeExpansion=t),name:"allowVolumeExpansion",label:e.t("storageClass.customize.allowVolumeExpansion.label"),mode:f.modeOverride,options:g.allowVolumeExpansionOptions},null,8,["value","label","mode","options"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(C,{value:e.value.volumeBindingMode,"onUpdate:value":t[4]||(t[4]=t=>e.value.volumeBindingMode=t),name:"volumeBindingMode",label:e.t("storageClass.customize.volumeBindingMode.label"),mode:f.modeOverride,options:g.volumeBindingModeOptions,disabled:g.provisioner===g.LVM_DRIVER},null,8,["value","label","mode","options","disabled"])])])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"allowedTopologies",label:e.t("harvester.storage.allowedTopologies.title"),weight:-1,tooltip:e.t("harvester.storage.allowedTopologies.tooltip")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(S,{value:g.allowedTopologies,"onUpdate:value":t[5]||(t[5]=e=>g.allowedTopologies=e),"default-add-value":g.defaultAddValue,"initial-empty-row":!0,"show-header":!0,mode:f.modeOverride},{"column-headers":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("generic.key"))+" ",1),t[8]||(t[8]=(0,o.createElementVNode)("span",{class:"required"},"*",-1))]),(0,o.createElementVNode)("div",p,(0,o.toDisplayString)(e.t("generic.value")),1)])])])),columns:(0,o.withCtx)((t=>[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(w,{value:t.row.value.key,"onUpdate:value":e=>t.row.value.key=e,required:!0,mode:f.modeOverride},null,8,["value","onUpdate:value","mode"])]),(0,o.createElementVNode)("div",h,[(0,o.createVNode)(E,{value:t.row.value.values,"onUpdate:value":e=>t.row.value.values=e,"add-label":e.t("generic.add"),mode:f.modeOverride},null,8,["value","onUpdate:value","add-label","mode"])])])])),_:1},8,["value","default-add-value","mode"])])),_:1},8,["label","tooltip"]),f.shouldShowCDISettingsTab?((0,o.openBlock)(),(0,o.createBlock)(V,{key:0,name:"cdiSettings",label:e.t("harvester.storage.cdiSettings.label"),weight:-2},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{"cdi-settings":g.cdiSettings,"onUpdate:cdiSettings":t[6]||(t[6]=e=>g.cdiSettings=e),value:e.value,mode:e.mode,provisioner:e.value.provisioner},null,8,["cdi-settings","value","mode","provisioner"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1})])),_:1},8,["done-route","mode","resource","apply-hooks","errors","onFinish","onCancel"]))}var g=a(2602),f=a(91825),k=a(43094),y=a(40527),N=a(64676),V=a(42411),C=a(63209),w=a(10196),E=a(79380),S=a(89483),B=a(87619),A=a(14220),x=a(95265),D=a(35664),M=a(88339),U=a(76978),T=a(32766),I=a(49306),O=a(15908),_=a(82877),P=a(8716);const $="topology.lvm.csi/node",R="longhorn-system/v2-data-engine",L="Immediate",q="WaitForFirstConsumer";var F={name:"HarvesterStorage",emits:["update:value"],components:{ArrayList:N.A,CruResource:k.A,LabeledSelect:S.A,LabeledInput:E.o,NameNsDescription:y.A,RadioGroup:w.z,Tab:V.A,Tabbed:C.A,Loading:B.A,Tags:I.A,CDISettings:P["default"]},mixins:[f.A],inheritAttrs:!1,data(){const e=[{label:this.t("storageClass.customize.reclaimPolicy.delete"),value:"Delete"},{label:this.t("storageClass.customize.reclaimPolicy.retain"),value:"Retain"}],t=[{label:this.t("generic.enabled"),value:!0},{label:this.t("generic.disabled"),value:!1}],a=[{label:this.t("storageClass.customize.volumeBindingMode.now"),value:L},{label:this.t("harvester.storage.customize.volumeBindingMode.later"),value:q}],o=(0,U.o8)(this.value.allowedTopologies?.[0]?.matchLabelExpressions||[]).filter((e=>e.key!==$));this.value["parameters"]=this.value.parameters||{},this.value["provisioner"]=this.value.provisioner||D.lI,this.value["allowVolumeExpansion"]=this.value.allowVolumeExpansion||t[0].value,this.value["reclaimPolicy"]=this.value.reclaimPolicy||e[0].value,this.value.provisioner===D.lI&&(this.value["parameters"]["dataEngine"]=this.value.longhornVersion,this.value["volumeBindingMode"]=this.value.volumeBindingMode||L),this.value.provisioner===_.LVM_DRIVER&&(this.value["volumeBindingMode"]=this.value.volumeBindingMode||q);let r=`${this.value.provisioner||D.lI}`;return r===D.lI&&(r=`${r}_${this.value.longhornVersion}`),{LVM_DRIVER:_.LVM_DRIVER,reclaimPolicyOptions:e,allowVolumeExpansionOptions:t,volumeBindingModeOptions:a,mountOptions:[],STORAGE_CLASS:D.fJ,provisioner:r,allowedTopologies:o,defaultAddValue:{key:"",values:[]},cdiSettings:{}}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={namespaces:this.$store.dispatch(`${e}/findAll`,{type:D.CU}),storages:this.$store.dispatch(`${e}/findAll`,{type:D.fJ}),longhornNodes:this.$store.dispatch(`${e}/findAll`,{type:D.oe.NODES}),csiDrivers:this.$store.dispatch(`${e}/findAll`,{type:T.Zq})};this.value.longhornV2LVMSupport&&(t.longhornV2DataEngine=this.$store.dispatch(`${e}/find`,{type:D.oe.SETTINGS,id:R})),this.value.volumeEncryptionFeatureEnabled&&(t.secrets=this.$store.dispatch(`${e}/findAll`,{type:D.bB})),await(0,M.kR)(t)},computed:{showUnsupportedStorage:(0,x.r$)(x.Wt),inStore(){return this.$store.getters["currentProduct"].inStore},modeOverride(){return this.isCreate?A.YQ:A.nW},provisioners(){const e=[],t=this.$store.getters["currentProduct"].inStore,a=this.$store.getters[`${t}/all`](T.Zq)||[];return a.forEach((({name:t})=>{switch(t){case D.lI:e.push({label:`harvester.storage.storageClass.longhorn.${O.DATA_ENGINE_V1}.label`,value:`${t}_${O.DATA_ENGINE_V1}`}),this.longhornSystemVersion!==O.DATA_ENGINE_V2&&this.value.longhornVersion!==O.DATA_ENGINE_V2||e.push({label:`harvester.storage.storageClass.longhorn.${O.DATA_ENGINE_V2}.label`,value:`${t}_${O.DATA_ENGINE_V2}`});break;case _.LVM_DRIVER:e.push({label:"harvester.storage.storageClass.lvm.label",value:t});break}})),e},schema(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/schemaFor`](D.fJ)},longhornSystemVersion(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/byId`](D.oe.SETTINGS,R)||{};return"true"===t.value?O.DATA_ENGINE_V2:O.DATA_ENGINE_V1},isCDISettingsFeatureEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("cdiSettings")},shouldShowCDISettingsTab(){return this.isCDISettingsFeatureEnabled&&this.provisioner!==`${D.lI}_${O.DATA_ENGINE_V1}`}},watch:{provisioner(e){const[t,a]=e?.split("_");let o={};if(t===_.LVM_DRIVER){const e=(this.value.allowedTopologies?.[0]?.matchLabelExpressions||[]).filter((e=>e.key!==$));e.length>0?this.value["allowedTopologies"]=[{matchLabelExpressions:e}]:delete this.value.allowedTopologies,this.value["volumeBindingMode"]=q}t===D.lI&&(o={dataEngine:a},this.value["volumeBindingMode"]=L),this.value["provisioner"]=t,this.value["allowVolumeExpansion"]=this.value.provisioner===D.lI,this.value["parameters"]=o}},created(){this.registerBeforeHook(this.willSave,"willSave")},methods:{getComponent(e){try{return a(6232)(`./${e}`).default}catch{return a(43868)["default"]}},willSave(){Object.keys(this.value.parameters).forEach((e=>{null!==this.value.parameters[e]&&""!==this.value.parameters[e]||delete this.value.parameters[e]})),this.formatAllowedTopoloties(),this.shouldShowCDISettingsTab&&this.formatCDISettings()},formatAllowedTopoloties(){const e=this.allowedTopologies.filter((e=>e.key!==$)),t=(this.value.allowedTopologies?.[0]?.matchLabelExpressions||[]).filter((e=>e.key===$));if(!e||0===e.length)return void(t.length>0?this.value.allowedTopologies=[{matchLabelExpressions:t}]:delete this.value.allowedTopologies);const a=e.filter((e=>!!e.key.trim()&&e.values.length>0&&!e.values.find((e=>!e.trim()))));a.length>0&&(this.value.allowedTopologies=[{matchLabelExpressions:[...a,...t]}])},formatCDISettings(){const e=this.value.metadata.annotations||{},t={};this.cdiSettings.volumeModeAccessModes.forEach((e=>{e.volumeMode&&Array.isArray(e.accessModes)&&e.accessModes.length>0&&(t[e.volumeMode]=e.accessModes)})),Object.keys(t).length>0?e[g.r.VOLUME_MODE_ACCESS_MODES]=JSON.stringify(t):delete e[g.r.VOLUME_MODE_ACCESS_MODES],this.cdiSettings.volumeSnapshotClass?e[g.r.VOLUME_SNAPSHOT_CLASS]=this.cdiSettings.volumeSnapshotClass:delete e[g.r.VOLUME_SNAPSHOT_CLASS],this.cdiSettings.cloneStrategy?e[g.r.CLONE_STRATEGY]=this.cdiSettings.cloneStrategy:delete e[g.r.CLONE_STRATEGY],this.cdiSettings.filesystemOverhead?e[g.r.FILESYSTEM_OVERHEAD]=this.cdiSettings.filesystemOverhead:delete e[g.r.FILESYSTEM_OVERHEAD],this.value.metadata.annotations=e}}},H=(a(96391),a(47433));const G=(0,H.A)(F,[["render",b],["__scopeId","data-v-e0dfa694"]]);var j=G},43868:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createBlock)(n,{value:a.value.parameters,"onUpdate:value":t[0]||(t[0]=e=>a.value.parameters=e),"add-label":e.t("storageClass.custom.addLabel"),"read-allowed":!1,mode:a.mode},null,8,["value","add-label","mode"])}var l=a(38094),s={components:{KeyValue:l.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0}}},n=a(47433);const i=(0,n.A)(s,[["render",r]]);var d=i},30050:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var o=a(9274);const r={class:"row"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mt-10"},i={class:"col span-6"},d={key:0,class:"text-muted"},c={class:"col span-6"},u={key:0,class:"text-muted"},p={class:"row mt-20"},m={class:"row mt-20"},v={key:0,class:"row mt-20"},h={class:"col span-6"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("LabeledInput"),y=(0,o.resolveComponent)("LabeledSelect"),N=(0,o.resolveComponent)("RadioGroup"),V=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(k,{value:f.numberOfReplicas,"onUpdate:value":t[0]||(t[0]=e=>f.numberOfReplicas=e),label:e.t("harvester.storage.parameters.numberOfReplicas.label"),required:!0,mode:a.mode,min:"1",max:"3",type:"number"},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(k,{value:a.value.parameters.staleReplicaTimeout,"onUpdate:value":t[1]||(t[1]=e=>a.value.parameters.staleReplicaTimeout=e),label:e.t("harvester.storage.parameters.staleReplicaTimeout.label"),required:!0,mode:a.mode,type:"number"},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(y,{value:f.nodeSelector,"onUpdate:value":t[2]||(t[2]=e=>f.nodeSelector=e),label:e.t("harvester.storage.parameters.nodeSelector.label"),options:f.nodeTags,taggable:!0,multiple:!0,mode:a.mode},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",d,(0,o.toDisplayString)(e.t("harvester.storage.parameters.nodeSelector.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(y,{value:f.diskSelector,"onUpdate:value":t[3]||(t[3]=e=>f.diskSelector=e),label:e.t("harvester.storage.parameters.diskSelector.label"),options:f.diskTags,taggable:!0,multiple:!0,mode:a.mode},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(e.t("harvester.storage.parameters.diskSelector.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(N,{value:a.value.parameters.migratable,"onUpdate:value":t[4]||(t[4]=e=>a.value.parameters.migratable=e),name:"layer3NetworkMode",label:e.t("harvester.storage.parameters.migratable.label"),mode:a.mode,options:f.migratableOptions},null,8,["value","label","mode","options"])]),a.value.volumeEncryptionFeatureEnabled?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",m,[(0,o.createVNode)(N,{value:f.volumeEncryption,"onUpdate:value":t[5]||(t[5]=e=>f.volumeEncryption=e),name:"volumeEncryption",label:e.t("harvester.storage.volumeEncryption"),mode:a.mode,options:f.volumeEncryptionOptions},null,8,["value","label","mode","options"])]),"true"===a.value.parameters.encrypted?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createVNode)(y,{value:f.secret,"onUpdate:value":t[6]||(t[6]=e=>f.secret=e),label:e.t("harvester.storage.secret"),options:f.secretOptions,mode:a.mode},null,8,["value","label","options","mode"])])])):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(V,{value:f.parameters,"onUpdate:value":t[7]||(t[7]=e=>f.parameters=e),"add-label":e.t("storageClass.longhorn.addLabel"),"read-allowed":!1,mode:a.mode,class:"mt-10"},null,8,["value","add-label","mode"])])}var g=a(38094),f=a(89483),k=a(79380),y=a(95706),N=a(35664),V=a(14220),C=a(66905),w=a(76978),E=a(68851),S=a(15908);const{CSI_PROVISIONER_SECRET_NAME:B,CSI_PROVISIONER_SECRET_NAMESPACE:A,CSI_NODE_PUBLISH_SECRET_NAME:x,CSI_NODE_PUBLISH_SECRET_NAMESPACE:D,CSI_NODE_STAGE_SECRET_NAME:M,CSI_NODE_STAGE_SECRET_NAMESPACE:U}=C.Et;var T={name:"DriverLonghornIOV1",components:{KeyValue:g.A,LabeledSelect:f.A,LabeledInput:k.o,RadioGroup:y.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},realMode:{type:String,required:!0}},data(){return this.realMode===V.YQ&&(this.value["parameters"]={numberOfReplicas:"3",staleReplicaTimeout:"30",diskSelector:null,nodeSelector:null,encrypted:"false",migratable:"true",dataEngine:S.DATA_ENGINE_V1}),{}},computed:{secrets(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](N.bB);return t.filter((e=>!1===e.isSystem))},longhornNodes(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/all`](N.oe.NODES)},nodeTags(){return(this.longhornNodes||[]).reduce(((e,t)=>{const a=t.spec?.tags||[];return(0,E.sb)([...e,...a])}),[])},diskTags(){return(this.longhornNodes||[]).reduce(((e,t)=>{const a=t.spec?.disks,o=Object.keys(a).reduce(((e,t)=>{const o=a[t]?.tags||[];return(0,E.sb)([...e,...o])}),[]);return(0,E.sb)([...e,...o])}),[])},isView(){return this.mode===V.nW},migratableOptions(){return[{label:this.t("generic.yes"),value:"true"},{label:this.t("generic.no"),value:"false"}]},secretOptions(){return this.secrets.map((e=>e.id))},volumeEncryptionOptions(){return[{label:this.t("generic.yes"),value:"true"},{label:this.t("generic.no"),value:"false"}]},parameters:{get(){const e=(0,w.o8)(this.value?.parameters)||{},t=["numberOfReplicas","staleReplicaTimeout","diskSelector","nodeSelector","migratable",...this.value.volumeEncryptionFeatureEnabled?["encrypted","dataEngine"]:[]];return[...t,...Object.values(C.Et)].forEach((t=>{delete e[t]})),e},set(e){Object.assign(this.value.parameters,e)}},volumeEncryption:{set(e){this.value["parameters"]={...this.value.parameters,encrypted:e}},get(){return this.value?.parameters?.encrypted||"false"}},secret:{get(){const e=this.value.parameters[A],t=this.value.parameters[B];return e&&t?`${e}/${t}`:""},set(e){const[t,a]=e.split("/");this.value["parameters"]={...this.value.parameters,[B]:a,[x]:a,[M]:a,[A]:t,[D]:t,[U]:t}}},nodeSelector:{get(){const e=this.value?.parameters?.nodeSelector;return(e||"").includes(",")?e.split(","):e?[e]:[]},set(e){this.value.parameters.nodeSelector=(e||[]).join(",")}},diskSelector:{get(){const e=this.value?.parameters?.diskSelector;return(e||"").includes(",")?e.split(","):e?[e]:[]},set(e){this.value.parameters.diskSelector=(e||[]).join(",")}},numberOfReplicas:{get(){return this.value?.parameters?.numberOfReplicas},set(e){e>=1&&e<=3&&(this.value.parameters.numberOfReplicas=String(e))}}}},I=(a(20545),a(47433));const O=(0,I.A)(T,[["render",b],["__scopeId","data-v-8c848812"]]);var _=O},42822:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return P}});var o=a(9274);const r={class:"row"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mt-10"},i={class:"col span-6"},d={key:0,class:"text-muted"},c={class:"col span-6"},u={key:0,class:"text-muted"},p={class:"row mt-20"},m={class:"row mt-20"},v={key:0,class:"row mt-20"},h={class:"col span-6"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("LabeledInput"),y=(0,o.resolveComponent)("LabeledSelect"),N=(0,o.resolveComponent)("RadioGroup"),V=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(k,{value:f.numberOfReplicas,"onUpdate:value":t[0]||(t[0]=e=>f.numberOfReplicas=e),label:e.t("harvester.storage.parameters.numberOfReplicas.label"),required:!0,mode:a.mode,min:"1",max:"3",type:"number"},null,8,["value","label","mode"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(k,{value:a.value.parameters.staleReplicaTimeout,"onUpdate:value":t[1]||(t[1]=e=>a.value.parameters.staleReplicaTimeout=e),label:e.t("harvester.storage.parameters.staleReplicaTimeout.label"),required:!0,mode:a.mode,type:"number"},null,8,["value","label","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(y,{value:f.nodeSelector,"onUpdate:value":t[2]||(t[2]=e=>f.nodeSelector=e),label:e.t("harvester.storage.parameters.nodeSelector.label"),options:f.nodeTags,taggable:!0,multiple:!0,mode:a.mode},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",d,(0,o.toDisplayString)(e.t("harvester.storage.parameters.nodeSelector.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(y,{value:f.diskSelector,"onUpdate:value":t[3]||(t[3]=e=>f.diskSelector=e),label:e.t("harvester.storage.parameters.diskSelector.label"),options:f.diskTags,taggable:!0,multiple:!0,mode:a.mode},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(e.t("harvester.storage.parameters.diskSelector.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(N,{value:a.value.parameters.migratable,"onUpdate:value":t[4]||(t[4]=e=>a.value.parameters.migratable=e),name:"layer3NetworkMode",label:e.t("harvester.storage.parameters.migratable.label"),mode:a.mode,options:f.migratableOptions,disabled:!a.value.thirdPartyStorageFeatureEnabled},null,8,["value","label","mode","options","disabled"])]),(0,o.createElementVNode)("div",m,[(0,o.createVNode)(N,{value:f.volumeEncryption,"onUpdate:value":t[5]||(t[5]=e=>f.volumeEncryption=e),name:"volumeEncryption",label:e.t("harvester.storage.volumeEncryption"),mode:a.mode,options:f.volumeEncryptionOptions,disabled:!0},null,8,["value","label","mode","options"])]),"true"===a.value.parameters.encrypted?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createVNode)(y,{value:f.secret,"onUpdate:value":t[6]||(t[6]=e=>f.secret=e),label:e.t("harvester.storage.secret"),options:f.secretOptions,mode:a.mode},null,8,["value","label","options","mode"])])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(V,{value:f.parameters,"onUpdate:value":t[7]||(t[7]=e=>f.parameters=e),"add-label":e.t("storageClass.longhorn.addLabel"),"read-allowed":!1,mode:a.mode,class:"mt-10"},null,8,["value","add-label","mode"])])}var g=a(38094),f=a(89483),k=a(79380),y=a(95706),N=a(35664),V=a(14220),C=a(66905),w=a(76978),E=a(68851),S=a(15908);const B=["numberOfReplicas","staleReplicaTimeout","diskSelector","nodeSelector","migratable","encrypted","dataEngine"],{CSI_PROVISIONER_SECRET_NAME:A,CSI_PROVISIONER_SECRET_NAMESPACE:x,CSI_NODE_PUBLISH_SECRET_NAME:D,CSI_NODE_PUBLISH_SECRET_NAMESPACE:M,CSI_NODE_STAGE_SECRET_NAME:U,CSI_NODE_STAGE_SECRET_NAMESPACE:T}=C.Et;var I={name:"DriverLonghornIOV2",components:{KeyValue:g.A,LabeledSelect:f.A,LabeledInput:k.o,RadioGroup:y.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},realMode:{type:String,required:!0}},data(){return this.realMode===V.YQ&&(this.value["parameters"]={numberOfReplicas:"3",staleReplicaTimeout:"30",diskSelector:null,nodeSelector:null,encrypted:"false",migratable:this.value.thirdPartyStorageFeatureEnabled?"true":"false",dataEngine:S.DATA_ENGINE_V2}),{}},computed:{secrets(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](N.bB);return t.filter((e=>!1===e.isSystem))},longhornNodes(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/all`](N.oe.NODES)},nodeTags(){return(this.longhornNodes||[]).reduce(((e,t)=>{const a=t.spec?.tags||[];return(0,E.sb)([...e,...a])}),[])},diskTags(){return(this.longhornNodes||[]).reduce(((e,t)=>{const a=t.spec?.disks,o=Object.keys(a).reduce(((e,t)=>{const o=a[t]?.tags||[];return(0,E.sb)([...e,...o])}),[]);return(0,E.sb)([...e,...o])}),[])},isView(){return this.mode===V.nW},migratableOptions(){return[{label:this.t("generic.yes"),value:"true"},{label:this.t("generic.no"),value:"false"}]},secretOptions(){return this.secrets.map((e=>e.id))},volumeEncryptionOptions(){return[{label:this.t("generic.yes"),value:"true"},{label:this.t("generic.no"),value:"false"}]},parameters:{get(){const e=(0,w.o8)(this.value?.parameters)||{};return B.forEach((t=>{delete e[t]})),Object.values(C.Et).forEach((t=>{delete e[t]})),e},set(e){Object.assign(this.value.parameters,e)}},volumeEncryption:{set(e){this.value["parameters"]={...this.value.parameters,encrypted:e}},get(){return this.value?.parameters?.encrypted||"false"}},secret:{get(){const e=this.value.parameters[x],t=this.value.parameters[A];return e&&t?`${e}/${t}`:""},set(e){const[t,a]=e.split("/");this.value["parameters"]={...this.value.parameters,[A]:a,[D]:a,[U]:a,[x]:t,[M]:t,[T]:t}}},nodeSelector:{get(){const e=this.value?.parameters?.nodeSelector;return(e||"").includes(",")?e.split(","):e?[e]:[]},set(e){this.value.parameters.nodeSelector=(e||[]).join(",")}},diskSelector:{get(){const e=this.value?.parameters?.diskSelector;return(e||"").includes(",")?e.split(","):e?[e]:[]},set(e){this.value.parameters.diskSelector=(e||[]).join(",")}},numberOfReplicas:{get(){return this.value?.parameters?.numberOfReplicas},set(e){e>=1&&e<=3&&(this.value.parameters.numberOfReplicas=String(e))}}}},O=(a(88198),a(47433));const _=(0,O.A)(I,[["render",b],["__scopeId","data-v-1618b260"]]);var P=_},14257:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var o=a(9274);const r={class:"row mt-10"},l={class:"col span-6"},s={key:0,class:"text-muted"},n={class:"row mt-10"},i={class:"col span-6"},d={key:0,class:"text-muted"},c={class:"col span-6"};function u(e,t,a,u,p,m){const v=(0,o.resolveComponent)("LabeledSelect"),h=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(v,{value:p.node,"onUpdate:value":t[0]||(t[0]=e=>p.node=e),label:e.t("harvester.storage.parameters.node.label"),options:m.nodes,mode:a.mode,required:!0},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",s,(0,o.toDisplayString)(e.t("harvester.storage.parameters.diskSelector.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{value:a.value.parameters.vgName,"onUpdate:value":t[1]||(t[1]=e=>a.value.parameters.vgName=e),label:e.t("harvester.storage.parameters.lvmVolumeGroup.label"),options:m.volumeGroups,mode:a.mode,required:!0},{"no-options":(0,o.withCtx)((({searching:t})=>[t?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("span",d,(0,o.toDisplayString)(e.t("harvester.storage.parameters.lvmVolumeGroup.no-options",null,!0)),1))])),_:1},8,["value","label","options","mode"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(v,{value:a.value.parameters.type,"onUpdate:value":t[2]||(t[2]=e=>a.value.parameters.type=e),label:e.t("harvester.storage.parameters.lvmVolumeGroupType.label"),options:p.volumeGroupTypes,mode:a.mode,required:!0},null,8,["value","label","options","mode"])])]),(0,o.createVNode)(h,{value:m.parameters,"onUpdate:value":t[3]||(t[3]=e=>m.parameters=e),"add-label":e.t("storageClass.longhorn.addLabel"),"read-allowed":!1,mode:a.mode,class:"mt-10"},null,8,["value","add-label","mode"])])}var p=a(38094),m=a(89483),v=a(88339),h=a(76978),b=a(32766),g=a(35664),f=a(14787);const k=["type","vgName"],y=[{matchLabelExpressions:[{key:f.LVM_TOPOLOGY_LABEL,values:[]}]}];var N={components:{KeyValue:p.A,LabeledSelect:m.A},props:{value:{type:Object,required:!0},mode:{type:String,required:!0},realMode:{type:String,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;await(0,v.kR)({nodes:this.$store.dispatch(`${e}/findAll`,{type:g.NW}),lvmVolumeGroups:this.$store.dispatch(`${e}/findAll`,{type:b.rk.LVM_VOLUME_GROUP})})},data(){const e=(this.value.allowedTopologies?.[0]?.matchLabelExpressions||[]).find((e=>e.key===f.LVM_TOPOLOGY_LABEL))?.values[0];return{volumeGroupTypes:["striped","dm-thin"],node:e}},watch:{node(e){delete this.value.parameters.vgName;const t=[...y];t[0].matchLabelExpressions[0].values=[e],this.value.allowedTopologies=t}},computed:{nodes(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](g.NW)||[];return t.filter((e=>e.labels[f.LVM_TOPOLOGY_LABEL]===e.name)).map((e=>e.name))},volumeGroups(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](b.rk.LVM_VOLUME_GROUP)||[];return t.filter((e=>e.spec.nodeName===this.node)).map((e=>e.spec.vgName))},parameters:{get(){const e=(0,h.o8)(this.value?.parameters)||{};return k.map((t=>{delete e[t]})),e},set(e){Object.assign(this.value.parameters,e)}}}},V=(a(5648),a(47433));const C=(0,V.A)(N,[["render",u],["__scopeId","data-v-6afc4f36"]]);var w=C},57717:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var o=a(9274);const r={id:"restore"},l={class:"content"},s={class:"mb-20"},n={class:"row"},i={class:"col span-6"},d={class:"col span-6"};function c(e,t,a,c,u,p){const m=(0,o.resolveComponent)("RadioGroup"),v=(0,o.resolveComponent)("LabeledSelect"),h=(0,o.resolveComponent)("LabeledInput"),b=(0,o.resolveComponent)("Checkbox"),g=(0,o.resolveComponent)("Footer");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(m,{value:u.restoreNewVm,"onUpdate:value":t[0]||(t[0]=e=>u.restoreNewVm=e),name:"model",options:[!0,!1],labels:[e.t("harvester.backup.restore.createNew"),e.t("harvester.backup.restore.replaceExisting")],disabled:p.disableExisting,mode:e.mode},null,8,["value","labels","disabled","mode"])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{value:u.namespace,"onUpdate:value":t[1]||(t[1]=e=>u.namespace=e),disabled:!u.restoreNewVm,label:e.t("nameNsDescription.namespace.label"),options:p.namespaces},null,8,["value","disabled","label","options"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(h,{value:u.name,"onUpdate:value":t[2]||(t[2]=e=>u.name=e),disabled:!u.restoreNewVm,label:e.t("harvester.backup.restore.virtualMachineName"),placeholder:e.t("nameNsDescription.name.placeholder"),class:"mb-20"},null,8,["value","disabled","label","placeholder"])])]),(0,o.createVNode)(v,{value:u.backupName,"onUpdate:value":t[3]||(t[3]=e=>u.backupName=e),class:"mb-20",label:e.t("harvester.backup.restore.backup"),options:p.backupOption},null,8,["value","label","options"]),u.restoreNewVm?((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,value:u.restoreResource.spec.keepMacAddress,"onUpdate:value":t[4]||(t[4]=e=>u.restoreResource.spec.keepMacAddress=e),type:"checkbox",label:e.t("harvester.backup.restore.keepMacAddress")},null,8,["value","label"])):(0,o.createCommentVNode)("",!0),u.restoreNewVm?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,value:u.deletionPolicy,"onUpdate:value":t[5]||(t[5]=e=>u.deletionPolicy=e),label:e.t("harvester.backup.restore.deletePreviousVolumes"),options:p.deletionPolicyOption},null,8,["value","label","options"]))]),(0,o.createVNode)(g,{mode:"create",class:"footer",errors:e.errors,onSave:p.saveRestore,onDone:p.cancelAction},null,8,["errors","onSave","onDone"])])}var u=a(77262),p=a(10196),m=a(79380),v=a(94168),h=a(89483),b=a(91825),g=a(88339),f=a(99726),k=a(74302),y=a(76978),N=a(32766),V=a(41837);const C={apiVersion:"harvesterhci.io/v1beta1",kind:"VirtualMachineRestore",metadata:{name:"",namespace:""},type:N.rk.RESTORE,spec:{target:{apiGroup:"kubevirt.io",kind:"VirtualMachine",name:""},virtualMachineBackupName:"",newVM:!0,deletionPolicy:"delete"}};var w={name:"CreateRestore",components:{Checkbox:v.A,Footer:u.A,RadioGroup:p.z,LabeledInput:m.o,LabeledSelect:h.A},mixins:[b.A],async fetch(){await(0,g.kR)({backups:this.$store.dispatch("harvester/findAll",{type:N.rk.BACKUP}),vms:this.$store.dispatch("harvester/findAll",{type:N.rk.VM})})},data(){const e=this.$route.query?.restoreMode,t=this.$route.query?.resourceName,a=(0,y.o8)(C),o="new"===e||void 0===e;return{backupName:t,restoreNewVm:o,restoreResource:a,name:"",description:"",deletionPolicy:"delete",namespace:""}},computed:{backupOption(){const e=this.$store.getters["harvester/all"](N.rk.BACKUP);return e.filter((e=>{const t=this.restoreNewVm||e.attachVmExisting;return t&&e?.status?.readyToUse&&e.spec?.type!==V.aS.SNAPSHOT})).map((e=>({label:e.metadata.name,value:e.metadata.name})))},deletionPolicyOption(){return[{value:"delete",label:"Delete"},{value:"retain",label:"Retain"}]},currentBackupResource(){const e=this.backupName,t=this.$store.getters["harvester/all"](N.rk.BACKUP);return t.find((t=>t.name===e))},disableExisting(){return!this.currentBackupResource?.attachVmExisting},backupNamespace(){const e=this.$store.getters["harvester/all"](N.rk.BACKUP);return e.find((e=>e.metadata.name===this.backupName))?.metadata?.namespace},namespaces(){const e=this.$store.getters["allNamespaces"],t=(0,k.Ul)(e.map((e=>({label:e.nameDisplay,value:e.id}))),"label");return t}},watch:{backupName:{handler(e){this.currentBackupResource&&(this.restoreNewVm||(this.name=this?.currentBackupResource?.attachVM)),this.restoreResource.spec.virtualMachineBackupName=e},immediate:!0},restoreNewVm(e){this.name=e?"":this?.currentBackupResource?.attachVM},backupNamespace:{handler(e){this.namespace=e},immediate:!0}},methods:{cancelAction(){this.$router.go(-1)},async saveRestore(e){this.update();const t=await this.$store.dispatch("harvester/create",this.restoreResource);t.metadata.namespace=this.namespace,t.spec.virtualMachineBackupNamespace=this.backupNamespace;try{await t.save(),e(!0),this.$router.push({name:this.doneRoute,params:{resource:N.rk.VM}})}catch(a){this.errors=(0,f.rz)(a)||a,e(!1)}},update(){this.restoreResource.metadata.generateName=`restore-${this.backupName}-`,this.name&&(this.restoreResource.spec.target.name=this.name),this.restoreNewVm?(delete this.restoreResource.spec.deletionPolicy,this.restoreResource.spec.newVM=!0):(this.restoreResource.spec.deletionPolicy=this.deletionPolicy,delete this.restoreResource.spec.newVM,delete this.restoreResource.spec.keepMacAddress)}},componentTitle(){return"restoreVM"}},E=(a(4008),a(47433));const S=(0,E.A)(w,[["render",c],["__scopeId","data-v-dcf8e7de"]]);var B=S},35901:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return q}});var o=a(9274);const r={class:"row mb-20 mt-20"},l={class:"col span-12"},s={key:2},n={key:2,class:"fileName mt-5"},i={class:"row"},d={class:"col span-6"},c=["onUpdate:modelValue","disabled","placeholder","onInput"];function u(e,t,a,u,p,m){const v=(0,o.resolveComponent)("NameNsDescription"),h=(0,o.resolveComponent)("RadioGroup"),b=(0,o.resolveComponent)("LabeledInput"),g=(0,o.resolveComponent)("LabeledSelect"),f=(0,o.resolveComponent)("Tab"),k=(0,o.resolveComponent)("Select"),y=(0,o.resolveComponent)("KeyValue"),N=(0,o.resolveComponent)("Tabbed"),V=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(V,{"done-route":e.doneRoute,resource:a.value,mode:e.mode,errors:e.errors,"can-yaml":!!m.showEditAsYaml,"apply-hooks":e.applyHooks,onFinish:m.saveImage,onError:t[11]||(t[11]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{ref:"nd",value:a.value,mode:e.mode,label:e.t("generic.name"),"name-key":"spec.displayName","onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","label"]),(0,o.createVNode)(N,(0,o.mergeProps)(e.$attrs,{class:"mt-15","side-tabs":!0}),{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{name:"basic",label:e.t("harvester.image.tabs.basics"),weight:99,class:"bordered-table"},{default:(0,o.withCtx)((()=>[e.isCreate?((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,value:m.sourceType,"onUpdate:value":t[1]||(t[1]=e=>m.sourceType=e),name:"model",options:m.radioGroupOptions,labels:[e.t("harvester.image.sourceType.download"),e.t("harvester.image.sourceType.upload"),e.t("harvester.image.sourceType.encrypt"),e.t("harvester.image.sourceType.decrypt")],mode:e.mode},null,8,["value","options","labels","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[e.isCreate?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,value:a.value.spec.sourceType,"onUpdate:value":t[2]||(t[2]=e=>a.value.spec.sourceType=e),mode:e.mode,class:"mb-20",disabled:e.isEdit,"label-key":"harvester.image.source"},null,8,["value","mode","disabled"])),"download"===a.value.spec.sourceType?((0,o.openBlock)(),(0,o.createBlock)(b,{key:1,value:a.value.spec.url,"onUpdate:value":t[3]||(t[3]=e=>a.value.spec.url=e),mode:e.mode,disabled:e.isEdit,class:"mb-20 labeled-input--tooltip",required:"","label-key":"harvester.image.url",tooltip:e.t("harvester.image.urlTip",{},!0)},null,8,["value","mode","disabled","tooltip"])):"upload"===a.value.spec.sourceType?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[e.isView?((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,value:m.imageName,"onUpdate:value":t[4]||(t[4]=e=>m.imageName=e),mode:e.mode,class:"mt-20","label-key":"harvester.image.fileName"},null,8,["value","mode"])):(0,o.createCommentVNode)("",!0),e.isCreate?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"btn role-primary",onClick:t[6]||(t[6]=(...e)=>m.selectFile&&m.selectFile(...e))},[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.t("harvester.image.uploadFile")),1),(0,o.withDirectives)((0,o.createElementVNode)("input",{id:"file",ref:"file",type:"file",accept:".qcow, .qcow2, .raw, .img, .iso",onChange:t[5]||(t[5]=e=>m.handleFileUpload())},null,544),[[o.vShow,!1]])])):(0,o.createCommentVNode)("",!0),m.uploadFileName?((0,o.openBlock)(),(0,o.createElementBlock)("div",n,[t[12]||(t[12]=(0,o.createElementVNode)("span",{class:"icon icon-file"},null,-1)),(0,o.createTextVNode)(" "+(0,o.toDisplayString)(m.uploadFileName),1)])):(0,o.createCommentVNode)("",!0)])):(0,o.createCommentVNode)("",!0),"download"===a.value.spec.sourceType?((0,o.openBlock)(),(0,o.createBlock)(b,{key:3,value:a.value.spec.checksum,"onUpdate:value":t[7]||(t[7]=e=>a.value.spec.checksum=e),mode:e.mode,disabled:e.isEdit,"label-key":"harvester.image.checksum",tooltip:e.t("harvester.image.checksumTip")},null,8,["value","mode","disabled","tooltip"])):(0,o.createCommentVNode)("",!0),"clone"===a.value.spec.sourceType?((0,o.openBlock)(),(0,o.createBlock)(g,{key:4,value:m.sourceImage,"onUpdate:value":t[8]||(t[8]=e=>m.sourceImage=e),options:m.sourceImageOptions,label:e.t("harvester.image.sourceImage"),mode:e.mode,disabled:e.isEdit,class:"mb-20"},null,8,["value","options","label","mode","disabled"])):(0,o.createCommentVNode)("",!0)])])])),_:1},8,["label"]),(0,o.createVNode)(f,{name:"storage",label:e.t("harvester.storage.label"),weight:89,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(g,{value:m.storageClassName,"onUpdate:value":t[9]||(t[9]=e=>m.storageClassName=e),options:m.storageClassOptions,label:e.t("harvester.storage.storageClass.label"),mode:e.mode,disabled:e.isEdit,class:"mb-20"},null,8,["value","options","label","mode","disabled"])])])])),_:1},8,["label"]),(0,o.createVNode)(f,{name:"labels",label:e.t("labels.labels.title"),weight:2,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{key:"labels",ref:"labels",value:a.value.labels,"add-label":e.t("labels.addLabel"),mode:e.mode,"pad-left":!1,"read-allowed":!1,"value-can-be-empty":!0,"toggle-filter":!0,"protected-keys":[p.HCI_ANNOTATIONS.IMAGE_DISPLAY_NAME],onFocusKey:m.focusKey,"onUpdate:value":t[10]||(t[10]=e=>a.value.setLabels(e))},{value:(0,o.withCtx)((({row:t,keyName:a,valueName:r,queueUpdate:l})=>[m.internalAnnotations(t)?((0,o.openBlock)(),(0,o.createBlock)(k,{key:0,value:t[r],"onUpdate:value":[e=>t[r]=e,l],mode:e.mode,searchable:!0,clearable:!1,options:m.calculateOptions(t[a])},null,8,["value","onUpdate:value","mode","options"])):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>t[r]=e,disabled:e.isView||t[a]===p.HCI_ANNOTATIONS.IMAGE_DISPLAY_NAME,type:"text",placeholder:e.t("keyValue.valuePlaceholder"),autocorrect:"off",autocapitalize:"off",spellcheck:"false",onInput:l},null,40,c)),[[o.vModelDynamic,t[r]]])])),_:1},8,["value","add-label","mode","protected-keys","onFocusKey"])])),_:1},8,["label"])])),_:1},16)])),_:1},8,["done-route","resource","mode","errors","can-yaml","apply-hooks","onFinish"])}var p=a(43094),m=a(63209),v=a(42411),h=a(79380),b=a(38094),g=a(40527),f=a(10196),k=a(45866),y=a(89483),N=a(91825),V=a(2602),C=a(99726),w=a(88339),E=a(35664),S=a(52880),B=a(48249),A=a(32766),x=a(82877),D=a(39407);const M="encrypt",U="decrypt",T="clone",I="download",O="upload",_="raw_qcow2",P="longhorn";var $={name:"EditImage",inheritAttrs:!1,emits:["update:value"],components:{Tab:v.A,Tabbed:m.A,KeyValue:b.A,Select:k.A,CruResource:p.A,LabeledInput:h.o,NameNsDescription:g.A,RadioGroup:f.z,LabeledSelect:y.A},mixins:[N.A],props:{value:{type:Object,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore;await(0,w.kR)({images:this.$store.dispatch(`${e}/findAll`,{type:A.rk.IMAGE}),storageClasses:this.$store.dispatch(`${e}/findAll`,{type:E.fJ})}),this["storageClassName"]=this.storageClassName||this.defaultStorageClassName(),this.images=this.$store.getters[`${e}/all`](A.rk.IMAGE),this.storages=this.$store.getters[`${e}/all`](E.fJ);const{securityParameters:t}=this.value.spec;if(t){const e=`${t.sourceImageNamespace}/${t.sourceImageName}`;this.selectedImage=this.images.find((t=>t.id===e))}},data(){const{image:e,sourceType:t,cryptoOperation:a}=this.$route.query||{};if(this.value.spec||(this.value["spec"]={sourceType:t||I}),e&&a){const t=JSON.parse(e);this.value.spec.securityParameters={cryptoOperation:a,sourceImageName:t.metadata.name,sourceImageNamespace:t.metadata.namespace}}return this.value.metadata.name||(this.value.metadata.generateName="image-"),{selectedImage:null,storageClasses:[],images:[],url:this.value.spec.url,files:[],resource:"",headers:{},fileUrl:"",file:"",HCI_ANNOTATIONS:V.r}},computed:{uploadFileName(){return this.file?.name||""},imageName(){return this.value?.metadata?.annotations?.[V.r.IMAGE_NAME]||"-"},isCreateEdit(){return this.isCreate||this.isEdit},showEditAsYaml(){return this.value.spec.sourceType===I||this.value.spec.sourceType===T},radioGroupOptions(){return this.value.volumeEncryptionFeatureEnabled?[I,O,M,U]:[I,O]},encryptedStorageClasses(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](E.fJ);return t.filter((e=>e.isEncrypted))},nonEncryptedStorageClasses(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](E.fJ);return t.filter((e=>!e.isEncrypted))},storageClassOptions(){const e=this.value.spec?.securityParameters?.cryptoOperation===M?this.encryptedStorageClasses:this.nonEncryptedStorageClasses,t=this.value.thirdPartyStorageFeatureEnabled?e.filter((e=>!e.parameters?.backingImage)):e.filter((e=>!e.parameters?.backingImage&&e.provisioner!==x.LVM_DRIVER));return t.map((e=>{let t=e.isDefault?`${e.name} (${this.t("generic.default")})`:e.name,a=!1;return(0,D.N)(e.name)&&(t+=` (${this.t("harvester.storage.internal.label")})`,a=!0),{label:t,value:e.name,disabled:a}}))||[]},storageClassName:{get(){return this.value.metadata.annotations[V.r.STORAGE_CLASS]},set(e){this.value.metadata.annotations[V.r.STORAGE_CLASS]=e,this.value.thirdPartyStorageFeatureEnabled&&(this.value.spec.targetStorageClassName=e)}},sourceImageOptions(){let e=[];return this.value.spec.sourceType!==T?e:(e=this.value.spec.securityParameters.cryptoOperation===M?this.images.filter((e=>!e.isEncrypted)):this.images.filter((e=>e.isEncrypted)),e.map((e=>e.displayNameWithNamespace)))},sourceImage:{get(){return this.selectedImage?this.selectedImage.displayNameWithNamespace:""},set(e){this.selectedImage=this.images.find((t=>t.displayNameWithNamespace===e)),this.value.spec.securityParameters.sourceImageName=this.selectedImage?.metadata.name||"",this.value.spec.securityParameters.sourceImageNamespace=this.selectedImage?.metadata.namespace||""}},sourceType:{get(){return this.value.spec.sourceType===T?this.value.spec?.securityParameters?.cryptoOperation:this.value.spec.sourceType},set(e){e===U||e===M?(this.value.spec.sourceType=T,this.value.spec["securityParameters"]={cryptoOperation:e,sourceImageName:"",sourceImageNamespace:this.value.metadata.namespace},this.selectedImage=null):(delete this.value.spec["securityParameters"],this.value.spec.sourceType=e)}}},watch:{"value.spec.url"(e){const t=e.trim();this.setImageLabels(t)},"value.spec.sourceType"(){this["file"]=null,this.url="",this.$refs?.file?.value&&(this.$refs.file.value=null)},"value.spec.securityParameters.cryptoOperation"(){this.value.spec?.securityParameters?.cryptoOperation===M?this.storageClassName=this.encryptedStorageClasses[0]?.name||"":this.storageClassName=this.defaultStorageClassName()},storageClassName(e){const t=this.storages.find((t=>t.id===e));t&&this.value.thirdPartyStorageFeatureEnabled&&(this.value.spec.backend=t.isLonghornV1?"backingimage":"cdi")}},methods:{async saveImage(e){if(this.value.spec.displayName=(this.value.spec.displayName||"").trim(),this.isEdit)return await this.handleEditImage(e);if(this.value.spec.sourceType===O&&this.isCreate)try{this.value.spec.url="";const t=this.file;this.value.metadata.annotations[V.r.IMAGE_NAME]=t?.name;const a=await this.value.save();a.uploadImage(t),e(!0),this.done()}catch(t){this.errors=(0,C.rz)(t),e(!1)}else this.value.spec.url=this.value.spec.url?.trim()||"",this.save(e)},async handleEditImage(e){try{const t=[{op:"replace",path:"/metadata/labels",value:this.value.metadata.labels},{op:"replace",path:"/metadata/annotations",value:this.value.metadata.annotations}];await this.value.patch(t),e(!0),this.done()}catch(t){this.errors=(0,C.rz)(t),e(!1)}},setImageLabels(e){const t=e?.split("/")?.pop()||e,a=t?.split(".")?.pop()?.toLowerCase();if(S.Vi.includes(a)){const e="iso"===a?a:_;this.addLabel(V.r.IMAGE_SUFFIX,e),this.value.spec.displayName||this.$refs.nd.changeNameAndNamespace({text:t,selected:this.value.metadata.namespace})}const o=this.getOSType(e);o&&this.addLabel(V.r.OS_TYPE,o.value)},addLabel(e,t){const a=this.$refs.labels.rows;a.map(((t,a)=>{t.key===e&&this.$refs.labels.remove(a)})),this.$refs.labels.add(e,t)},handleFileUpload(){const e=this.$refs.file.files[0];this.file=e,this.setImageLabels(e?.name),this.value.spec.displayName||this.$refs.nd.changeNameAndNamespace({text:e?.name,selected:this.value.metadata.namespace}),this.setImageLabels()},selectFile(){this.$refs.file.value=null,this.$refs.file.click()},internalAnnotations(e){const t=[V.r.OS_TYPE,V.r.IMAGE_SUFFIX];return t.find((t=>t===e.key))},calculateOptions(e){return e===V.r.OS_TYPE?B.OS:e===V.r.IMAGE_SUFFIX?[{label:"ISO",value:"iso"},{label:"raw/qcow2",value:_}]:[]},focusKey(){this.$refs.key.focus()},getOSType(e){if(e)return B.OS.find((t=>t.match?!!t.match.find((t=>e.toLowerCase().includes(t)))&&t.value:!!e.toLowerCase().includes(t.value.toLowerCase())&&t.value))},defaultStorageClassName(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](E.fJ).find((e=>e.isDefault));return t?t.isEncrypted?P:t?.metadata?.name:P}}},R=(a(40610),a(47433));const L=(0,R.A)($,[["render",u],["__scopeId","data-v-64a57538"]]);var q=L},26215:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return G}});var o=a(9274);const r={class:"mb-20"},l={class:"row mb-20"},s={class:"col span-6"},n={class:"col span-6"},i={class:"row mb-20"},d={class:"col span-6"},c={class:"col span-6"},u={class:"row mb-20"},p={key:0},m={class:"row mb-20"},v={class:"col span-6"};function h(e,t,a,h,b,g){const f=(0,o.resolveComponent)("NameNsDescription"),k=(0,o.resolveComponent)("Checkbox"),y=(0,o.resolveComponent)("CpuMemory"),N=(0,o.resolveComponent)("SSHKey"),V=(0,o.resolveComponent)("Tab"),C=(0,o.resolveComponent)("Volume"),w=(0,o.resolveComponent)("Network"),E=(0,o.resolveComponent)("NodeScheduling"),S=(0,o.resolveComponent)("PodAffinity"),B=(0,o.resolveComponent)("t"),A=(0,o.resolveComponent)("Banner"),x=(0,o.resolveComponent)("KeyValue"),D=(0,o.resolveComponent)("LabeledSelect"),M=(0,o.resolveComponent)("Reserved"),U=(0,o.resolveComponent)("UnitInput"),T=(0,o.resolveComponent)("CloudConfig"),I=(0,o.resolveComponent)("Tabbed"),O=(0,o.resolveComponent)("CruResource"),_=(0,o.resolveDirective)("t");return b.templateSpec&&e.spec?((0,o.openBlock)(),(0,o.createBlock)(O,{key:0,"done-route":e.doneRoute,resource:a.value,"can-yaml":!1,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,onFinish:g.saveVMT,onError:t[22]||(t[22]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{value:b.templateValue,mode:g.realTemplateMode,"name-label":"harvester.vmTemplate.nameNsDescription.name",namespaced:!0,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:templateValue",t))},null,8,["value","mode"]),b.templateId?((0,o.openBlock)(),(0,o.createBlock)(k,{key:0,value:b.isDefaultVersion,"onUpdate:value":t[1]||(t[1]=e=>b.isDefaultVersion=e),class:"mb-20",label:e.t("tableHeaders.defaultVersion"),type:"checkbox",mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(I,{"side-tabs":!0,onChanged:g.onTabChanged},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(V,{name:"Basics",label:e.t("harvester.vmTemplate.tabs.basics")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{class:"mb-20",cpu:e.cpu,memory:e.memory,"max-cpu":e.maxCpu,"max-memory":e.maxMemory,"enable-hot-plug":e.cpuMemoryHotplugEnabled,disabled:g.isConfig,onUpdateCpuMemory:e.updateCpuMemory},null,8,["cpu","memory","max-cpu","max-memory","enable-hot-plug","disabled","onUpdateCpuMemory"]),(0,o.createElementVNode)("div",r,[(0,o.createVNode)(N,{value:e.sshKey,"onUpdate:value":t[2]||(t[2]=t=>e.sshKey=t),"create-namespace":!0,namespace:b.templateValue.metadata.namespace,"disable-create":e.isView,mode:e.mode,"onUpdate:sshKey":e.updateSSHKey},null,8,["value","namespace","disable-create","mode","onUpdate:sshKey"])])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"Volume",label:e.t("harvester.tab.volume"),weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{value:e.diskRows,"onUpdate:value":t[3]||(t[3]=t=>e.diskRows=t),mode:e.mode,namespace:a.value.metadata.namespace,"existing-volume-disabled":!0},null,8,["value","mode","namespace"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"Network",label:e.t("harvester.tab.network"),weight:-2},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{value:e.networkRows,"onUpdate:value":t[4]||(t[4]=t=>e.networkRows=t),mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"nodeScheduling",label:e.t("workload.container.titles.nodeScheduling"),weight:-3},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(E,{mode:e.mode,value:e.spec.template.spec,nodes:e.nodesIdOptions},null,8,["mode","value","nodes"])])),_:1},8,["label"]),(0,o.createVNode)(V,{label:e.t("harvester.tab.vmScheduling"),name:"vmScheduling",weight:-4},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(S,{mode:e.mode,value:e.spec.template.spec,nodes:e.nodes,"all-namespaces-option-available":!0,namespaces:e.filteredNamespaces,"overwrite-labels":e.affinityLabels},null,8,["mode","value","nodes","namespaces","overwrite-labels"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"labels",label:e.t("generic.labels"),weight:-9},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{k:"harvester.virtualMachine.labels.banner"})])),_:1}),(0,o.createVNode)(x,{key:"labels",value:a.value.labels,"add-label":e.t("labels.addLabel"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[5]||(t[5]=e=>a.value.setLabels(e))},null,8,["value","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"instanceLabel",label:e.t("harvester.tab.instanceLabel"),weight:-10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{k:"harvester.virtualMachine.instanceLabels.banner"})])),_:1}),(0,o.createVNode)(x,{key:"instance-labels",value:a.value.instanceLabels,"protected-keys":a.value.systemLabels||[],"toggle-filter":e.toggler,"add-label":e.t("labels.addLabel"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[6]||(t[6]=e=>a.value.setInstanceLabels(e))},null,8,["value","protected-keys","toggle-filter","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"annotations",label:e.t("harvester.tab.annotations"),weight:-11},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(A,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{k:"harvester.virtualMachine.annotations.banner"})])),_:1}),(0,o.createVNode)(x,{key:"annotations",value:a.value.annotations,"protected-keys":a.value.systemAnnotations||[],"toggle-filter":!0,"add-label":e.t("labels.addAnnotation"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[7]||(t[7]=e=>a.value.setAnnotations(e))},null,8,["value","protected-keys","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(V,{name:"advanced",label:e.t("harvester.tab.advanced"),weight:-99},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(D,{value:e.runStrategy,"onUpdate:value":t[8]||(t[8]=t=>e.runStrategy=t),"label-key":"harvester.virtualMachine.runStrategy",options:e.runStrategies,mode:e.mode},null,8,["value","options","mode"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(D,{value:e.osType,"onUpdate:value":t[9]||(t[9]=t=>e.osType=t),"label-key":"harvester.virtualMachine.osType",mode:e.mode,options:e.OS},null,8,["value","mode","options"])])]),(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(D,{value:e.maintenanceStrategy,"onUpdate:value":t[10]||(t[10]=t=>e.maintenanceStrategy=t),"label-key":"harvester.virtualMachine.maintenanceStrategy.label",options:e.maintenanceStrategies,"get-option-label":e.getMaintenanceStrategyOptionLabel,mode:e.mode},null,8,["value","options","get-option-label","mode"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(M,{"reserved-memory":e.reservedMemory,mode:e.mode,onUpdateReserved:e.updateReserved},null,8,["reserved-memory","mode","onUpdateReserved"])])]),(0,o.createElementVNode)("div",u,[e.showAdvanced?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:0,role:"button",onClick:t[11]||(t[11]=(...t)=>e.toggleAdvanced&&e.toggleAdvanced(...t))},null,512)),[[_,"harvester.generic.showMore"]]):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,role:"button",onClick:t[12]||(t[12]=(...t)=>e.toggleAdvanced&&e.toggleAdvanced(...t))},null,512)),[[_,"harvester.generic.showMore"]])]),e.showAdvanced?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(U,{value:e.terminationGracePeriodSeconds,"onUpdate:value":t[13]||(t[13]=t=>e.terminationGracePeriodSeconds=t),suffix:1==e.terminationGracePeriodSeconds?"Second":"Seconds",label:e.t("harvester.virtualMachine.terminationGracePeriodSeconds.label"),mode:e.mode,onChange:e.updateTerminationGracePeriodSeconds},null,8,["value","suffix","label","mode","onChange"])])])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(T,{ref:"yamlEditor",mode:e.mode,"user-script":e.userScript,namespace:b.templateValue.metadata.namespace,"network-script":e.networkScript,onUpdateUserData:e.updateUserData,onUpdateNetworkData:e.updateNetworkData},null,8,["mode","user-script","namespace","network-script","onUpdateUserData","onUpdateNetworkData"]),t[23]||(t[23]=(0,o.createElementVNode)("div",{class:"spacer"},null,-1)),a.value.cpuPinningFeatureEnabled?((0,o.openBlock)(),(0,o.createBlock)(k,{key:1,value:e.cpuPinning,"onUpdate:value":t[14]||(t[14]=t=>e.cpuPinning=t),class:"check",type:"checkbox","tooltip-key":"harvester.virtualMachine.cpuPinning.tooltip","label-key":"harvester.virtualMachine.cpuPinning.label",mode:e.mode},null,8,["value","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(k,{value:e.installUSBTablet,"onUpdate:value":t[15]||(t[15]=t=>e.installUSBTablet=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.enableUsb"),mode:e.mode},null,8,["value","label","mode"]),(0,o.createVNode)(k,{value:e.installAgent,"onUpdate:value":t[16]||(t[16]=t=>e.installAgent=t),class:"check",type:"checkbox","label-key":"harvester.virtualMachine.installAgent",mode:e.mode},null,8,["value","mode"]),(0,o.createVNode)(k,{value:e.tpmEnabled,"onUpdate:value":t[17]||(t[17]=t=>e.tpmEnabled=t),class:"check",type:"checkbox","label-key":"harvester.virtualMachine.advancedOptions.tpm",mode:e.mode},null,8,["value","mode"]),a.value.tpmPersistentStateFeatureEnabled&&e.tpmEnabled?((0,o.openBlock)(),(0,o.createBlock)(k,{key:2,value:e.tpmPersistentStateEnabled,"onUpdate:value":t[18]||(t[18]=t=>e.tpmPersistentStateEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.tpmPersistentState"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(k,{value:e.efiEnabled,"onUpdate:value":t[19]||(t[19]=t=>e.efiEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.efiEnabled"),mode:e.mode},null,8,["value","label","mode"]),a.value.efiPersistentStateFeatureEnabled&&e.efiEnabled?((0,o.openBlock)(),(0,o.createBlock)(k,{key:3,value:e.efiPersistentStateEnabled,"onUpdate:value":t[20]||(t[20]=t=>e.efiPersistentStateEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.efiPersistentState"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),e.efiEnabled?((0,o.openBlock)(),(0,o.createBlock)(k,{key:4,value:e.secureBoot,"onUpdate:value":t[21]||(t[21]=t=>e.secureBoot=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.secureBoot"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0)])),_:1,__:[23]},8,["label"])])),_:1},8,["onChanged"])])),_:1},8,["done-route","resource","mode","errors","apply-hooks","onFinish"])):(0,o.createCommentVNode)("",!0)}var b=a(65359),g=a(63209),f=a(42411),k=a(42200),y=a(43094),N=a(40527),V=a(89483),C=a(9980),w=a(38094),E=a(37329),S=a(1018),B=a(73344),A=a(92043),x=a(14220),D=a(2602),M=a(91825),U=a(8135),T=a(32766),I=a(48249),O=a(14869),_=a(55323),P=a(73705),$=a(81111),R=a(71574),L=a(383),q={name:"HarvesterEditVMTemplate",emits:["update:templateValue"],components:{Tab:f.A,SSHKey:L["default"],Volume:_["default"],Tabbed:g.A,Network:P["default"],Checkbox:k.S,CpuMemory:$["default"],CruResource:y.A,CloudConfig:R["default"],LabeledSelect:V.A,NameNsDescription:N.A,NodeScheduling:E.A,PodAffinity:S.A,Reserved:O["default"],UnitInput:B.A,Banner:C.l,KeyValue:w.A},mixins:[M.A,I.Ay],inheritAttrs:!1,props:{value:{type:Object,required:!0}},data(){this.mode===x.G5&&this.value.cleanForNew();const e=this.value.templateId||this.$route.query.templateId;return{templateId:e,templateValue:null,templateSpec:null,versionName:"",description:"",defaultVersion:null,isDefaultVersion:!1}},computed:{...(0,b.L8)({t:"i18n/t"}),isConfig(){return this.$route.query?.as===x.au||this.isView},realTemplateMode(){return this.templateId?x.nW:this.mode},secretNamePrefix(){return this.templateValue?.metadata?.name}},watch:{templateId:{async handler(e){const t=await this.$store.dispatch("harvester/findAll",{type:T.rk.VM_TEMPLATE});let a=t.find((t=>t.id===e))||null,o=a?.spec;a||(o={description:"",defaultVersionId:""},a=await this.$store.dispatch("harvester/create",{metadata:{name:"",namespace:""},spec:o,type:T.rk.VM_TEMPLATE})),this.templateValue=a,this.templateSpec=o},immediate:!0}},created(){this.registerAfterHook((async()=>{if(this.isDefaultVersion){const t=await this.$store.dispatch("harvester/findAll",{type:T.rk.VM_VERSION,opt:{force:!0}}),a=t.find((e=>e?.metadata?.annotations?.[D.r.TEMPLATE_VERSION_CUSTOM_NAME]===this.customName));if(a)try{this.templateValue.defaultVersionId=a.id;const e=[{op:"replace",path:"/spec/defaultVersionId",value:a.id}];await this.templateValue.patch(e,{url:this.templateValue.linkFor("view")})}catch(e){return Promise.reject(new Error(e.message))}}}))},mounted(){this.imageId=this.diskRows[0]?.image||""},methods:{async saveVMT(e){this.parseVM();const t=await this.$store.dispatch("harvester/findAll",{type:T.rk.VM_TEMPLATE}),a=t.find((e=>e.metadata.name===this.templateValue.metadata.name));try{if(this.templateId)a.save();else{if(!this.templateValue?.metadata?.name)return this.errors=[this.t("validation.required",{key:this.t("harvester.vmTemplate.nameNsDescription.name")})],void e(!1);await this.templateValue.save()}this.value.cleanForNew(),this.customName=(0,A.vx)(10),this.value.metadata["annotations"]={...this.value.metadata.annotations,[D.r.TEMPLATE_VERSION_CUSTOM_NAME]:this.customName};const t=this.templateValue.metadata.name||a.metadata.name,o=this.templateValue.metadata.namespace||a.metadata.namespace;this.isCreate&&(this.value.metadata.namespace=o),this.value.spec["templateId"]=`${o}/${t}`,this.value.spec.vm.metadata.labels={...this.value.spec.vm.metadata.labels,...this.value.metadata.labels},this.value.spec.vm.metadata.annotations={...this.value.spec.vm.metadata.annotations,...this.value.metadata.annotations};const r=await this.value.save();await this.saveSecret(r),await this.applyHooks(U.Mz),this.done()}catch(o){this.errors=[o],e(!1)}},onTabChanged({tab:e}){"advanced"===e.name&&this.$refs.yamlEditor?.refresh()}}},F=a(47433);const H=(0,F.A)(q,[["render",h]]);var G=H},68747:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var o=a(9274);const r={id:"restore"},l={class:"content"},s={class:"mb-20"},n={class:"row"},i={class:"col span-6"},d={class:"col span-6"};function c(e,t,a,c,u,p){const m=(0,o.resolveComponent)("RadioGroup"),v=(0,o.resolveComponent)("LabeledSelect"),h=(0,o.resolveComponent)("LabeledInput"),b=(0,o.resolveComponent)("Footer");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(m,{value:u.restoreNewVm,"onUpdate:value":t[0]||(t[0]=e=>u.restoreNewVm=e),name:"model",options:[!0,!1],labels:[e.t("harvester.backup.restore.createNew"),e.t("harvester.backup.restore.replaceExisting")],disabled:p.disableExisting,mode:e.mode},null,8,["value","labels","disabled","mode"])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(v,{value:u.namespace,"onUpdate:value":t[1]||(t[1]=e=>u.namespace=e),disabled:!0,label:e.t("nameNsDescription.namespace.label"),options:p.namespaces},null,8,["value","label","options"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(h,{value:u.name,"onUpdate:value":t[2]||(t[2]=e=>u.name=e),disabled:!u.restoreNewVm,label:e.t("harvester.backup.restore.virtualMachineName"),placeholder:e.t("nameNsDescription.name.placeholder"),class:"mb-20"},null,8,["value","disabled","label","placeholder"])])]),(0,o.createVNode)(v,{value:u.snapshotName,"onUpdate:value":t[3]||(t[3]=e=>u.snapshotName=e),class:"mb-20",label:e.t("harvester.vmSnapshot.snapshot"),options:p.snapshotOption},null,8,["value","label","options"]),u.restoreNewVm?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(v,{key:0,value:u.deletionPolicy,"onUpdate:value":t[4]||(t[4]=e=>u.deletionPolicy=e),label:e.t("harvester.backup.restore.deletePreviousVolumes"),options:p.deletionPolicyOption},null,8,["value","label","options"]))]),(0,o.createVNode)(b,{mode:"create",class:"footer",errors:e.errors,onSave:p.saveRestore,onDone:p.cancelAction},null,8,["errors","onSave","onDone"])])}var u=a(77262),p=a(10196),m=a(79380),v=a(89483),h=a(91825),b=a(88339),g=a(99726),f=a(35664),k=a(74302),y=a(76978),N=a(32766),V=a(41837);const C={apiVersion:"harvesterhci.io/v1beta1",kind:"VirtualMachineRestore",metadata:{name:"",namespace:""},type:N.rk.RESTORE,spec:{target:{apiGroup:"kubevirt.io",kind:"VirtualMachine",name:""},virtualMachineBackupName:"",newVM:!0,deletionPolicy:"retain"}};var w={name:"CreateRestore",components:{Footer:u.A,RadioGroup:p.z,LabeledInput:m.o,LabeledSelect:v.A},mixins:[h.A],async fetch(){await(0,b.kR)({backups:this.$store.dispatch("harvester/findAll",{type:N.rk.BACKUP}),vms:this.$store.dispatch("harvester/findAll",{type:N.rk.VM})})},data(){const e=this.$route.query?.restoreMode,t=this.$route.query?.resourceName,a=(0,y.o8)(C),o="new"===e||void 0===e;return{snapshotName:t,restoreNewVm:o,restoreResource:a,name:"",description:"",deletionPolicy:"retain",namespace:""}},computed:{snapshotOption(){const e=this.$store.getters["harvester/all"](N.rk.BACKUP);return e.filter((e=>{const t=this.restoreNewVm||e.attachVmExisting;return t&&e?.status?.readyToUse&&e.spec?.type===V.aS.SNAPSHOT})).map((e=>({label:e.metadata.name,value:e.metadata.name})))},deletionPolicyOption(){return[{value:"retain",label:"Retain"}]},currentBackupResource(){const e=this.snapshotName,t=this.$store.getters["harvester/all"](N.rk.BACKUP);return t.find((t=>t.name===e))},disableExisting(){return!this.currentBackupResource?.attachVmExisting},snapshotNamespace(){const e=this.$store.getters["harvester/all"](N.rk.BACKUP);return e.find((e=>e.metadata.name===this.snapshotName))?.metadata?.namespace},namespaces(){const e=this.$store.getters["currentStore"](f.CU),t=this.$store.getters[`${e}/all`](f.CU),a=this.$store.getters["systemNamespaces"],o=(0,k.Ul)(t.filter((e=>!a.includes(e.metadata.name))).map((e=>({label:e.nameDisplay,value:e.id}))),"label");return o}},watch:{snapshotName:{handler(e){this.currentBackupResource&&(this.restoreNewVm||(this.name=this?.currentBackupResource?.attachVM)),this.restoreResource.spec.virtualMachineBackupName=e},immediate:!0},restoreNewVm(e){this.name=e?"":this?.currentBackupResource?.attachVM},snapshotNamespace:{handler(e){this.namespace=e},immediate:!0}},methods:{cancelAction(){this.$router.go(-1)},async saveRestore(e){this.update();const t=await this.$store.dispatch("harvester/create",this.restoreResource);t.metadata.namespace=this.namespace,t.spec.virtualMachineBackupNamespace=this.snapshotNamespace;try{await t.save(),e(!0),this.$router.push({name:this.doneRoute,params:{resource:N.rk.VM}})}catch(a){this.errors=(0,g.rz)(a)||a,e(!1)}},update(){this.restoreResource.metadata.generateName=`restore-${this.snapshotName}-`,this.name&&(this.restoreResource.spec.target.name=this.name),this.restoreNewVm?(delete this.restoreResource.spec.deletionPolicy,this.restoreResource.spec.newVM=!0):(this.restoreResource.spec.deletionPolicy=this.deletionPolicy,delete this.restoreResource.spec.newVM)}},componentTitle(){return"restoreVM"}},E=(a(38673),a(47433));const S=(0,E.A)(w,[["render",c],["__scopeId","data-v-6c93c587"]]);var B=S},58852:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return I}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("NameNsDescription"),i=(0,o.resolveComponent)("LabeledSelect"),d=(0,o.resolveComponent)("UnitInput"),c=(0,o.resolveComponent)("Banner"),u=(0,o.resolveComponent)("Tab"),p=(0,o.resolveComponent)("LabeledInput"),m=(0,o.resolveComponent)("SortableTable"),v=(0,o.resolveComponent)("Conditions"),h=(0,o.resolveComponent)("ResourceTabs"),b=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(b,{"done-route":e.doneRoute,resource:e.value,mode:e.mode,errors:e.errors,"generate-yaml":s.generateYaml,"apply-hooks":e.applyHooks,onFinish:e.save,onError:t[17]||(t[17]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:e.value,namespaced:!0,"name-required":!1,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(h,{value:e.value,"onUpdate:value":t[16]||(t[16]=t=>e.value=t),class:"mt-15","need-conditions":!1,"need-related":!1,"side-tabs":!0,mode:e.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{name:"basic",label:e.t("harvester.volume.tabs.basics"),weight:3,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{value:l.source,"onUpdate:value":[t[1]||(t[1]=e=>l.source=e),s.update],label:e.t("harvester.volume.source"),options:s.sourceOption,disabled:!e.isCreate,required:"",mode:e.mode,class:"mb-20"},null,8,["value","label","options","disabled","mode","onUpdate:value"]),s.isVMImage?((0,o.openBlock)(),(0,o.createBlock)(i,{key:0,value:l.imageId,"onUpdate:value":[t[2]||(t[2]=e=>l.imageId=e),s.updateImage],label:e.t("harvester.volume.image"),options:s.imageOption,disabled:!e.isCreate,required:"",mode:e.mode,class:"mb-20"},null,8,["value","label","options","disabled","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0),s.isBlank?((0,o.openBlock)(),(0,o.createBlock)(i,{key:1,value:e.value.spec.storageClassName,"onUpdate:value":[t[3]||(t[3]=t=>e.value.spec.storageClassName=t),s.update],options:s.storageClassOptions,label:e.t("harvester.storage.storageClass.label"),mode:e.mode,class:"mb-20",disabled:!e.isCreate},null,8,["value","options","label","mode","disabled","onUpdate:value"])):(0,o.createCommentVNode)("",!0),s.showVolumeMode?((0,o.openBlock)(),(0,o.createBlock)(i,{key:2,value:e.value.spec.volumeMode,"onUpdate:value":[t[4]||(t[4]=t=>e.value.spec.volumeMode=t),s.update],label:e.t("harvester.volume.volumeMode"),options:s.volumeModeOptions,required:"",disabled:!e.isCreate,mode:e.mode,class:"mb-20"},null,8,["value","label","options","disabled","mode","onUpdate:value"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(d,{value:l.storage,"onUpdate:value":[t[5]||(t[5]=e=>l.storage=e),s.update],label:e.t("harvester.volume.size"),"input-exponent":3,"output-modifier":!0,increment:1024,mode:e.mode,disabled:s.isResizeDisabled,required:"",class:"mb-20",suffix:l.GIBIBYTE},null,8,["value","label","mode","disabled","suffix","onUpdate:value"]),s.isResizeDisabled?((0,o.openBlock)(),(0,o.createBlock)(c,{key:3,color:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.t("harvester.volume.longhorn.disableResize")),1)])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"]),e.isCreate?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(u,{key:0,name:"details",label:e.t("harvester.volume.tabs.details"),weight:2.5,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{value:s.frontendDisplay,"onUpdate:value":t[6]||(t[6]=e=>s.frontendDisplay=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.frontend")},null,8,["value","mode","label"]),(0,o.createVNode)(p,{value:s.attachedNode,"onUpdate:value":t[7]||(t[7]=e=>s.attachedNode=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.attachedNode")},null,8,["value","mode","label"]),(0,o.createVNode)(p,{value:s.endpoint,"onUpdate:value":t[8]||(t[8]=e=>s.endpoint=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.endpoint")},null,8,["value","mode","label"]),(0,o.createVNode)(i,{value:s.diskTags,"onUpdate:value":t[9]||(t[9]=e=>s.diskTags=e),multiple:!0,label:e.t("harvester.volume.diskTags"),options:[],disabled:!0,mode:e.mode,class:"mb-20"},null,8,["value","label","mode"]),(0,o.createVNode)(i,{value:s.nodeTags,"onUpdate:value":t[10]||(t[10]=e=>s.nodeTags=e),multiple:!0,label:e.t("harvester.volume.nodeTags"),options:[],disabled:!0,mode:e.mode,class:"mb-20"},null,8,["value","label","mode"]),(0,o.createVNode)(p,{value:s.lastBackup,"onUpdate:value":t[11]||(t[11]=e=>s.lastBackup=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.lastBackup")},null,8,["value","mode","label"]),(0,o.createVNode)(p,{value:s.lastBackupAt,"onUpdate:value":t[12]||(t[12]=e=>s.lastBackupAt=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.lastBackupAt")},null,8,["value","mode","label"]),(0,o.createVNode)(p,{value:s.replicasNumber,"onUpdate:value":t[13]||(t[13]=e=>s.replicasNumber=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.replicasNumber")},null,8,["value","mode","label"])])),_:1},8,["label"])),e.isCreate?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(u,{key:1,name:"instances",label:e.t("harvester.volume.tabs.snapshots"),weight:2,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,(0,o.mergeProps)(e.$attrs,{headers:s.snapshotHeaders,"default-sort-by":"age",rows:e.value.relatedVolumeSnapshotCounts,"key-field":"_key"}),null,16,["headers","rows"])])),_:1},8,["label"])),!e.isCreate&&e.value.spec.dataSource?((0,o.openBlock)(),(0,o.createBlock)(u,{key:2,name:"datasource",label:e.t("harvester.volume.tabs.datasource"),weight:1,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{value:s.dataSourceKind,"onUpdate:value":t[14]||(t[14]=e=>s.dataSourceKind=e),class:"mb-20",mode:e.mode,disabled:!0,label:e.t("harvester.volume.kind")},null,8,["value","mode","label"]),(0,o.createVNode)(p,{value:e.value.spec.dataSource.name,"onUpdate:value":t[15]||(t[15]=t=>e.value.spec.dataSource.name=t),mode:e.mode,disabled:!0,label:e.t("nameNsDescription.name.label")},null,8,["value","mode","label"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),e.isCreate?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(u,{key:3,name:"conditions",label:e.t("harvester.volume.tabs.conditions"),class:"bordered-table",mode:e.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{value:e.value},null,8,["value"])])),_:1},8,["label","mode"]))])),_:1},8,["value","mode"])])),_:1},8,["done-route","resource","mode","errors","generate-yaml","apply-hooks","onFinish"])}var l=a(42411),s=a(9085),n=a(43094),i=a(73344),d=a(61629),c=a(89483),u=a(79380),p=a(40527),m=a(50356),v=a(9980),h=a(88339),b=a(76978),g=a(35664),f=a(74302),k=a(37648),y=a(14220),N=a(91825),V=a(2602),C=a(68774),w=a(66905),E=a(32766),S=a(82877),B=a(15908),A=a(84757),x=a(41837),D=a(39407),M={name:"HarvesterVolume",emits:["update:value"],components:{Banner:v.l,Tab:l.A,UnitInput:i.A,CruResource:n.A,SortableTable:s.A,ResourceTabs:d.A,LabeledSelect:c.A,LabeledInput:u.o,NameNsDescription:p.A,Conditions:m.A},mixins:[N.A],inheritAttrs:!1,async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={images:this.$store.dispatch(`${e}/findAll`,{type:E.rk.IMAGE}),snapshots:this.$store.dispatch(`${e}/findAll`,{type:E.qY}),storages:this.$store.dispatch(`${e}/findAll`,{type:g.fJ}),pvs:this.$store.dispatch(`${e}/findAll`,{type:g.PV})};this.$store.getters[`${e}/schemaFor`](g.oe.VOLUMES)&&(t.longhornVolumes=this.$store.dispatch(`${e}/findAll`,{type:g.oe.VOLUMES})),this.$store.getters[`${e}/schemaFor`](g.oe.ENGINES)&&(t.longhornEngines=this.$store.dispatch(`${e}/findAll`,{type:g.oe.ENGINES}));const a=await(0,h.kR)(t);this.snapshots=a.snapshots,this.images=a.images;const o=this.$store.getters["harvester/all"](g.fJ).find((e=>e.isDefault));this.value.spec["storageClassName"]=this.value?.spec?.storageClassName||o?.metadata?.name||"longhorn"},data(){this.mode===y.YQ&&(this.value.spec.volumeMode=x.vU.BLOCK,this.value.spec.accessModes=["ReadWriteMany"]);const e=this.value?.spec?.resources?.requests?.storage||null,t=(0,b.Jt)(this.value,`metadata.annotations."${V.r.IMAGE_ID}"`),a=t?"url":"blank";return{source:a,storage:e,imageId:t,snapshots:[],images:[],GIBIBYTE:A.Wl}},created(){this.registerBeforeHook(this.willSave,"willSave")},computed:{isBlank(){return"blank"===this.source},isEdit(){return this.mode===y.G5},isVMImage(){return"url"===this.source},longhornV2LVMSupport(){return this.$store.getters["harvester-common/getFeatureEnabled"]("longhornV2LVMSupport")},sourceOption(){return[{value:"blank",label:this.t("harvester.volume.sourceOptions.new")},{value:"url",label:this.t("harvester.volume.sourceOptions.vmImage")}]},interfaceOption(){return w.$z},volumeModeOptions(){return Object.values(x.vU)},imageOption(){return(0,f.Ul)(this.images.filter((e=>e.isReady)).map((e=>({label:`${e.metadata.namespace}/${e.spec.displayName}`,value:e.id}))),"label")},snapshotHeaders(){return[C.c4,C.o_,C.CU,{name:"size",labelKey:"tableHeaders.size",value:"status.restoreSize",sort:"size",formatter:"Si",formatterOpts:{opts:{increment:1024,addSuffix:!0,maxExponent:3,minExponent:3,suffix:"i"},needParseSi:!0}},{name:"readyToUse",labelKey:"tableHeaders.readyToUse",value:"status.readyToUse",align:"left",formatter:"Checked"},C.K]},dataSourceKind(){return w.$E[this.value.spec?.dataSource?.kind]},storageClasses(){const e=this.$store.getters["currentProduct"].inStore;return this.$store.getters[`${e}/all`](g.fJ)},isLonghornStorageClass(){const e=this.storageClasses.find((e=>e.name===this.value?.spec?.storageClassName))||{};return e&&e.isLonghorn},showVolumeMode(){return!(!this.value.thirdPartyStorageFeatureEnabled||this.isVMImage||!1===!!this.value?.spec?.storageClassName)&&!this.isLonghornStorageClass},storageClassOptions(){return this.storageClasses.filter((e=>!e.parameters?.backingImage)).map((e=>{let t=e.isDefault?`${e.name} (${this.t("generic.default")})`:e.name,a=!1;return(0,D.N)(e.name)&&(t+=` (${this.t("harvester.storage.internal.label")})`,a=!0),{label:t,value:e.name,disabled:a}}))||[]},frontend(){return this.value.longhornVolume?.spec?.frontend},frontendDisplay(){const e=["blockdev"];return e.includes(this.frontend)?this.t(`harvester.volume.${this.frontend}`):this.frontend},attachedNode(){return this.value.longhornVolume?.spec?.nodeID},endpoint(){return this.value.longhornEngine?.status?.endpoint},diskTags(){return this.value.longhornVolume?.spec?.diskSelector},nodeTags(){return this.value.longhornVolume?.spec?.nodeSelector},replicasNumber(){return this.value.longhornVolume?.spec?.numberOfReplicas},lastBackup(){return this.value.longhornVolume?.status?.lastBackup},lastBackupAt(){return this.value.longhornVolume?.status?.lastBackupAt},rebuildStatus(){return this.value.longhornEngine?.status?.rebuildStatus},isLHV2VolExpansionFeatureEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("lhV2VolExpansion")},isResizeDisabled(){return!this.isLHV2VolExpansionFeatureEnabled&&this.value?.isLonghornV2&&this.isEdit}},watch:{source(e){"url"===e&&(this.setBlockVolumeMode(),this.deleteVolumeForVmAnnotation())},"value.spec.storageClassName"(){this.isLonghornStorageClass&&(this.setBlockVolumeMode(),this.deleteVolumeForVmAnnotation())},"value.spec.volumeMode"(e){e===x.vU.FILE_SYSTEM?this.setVolumeForVmAnnotation():e===x.vU.BLOCK&&this.deleteVolumeForVmAnnotation()}},methods:{setBlockVolumeMode(){this.value.spec.volumeMode=x.vU.BLOCK},setVolumeForVmAnnotation(){this.value.setAnnotation(V.r.VOLUME_FOR_VM,"true")},deleteVolumeForVmAnnotation(){this.value?.metadata?.annotations?.[V.r.VOLUME_FOR_VM]&&delete this.value.metadata.annotations[V.r.VOLUME_FOR_VM]},getAccessMode(){if(!this.longhornV2LVMSupport)return["ReadWriteMany"];if(this.value?.spec?.accessModes&&this.value?.spec?.accessModes?.length>0)return this.value.spec.accessModes;const e=this.value.spec.storageClassName,t=this.storageClasses.find((t=>t.name===e));let a=this.value.isLvm||!this.value.thirdPartyStorageFeatureEnabled&&this.value.isLonghornV2;return t&&(a=t.provisioner===S.LVM_DRIVER||!this.value.thirdPartyStorageFeatureEnabled&&t.parameters?.dataEngine===B.DATA_ENGINE_V2),a?["ReadWriteOnce"]:["ReadWriteMany"]},willSave(){this.update()},update(){let e="",t=this.value.spec.storageClassName;if(this.isVMImage&&this.imageId){const a=this.$store.getters["harvester/all"](E.rk.IMAGE);e={...this.value.metadata.annotations,[V.r.IMAGE_ID]:this.imageId},t=a?.find((e=>this.imageId===e.id))?.storageClassName}else e={...this.value.metadata.annotations};const a={...this.value.spec,resources:{requests:{storage:this.storage}},storageClassName:t,accessModes:this.getAccessMode()};this.value.setAnnotations(e),this.value["spec"]=a},updateImage(){if(this.isVMImage&&this.imageId){const e=this.images?.find((e=>this.imageId===e.id)),t=Math.max(e?.status?.size,e?.status?.virtualSize);t&&(this.storage=`${Math.ceil(t/1024/1024/1024)}${A.Wl}`)}this.update()},generateYaml(){const e=(0,k.Kq)(this.value);return e}}},U=a(47433);const T=(0,U.A)(M,[["render",r]]);var I=T},33514:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var o=a(9274);const r={class:"row"},l={class:"col span-12"},s={class:"row"},n={class:"col span-12"},i={key:0,class:"row"},d={class:"col span-12"};function c(e,t,a,c,u,p){const m=(0,o.resolveComponent)("NameNsDescription"),v=(0,o.resolveComponent)("LabeledInput"),h=(0,o.resolveComponent)("Tab"),b=(0,o.resolveComponent)("ResourceTabs"),g=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(g,{"done-route":e.doneRoute,resource:e.value,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,onFinish:e.save,onError:t[5]||(t[5]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{value:e.value,namespaced:!0,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(b,{value:e.value,"onUpdate:value":t[4]||(t[4]=t=>e.value=t),class:"mt-15","need-conditions":!1,"need-related":!1,"side-tabs":!0,mode:e.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{name:"basics",label:e.t("harvester.virtualMachine.detail.tabs.basics"),class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(v,{value:p.size,"onUpdate:value":t[1]||(t[1]=e=>p.size=e),label:e.t("harvester.snapshot.size"),class:"mt-20",disabled:!0},null,8,["value","label"])])]),(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(v,{value:p.targetVolume,"onUpdate:value":t[2]||(t[2]=e=>p.targetVolume=e),label:e.t("harvester.snapshot.targetVolume"),class:"mt-20",disabled:!0},null,8,["value","label"])])]),p.isImageVolume?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(v,{value:p.imageName,"onUpdate:value":t[3]||(t[3]=e=>p.imageName=e),label:e.t("harvester.snapshot.image"),class:"mt-20",disabled:!0},null,8,["value","label"])])])):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])])),_:1},8,["value","mode"])])),_:1},8,["done-route","resource","mode","errors","apply-hooks","onFinish"])])}var u=a(42411),p=a(43094),m=a(61629),v=a(79380),h=a(40527),b=a(76978),g=a(91825),f=a(2841),k=a(32766),y={name:"HarvesterSnapshot",emits:["update:value"],components:{LabeledInput:v.o,Tab:u.A,ResourceTabs:m.A,CruResource:p.A,NameNsDescription:h.A},mixins:[g.A],inheritAttrs:!1,computed:{volume(){return this.volumes.find((e=>e.metadata.name===this.targetVolume))},size(){return this.value?.status?.restoreSize},isImageVolume(){return!!(0,b.Jt)(this.value,`metadata.annotations."${f.rk.IMAGE_ID}"`)},imageName(){const e=this.$store.getters["harvester/all"](k.rk.IMAGE).find((e=>e.id===(0,b.Jt)(this.value,`metadata.annotations."${f.rk.IMAGE_ID}"`)));return e?.spec?.displayName},targetVolume(){return this.value?.spec?.source?.persistentVolumeClaimName}}},N=a(47433);const V=(0,N.A)(y,[["render",c]]);var C=V},49270:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var o=a(9274);const r=["disabled","onClick"],l={class:"row"},s={class:"col span-4"},n={class:"col span-4"},i={class:"col span-3"},d={class:"row"},c={class:"col span-11"},u=["disabled"];function p(e,t,a,p,m,v){const h=(0,o.resolveComponent)("t"),b=(0,o.resolveComponent)("Banner"),g=(0,o.resolveComponent)("LabeledSelect"),f=(0,o.resolveComponent)("LabeledInput"),k=(0,o.resolveComponent)("InfoBox");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[m.rows.length>0?((0,o.openBlock)(),(0,o.createBlock)(b,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{k:"harvester.subnet.acl.banner",raw:!0})])),_:1})):(0,o.createCommentVNode)("",!0),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(m.rows,((u,p)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:p},[(0,o.createVNode)(k,{class:"box"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("button",{type:"button",class:"role-link btn btn-sm removeBtn",disabled:v.isView,onClick:e=>v.removeRule(p)},t[1]||(t[1]=[(0,o.createElementVNode)("i",{class:"icon icon-x"},null,-1)]),8,r),(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(g,{value:u.action,"onUpdate:value":[e=>u.action=e,v.update],mode:a.mode,class:"mt-5 ml-5",options:v.actionOptions,required:!0,label:e.t("harvester.subnet.acl.action.label"),placeholder:e.t("harvester.subnet.acl.action.placeholder")},null,8,["value","onUpdate:value","mode","options","label","placeholder"])]),(0,o.createElementVNode)("div",n,[(0,o.createVNode)(g,{value:u.direction,"onUpdate:value":[e=>u.direction=e,v.update],mode:a.mode,options:v.directionOptions,class:"mt-5",required:!0,label:e.t("harvester.subnet.acl.direction.label"),placeholder:e.t("harvester.subnet.acl.direction.placeholder")},null,8,["value","onUpdate:value","mode","options","label","placeholder"])]),(0,o.createElementVNode)("div",i,[(0,o.createVNode)(f,{value:u.priority,"onUpdate:value":[e=>u.priority=e,v.update],valueModifiers:{number:!0},type:"number",class:"mb-20 mt-5",max:32767,min:0,mode:a.mode,required:"","label-key":"harvester.subnet.acl.priority.label"},null,8,["value","onUpdate:value","mode"])])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(f,{value:u.match,"onUpdate:value":[e=>u.match=e,v.update],class:"mb-5 ml-5",mode:a.mode,required:"",placeholder:e.t("harvester.subnet.acl.match.placeholder"),"label-key":"harvester.subnet.acl.match.label"},null,8,["value","onUpdate:value","mode","placeholder"])])])])),_:2},1024)])))),128)),(0,o.createElementVNode)("button",{type:"button",class:"btn role-tertiary add",disabled:v.isView,onClick:t[0]||(t[0]=e=>v.add())},[(0,o.createVNode)(h,{k:"harvester.subnet.acl.addRule"})],8,u)])}var m=a(12784),v=a.n(m),h=a(14220),b=a(68851),g=a(9980),f=a(26962),k=a(89483),y=a(79380),N={name:"AccessControlList",emits:["update:value"],components:{Banner:g.l,InfoBox:f.A,LabeledSelect:k.A,LabeledInput:y.o},props:{value:{type:Array,default:null},mode:{type:String,default:h.G5}},data(){const e=(this.value||[]).map((e=>({action:e.action||"",direction:e.direction||"",priority:e.priority||0,match:e.match||""})));return{rows:e}},computed:{isView(){return this.mode===h.nW},actionOptions(){return[{label:"Allow",value:"allow"},{label:"Drop",value:"drop"},{label:"Pass",value:"pass"},{label:"Reject",value:"reject"},{label:"Allow-related",value:"allow-related"},{label:"Allow-stateless",value:"allow-stateless"}]},directionOptions(){return[{label:"To-lport",value:"to-lport"},{label:"From-lport",value:"from-lport"}]}},created(){this.queueUpdate=v()(this.update,100)},methods:{add(){this.rows.push({action:"",direction:"",priority:this.rows.length,match:""}),this.queueUpdate()},removeRule(e){(0,b.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},V=(a(52045),a(47433));const C=(0,V.A)(N,[["render",p],["__scopeId","data-v-590f4df4"]]);var w=C},77252:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return K}});var o=a(9274);const r={class:"row mt-10"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mt-10"},i={class:"col span-6"},d={class:"col span-6"},c={class:"row mt-20"},u={class:"col span-6"},p={class:"row mt-20"},m={class:"col span-6"},v={class:"row mt-20"},h={class:"col span-6"},b={class:"box"},g={class:"key"},f={class:"icon icon-info",tabindex:"0"},k={class:"key"},y=["onUpdate:modelValue","placeholder"],N={class:"box"},V={class:"key"},C={class:"icon icon-info",tabindex:"0"},w={class:"key"},E=["onUpdate:modelValue","placeholder"];function S(e,t,a,S,B,A){const x=(0,o.resolveComponent)("Loading"),D=(0,o.resolveComponent)("NameNsDescription"),M=(0,o.resolveComponent)("LabeledInput"),U=(0,o.resolveComponent)("LabeledSelect"),T=(0,o.resolveComponent)("RadioGroup"),I=(0,o.resolveComponent)("t"),O=(0,o.resolveComponent)("Banner"),_=(0,o.resolveComponent)("ArrayList"),P=(0,o.resolveComponent)("Tab"),$=(0,o.resolveComponent)("AccessControlList"),R=(0,o.resolveComponent)("ResourceTabs"),L=(0,o.resolveComponent)("CruResource"),q=(0,o.resolveDirective)("clean-tooltip"),F=(0,o.resolveDirective)("stripped-aria-label");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(x,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(L,{key:1,"done-route":e.doneRoute,resource:e.value,mode:e.mode,"apply-hooks":e.applyHooks,errors:e.errors,onFinish:A.saveSubnet,onError:t[13]||(t[13]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(D,{value:e.value,mode:e.mode,namespaced:!1,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(R,{class:"mt-15","need-events":!1,"need-related":!1,mode:e.mode,"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(P,{name:"Basic",label:e.t("generic.basic"),weight:-1,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(M,{value:e.value.spec.cidrBlock,"onUpdate:value":t[1]||(t[1]=t=>e.value.spec.cidrBlock=t),class:"mb-20",required:"",placeholder:e.t("harvester.subnet.cidrBlock.placeholder"),label:e.t("harvester.subnet.cidrBlock.label"),mode:e.mode},null,8,["value","placeholder","label","mode"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(U,{value:e.value.spec.protocol,"onUpdate:value":t[2]||(t[2]=t=>e.value.spec.protocol=t),label:e.t("harvester.subnet.protocol.label"),options:A.protocolOptions,required:"",mode:e.mode},null,8,["value","label","options","mode"])])]),(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(U,{value:A.provider,"onUpdate:value":t[3]||(t[3]=e=>A.provider=e),label:e.t("harvester.subnet.provider.label"),options:A.providerOptions,tooltip:e.t("harvester.subnet.provider.tooltip"),required:"",mode:e.mode},null,8,["value","label","options","tooltip","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(U,{value:e.value.spec.vpc,"onUpdate:value":t[4]||(t[4]=t=>e.value.spec.vpc=t),label:e.t("harvester.subnet.vpc.label"),options:A.vpcOptions,required:"",disabled:!0,mode:e.mode},null,8,["value","label","options","mode"])])]),(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createVNode)(M,{value:e.value.spec.gateway,"onUpdate:value":t[5]||(t[5]=t=>e.value.spec.gateway=t),class:"mb-20",placeholder:e.t("harvester.subnet.gateway.placeholder"),label:e.t("harvester.subnet.gateway.label"),mode:e.mode},null,8,["value","placeholder","label","mode"])])]),(0,o.createElementVNode)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createVNode)(T,{value:e.value.spec.enableDHCP,"onUpdate:value":t[6]||(t[6]=t=>e.value.spec.enableDHCP=t),name:"enabled",options:[!0,!1],label:e.t("harvester.subnet.dhcp.label"),labels:[e.t("generic.enabled"),e.t("generic.disabled")],mode:e.mode,tooltip:e.t("harvester.subnet.dhcp.tooltip")},null,8,["value","label","labels","mode","tooltip"]),e.value.spec.enableDHCP&&"IPv4"===e.value.spec.protocol?((0,o.openBlock)(),(0,o.createBlock)(M,{key:0,value:e.value.spec.dhcpV4Options,"onUpdate:value":t[7]||(t[7]=t=>e.value.spec.dhcpV4Options=t),class:"mb-20 mt-20",placeholder:e.t("harvester.subnet.dhcp.placeholder"),label:e.t("harvester.subnet.dhcp.v4Options"),mode:e.mode},null,8,["value","placeholder","label","mode"])):(0,o.createCommentVNode)("",!0),e.value.spec.enableDHCP&&"IPv6"===e.value.spec.protocol?((0,o.openBlock)(),(0,o.createBlock)(M,{key:1,value:e.value.spec.dhcpV6Options,"onUpdate:value":t[8]||(t[8]=t=>e.value.spec.dhcpV6Options=t),placeholder:e.t("harvester.subnet.dhcp.placeholder"),class:"mb-20 mt-20",label:e.t("harvester.subnet.dhcp.v6Options"),mode:e.mode},null,8,["value","placeholder","label","mode"])):(0,o.createCommentVNode)("",!0),e.value.spec.enableDHCP?((0,o.openBlock)(),(0,o.createBlock)(O,{key:2,color:"info",class:"dhcpOption-banner"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(I,{k:"harvester.subnet.dhcp.dhcpOptionBanner",raw:!0})])),_:1})):(0,o.createCommentVNode)("",!0)])]),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createVNode)(T,{value:e.value.spec.private,"onUpdate:value":t[9]||(t[9]=t=>e.value.spec.private=t),name:"enabled",options:[!0,!1],label:e.t("harvester.subnet.private.label"),labels:[e.t("generic.enabled"),e.t("generic.disabled")],mode:e.mode,"tooltip-key":"harvester.subnet.private.tooltip"},null,8,["value","label","labels","mode"])])]),A.showAllowSubnets?((0,o.openBlock)(),(0,o.createBlock)(_,{key:0,value:e.value.spec.allowSubnets,"onUpdate:value":t[10]||(t[10]=t=>e.value.spec.allowSubnets=t),"show-header":!0,class:"mt-20",mode:e.mode,"add-label":e.t("harvester.subnet.allowSubnet.addSubnet")},{"column-headers":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",b,[(0,o.createElementVNode)("h3",g,[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.subnet.allowSubnet.label"))+" ",1),(0,o.withDirectives)((0,o.createElementVNode)("i",f,null,512),[[q,{content:A.allowSubnetTooltip,triggers:["hover","touch","focus"]}],[F,A.allowSubnetTooltip]])])])])),columns:(0,o.withCtx)((t=>[(0,o.createElementVNode)("div",k,[(0,o.withDirectives)((0,o.createElementVNode)("input",{"onUpdate:modelValue":e=>t.row.value=e,placeholder:e.t("harvester.subnet.allowSubnet.placeholder")},null,8,y),[[o.vModelText,t.row.value]])])])),_:1},8,["value","mode","add-label"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(_,{value:e.value.spec.excludeIps,"onUpdate:value":t[11]||(t[11]=t=>e.value.spec.excludeIps=t),"show-header":!0,class:"mt-20",mode:e.mode,"add-label":e.t("harvester.setting.storageNetwork.exclude.addIp")},{"column-headers":(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",N,[(0,o.createElementVNode)("h3",V,[(0,o.createTextVNode)((0,o.toDisplayString)(e.t("harvester.setting.storageNetwork.exclude.label"))+" ",1),(0,o.withDirectives)((0,o.createElementVNode)("i",C,null,512),[[q,{content:A.excludeIPsTooltip,triggers:["hover","touch","focus"]}],[F,A.excludeIPsTooltip]])])])])),columns:(0,o.withCtx)((t=>[(0,o.createElementVNode)("div",w,[(0,o.withDirectives)((0,o.createElementVNode)("input",{"onUpdate:modelValue":e=>t.row.value=e,placeholder:e.t("harvester.subnet.excludeIPs.placeholder")},null,8,E),[[o.vModelText,t.row.value]])])])),_:1},8,["value","mode","add-label"])])),_:1},8,["label"]),(0,o.createVNode)(P,{name:"ACL",label:e.t("harvester.subnet.acl.label"),weight:-2,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{value:e.value.spec.acls,"onUpdate:value":t[12]||(t[12]=t=>e.value.spec.acls=t),mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"])])),_:1},8,["mode"])])),_:1},8,["done-route","resource","mode","apply-hooks","errors","onFinish"]))}var B=a(43094),A=a(40527),x=a(89483),D=a(79380),M=a(42411),U=a(35664),T=a(87619),I=a(91825),O=a(10196),_=a(41837),P=a(76978),$=a(64676),R=a(88339),L=a(32766),q=a(61629),F=a(9980),H=a(49270),G={name:"EditSubnet",emits:["update:value"],components:{Banner:F.l,CruResource:B.A,LabeledInput:D.o,LabeledSelect:x.A,NameNsDescription:A.A,Tab:M.A,RadioGroup:O.z,ArrayList:$.A,ResourceTabs:q.A,Loading:T.A,AccessControlList:H["default"]},mixins:[I.A],inheritAttrs:!1,created(){const e=this.$route.query.vpc||"",t=this.value?.spec?.enableDHCP||!1;(0,P.hZ)(this.value.spec,"enableDHCP",t),(0,P.hZ)(this.value,"spec",this.value.spec||{cidrBlock:"",protocol:_.s4.IPv4,provider:"",vpc:e,gatewayIP:"",excludeIps:[],private:!1,enableDHCP:t,acls:[]})},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={vpc:this.$store.dispatch(`${e}/findAll`,{type:L.rk.VPC}),nad:this.$store.dispatch(`${e}/findAll`,{type:U.XG})};await(0,R.kR)(t)},computed:{showAllowSubnets(){return!0===this.value?.spec?.private},doneLocationOverride(){return this.value.doneOverride},allowSubnetTooltip(){return this.t("harvester.subnet.allowSubnet.tooltip",null,!0)},excludeIPsTooltip(){return this.t("harvester.subnet.excludeIPs.tooltip",null,!0)},protocolOptions(){return Object.values(_.s4)},provider:{get(){const e=this.value.spec.provider;if(!e)return"";const t=e.split(".")[0]||"",a=e.split(".")[1]||"";return`${a}/${t}`},set(e){const t=e.split("/")[0]||"",a=e.split("/")[1]||"",o=`${a}.${t}.ovn`;(0,P.hZ)(this.value,"spec.provider",o)}},providerOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](U.XG)||[];return t.filter((e=>e.vlanType===_.AW.OVERLAY)).map((e=>({label:e.id,value:e.id})))},vpcOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](L.rk.VPC)||[];return t.map((e=>({label:e.id,value:e.id})))}},watch:{"value.spec.enableDHCP":{handler(e){!1===e&&(this.value.spec.dhcpV4Options="",this.value.spec.dhcpV6Options="")}}},methods:{async saveSubnet(e){const t=[],a=this.value?.metadata?.name,o=this.value?.spec?.acls?.some((e=>!e.match||!e.action||void 0===e.priority||null===e.priority));try{if(a?this.value?.spec?.cidrBlock?this.value?.spec?.provider?this.value.spec.excludeIps.includes("")?t.push(this.t("harvester.validation.subnet.excludeIps")):o&&t.push(this.t("harvester.validation.subnet.aclEmptyError")):t.push(this.t("validation.required",{key:this.t("harvester.subnet.provider.label")},!0)):t.push(this.t("validation.required",{key:this.t("harvester.subnet.cidrBlock.label")},!0)):t.push(this.t("validation.required",{key:this.t("generic.name")},!0)),t.length>0)return e(!1),this.errors=t,!1;await this.value.save(),e(!0),this.done()}catch(r){this.errors=[r],e(!1)}}}},j=(a(40028),a(47433));const J=(0,j.A)(G,[["render",S],["__scopeId","data-v-e1da6b10"]]);var K=J},25017:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var o=a(9274);const r={key:0,class:"static-route-row"},l={class:"pool-headers cidr"},s={class:"pool-cidr"},n={class:"pool-nextHopIP"},i={class:"icon icon-info",tabindex:"0"},d={class:"pool-row cidr"},c={class:"pool-cidr"},u={key:0},p=["onUpdate:modelValue","placeholder"],m={class:"pool-nextHopIP"},v={key:0},h=["onUpdate:modelValue","placeholder"],b=["onClick"];function g(e,t,a,g,f,k){const y=(0,o.resolveComponent)("t"),N=(0,o.resolveComponent)("Banner"),V=(0,o.resolveDirective)("clean-tooltip"),C=(0,o.resolveDirective)("stripped-aria-label");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(N,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{k:"harvester.vpc.vpcPeerings.infoBanner",raw:!0,url:k.vpcPeeringExamplesLink},null,8,["url"])])),_:1}),f.rows.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(f.rows,((a,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:r},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("span",s,[(0,o.createVNode)(y,{k:"harvester.vpc.staticRoutes.cidr.label"})]),(0,o.createElementVNode)("span",n,[(0,o.createVNode)(y,{k:"harvester.vpc.staticRoutes.nextHopIP.label"}),(0,o.withDirectives)((0,o.createElementVNode)("i",i,null,512),[[V,{content:k.nextHopIPTooltip,triggers:["hover","touch","focus"]}],[C,k.nextHopIPTooltip]])])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[k.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(a.cidr),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.cidr=e,type:"text",placeholder:e.t("harvester.vpc.staticRoutes.cidr.placeholder"),onInput:t[0]||(t[0]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,p)),[[o.vModelText,a.cidr]])]),(0,o.createElementVNode)("div",m,[k.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",v,(0,o.toDisplayString)(a.nextHopIP),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.nextHopIP=e,type:"text",placeholder:e.t("harvester.vpc.staticRoutes.nextHopIP.placeholder"),onInput:t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,h)),[[o.vModelText,a.nextHopIP]])]),k.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-link pl-0",onClick:e=>k.remove(r)},[(0,o.createVNode)(y,{k:"generic.remove"})],8,b)):(0,o.createCommentVNode)("",!0)])])))),128))])):(0,o.createCommentVNode)("",!0),k.showAdd?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"btn role-tertiary add",onClick:t[2]||(t[2]=e=>k.add())},[(0,o.createVNode)(y,{k:"generic.add"})])):(0,o.createCommentVNode)("",!0)])}var f=a(12784),k=a.n(f),y=a(14220),N=a(68851),V=a(9980),C=a(66242),w=a(3791),E={name:"StaticRoutes",emits:["update:value"],components:{Banner:V.l},props:{value:{type:Array,default:null},mode:{type:String,default:y.G5}},data(){const e=(this.value||[]).map((e=>({cidr:e.cidr||"",nextHopIP:e.nextHopIP||""})));return{rows:e}},computed:{isView(){return this.mode===y.nW},showAdd(){return!this.isView},showRemove(){return!this.isView},nextHopIPTooltip(){return this.t("harvester.vpc.staticRoutes.nextHopIP.tooltip")},vpcPeeringExamplesLink(){const e=this.$store.getters["harvester-common/getServerVersion"]();return(0,w.nn)(C.d.VPC_CONFIGURATION_EXAMPLES,e)}},created(){this.queueUpdate=k()(this.update,100)},methods:{add(){this.rows.push({cidr:"",nextHopIP:""}),this.queueUpdate()},remove(e){(0,N.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},S=(a(17109),a(47433));const B=(0,S.A)(E,[["render",g],["__scopeId","data-v-cff1ac6e"]]);var A=B},57477:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var o=a(9274);const r={key:0,class:"static-route-row"},l={class:"pool-headers localConnectIP"},s={class:"pool-localConnectIP"},n={class:"icon icon-info",tabindex:"0"},i={class:"pool-remoteVpc"},d={class:"pool-row localConnectIP"},c={class:"pool-localConnectIP"},u={key:0},p=["onUpdate:modelValue","placeholder"],m={class:"pool-remoteVpc"},v={key:0},h=["onClick"];function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("t"),y=(0,o.resolveComponent)("LabeledSelect"),N=(0,o.resolveDirective)("clean-tooltip"),V=(0,o.resolveDirective)("stripped-aria-label");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[g.rows.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(g.rows,((r,b)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:b},[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("span",s,[(0,o.createVNode)(k,{k:"harvester.vpc.vpcPeerings.localConnectIP.label"}),(0,o.withDirectives)((0,o.createElementVNode)("i",n,null,512),[[N,{content:f.localConnectIPTooltip,triggers:["hover","touch","focus"]}],[V,e.localConnectPTooltip]])]),(0,o.createElementVNode)("span",i,[(0,o.createVNode)(k,{k:"harvester.vpc.vpcPeerings.remoteVpc.label"})])]),(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[f.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(r.localConnectIP),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>r.localConnectIP=e,type:"text",placeholder:e.t("harvester.vpc.vpcPeerings.localConnectIP.placeholder"),onInput:t[0]||(t[0]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,p)),[[o.vModelText,r.localConnectIP]])]),(0,o.createElementVNode)("div",m,[f.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",v,(0,o.toDisplayString)(r.remoteVpc),1)):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(y,{value:r.remoteVpc,"onUpdate:value":[e=>r.remoteVpc=e,e.queueUpdate],options:f.remoteVpcOptions,mode:a.mode},null,8,["value","onUpdate:value","options","mode"])]),f.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:0,type:"button",class:"btn role-link pl-0",onClick:e=>f.remove(b)},[(0,o.createVNode)(k,{k:"generic.remove"})],8,h)):(0,o.createCommentVNode)("",!0)])])))),128))])):(0,o.createCommentVNode)("",!0),f.showAdd?((0,o.openBlock)(),(0,o.createElementBlock)("button",{key:1,type:"button",class:"btn role-tertiary add",onClick:t[1]||(t[1]=e=>f.add())},[(0,o.createVNode)(k,{k:"generic.add"})])):(0,o.createCommentVNode)("",!0)])}var g=a(12784),f=a.n(g),k=a(14220),y=a(68851),N=a(32766),V=a(89483),C={name:"VpcPeerings",emits:["update:value"],components:{LabeledSelect:V.A},props:{value:{type:Array,default:null},mode:{type:String,default:k.G5},vpc:{type:Object,default:()=>({})}},async fetch(){await this.$store.dispatch("harvester/findAll",{type:N.rk.VPC})},data(){const e=(this.value||[]).map((e=>({localConnectIP:e.localConnectIP||"",remoteVpc:e.remoteVpc||""})));return{rows:e}},computed:{isView(){return this.mode===k.nW},isEdit(){return this.mode===k.G5},showAdd(){return!this.isView},showRemove(){return!this.isView},remoteVpcOptions(){const e=this.$store.getters["harvester/all"](N.rk.VPC)||[],t=this.isEdit?e.filter((e=>e.id!==this.vpc.id)):e;return t.map((e=>({label:e.id,value:e.id})))},localConnectIPTooltip(){return this.t("harvester.vpc.vpcPeerings.localConnectIP.tooltip")}},created(){this.queueUpdate=f()(this.update,100)},methods:{add(){this.rows.push({localConnectIP:"",remoteVpc:""}),this.queueUpdate()},remove(e){(0,y.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},w=(a(79891),a(47433));const E=(0,w.A)(C,[["render",b],["__scopeId","data-v-4bce4a2b"]]);var S=E},18411:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("Loading"),i=(0,o.resolveComponent)("NameNsDescription"),d=(0,o.resolveComponent)("StaticRoutes"),c=(0,o.resolveComponent)("Tab"),u=(0,o.resolveComponent)("VpcPeerings"),p=(0,o.resolveComponent)("ResourceTabs"),m=(0,o.resolveComponent)("CruResource");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(n,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(m,{key:1,"done-route":e.doneRoute,resource:e.value,mode:e.mode,"apply-hooks":e.applyHooks,errors:e.errors,onFinish:s.saveVpc,onError:t[3]||(t[3]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{value:e.value,mode:e.mode,namespaced:!1,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(p,{class:"mt-15",mode:e.mode,"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{name:"staticRoutes",label:e.t("harvester.vpc.staticRoutes.label"),weight:-1,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{value:e.value.spec.staticRoutes,"onUpdate:value":t[1]||(t[1]=t=>e.value.spec.staticRoutes=t),class:"col span-12",mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"]),(0,o.createVNode)(c,{name:"vpcPeerings",label:e.t("harvester.vpc.vpcPeerings.label"),weight:-2,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{value:e.value.spec.vpcPeerings,"onUpdate:value":t[2]||(t[2]=t=>e.value.spec.vpcPeerings=t),class:"col span-12",mode:e.mode,vpc:e.value},null,8,["value","mode","vpc"])])),_:1},8,["label"])])),_:1},8,["mode"])])),_:1},8,["done-route","resource","mode","apply-hooks","errors","onFinish"]))}var l=a(43094),s=a(40527),n=a(42411),i=a(87619),d=a(91825),c=a(61629),u=a(25017),p=a(57477),m=a(76978),v={name:"EditVPC",emits:["update:value"],components:{CruResource:l.A,NameNsDescription:s.A,Tab:n.A,StaticRoutes:u["default"],ResourceTabs:c.A,Loading:i.A,VpcPeerings:p["default"]},mixins:[d.A],inheritAttrs:!1,data(){return(0,m.hZ)(this.value,"spec",this.value.spec||{staticRoutes:[],vpcPeerings:[]}),{staticRoutes:[]}},methods:{async saveVpc(e){const t=[];try{const a=this.value?.metadata?.name;if(a||t.push(this.t("validation.required",{key:this.t("generic.name")},!0)),t.length>0)return e(!1),this.errors=t,!1;await this.value.save(),e(!0),this.done()}catch(a){this.errors=[a],e(!1)}}}},h=a(47433);const b=(0,h.A)(v,[["render",r]]);var g=b},93987:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=a(9274);const r={class:"compat-matrix"},l={class:"device-col node-names"},s={class:"blank-corner"},n={class:"text-right"};function i(e,t,a,i,d,c){const u=(0,o.resolveDirective)("clean-tooltip");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,(0,o.toDisplayString)(e.t("harvester.devices.matrixDeviceClaimName")),1),(0,o.createElementVNode)("div",null,(0,o.toDisplayString)(e.t("harvester.devices.matrixHostName")),1)]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(c.allNodeNames,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t},[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e),1)])))),128))]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(a.enabledDevices,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t},[(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(["compat-cell device-label",{"text-muted":c.noneAvailable(e)}])},[(0,o.createTextVNode)((0,o.toDisplayString)(e.metadata.name),1)],2)),[[u,c.deviceTooltip(e)]]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(c.allNodeNames,((t,a)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:a,class:(0,o.normalizeClass)(["compat-cell",{"has-device":c.nodeHasDevice(t,e)}])},null,2)))),128))])))),128))])}var d=a(65359),c={props:{enabledDevices:{type:Array,required:!0},devicesByNode:{type:Object,required:!0},devicesInUse:{type:Object,default:()=>{}}},computed:{...(0,d.L8)({t:"i18n/t"}),allNodeNames(){return Object.keys(this.devicesByNode)},allDeviceIds(){return Object.keys(this.uniqueDevices)}},methods:{nodeNameFromId(e){return this.devicesByNode[e]?.name},nodeHasDevice(e,t){return t.status.nodeName===e},noneAvailable(e){const t=e.metadata?.name;return!!this.devicesInUse[t]},deviceTooltip(e){return`${e?.status?.resourceName}<br/>${e?.status?.description}`}}},u=(a(91950),a(47433));const p=(0,u.A)(c,[["render",i]]);var m=p},69057:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var o=a(9274);const r={key:0,class:"row"},l={class:"col span-12"},s={key:1},n={class:"row"},i={class:"col span-12"},d={class:"row"},c={class:"col span-6"},u={class:"text-label"},p={key:0,class:"row"},m={class:"col span-12 text-muted"},v={key:1,class:"text-error"},h={key:2,class:"row mt-20"},b={class:"col span-12"},g={class:"row mt-20"},f={class:"col span-12"};function k(e,t,a,k,y,N){const V=(0,o.resolveComponent)("Banner"),C=(0,o.resolveComponent)("t"),w=(0,o.resolveComponent)("LabeledSelect"),E=(0,o.resolveComponent)("CompatibilityMatrix"),S=(0,o.resolveComponent)("DeviceList"),B=(0,o.resolveDirective)("clean-html");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[y.oldFormatDevices.length>0?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(V,{color:"warning"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("p",null,null,512),[[B,e.t("harvester.pci.oldFormatDevices.help",{oldFormatDevicesHTML:N.oldFormatDevicesHTML},!0)]])])),_:1})])])):((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(V,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{k:"harvester.pci.howToUseDevice"})])),_:1}),y.selectedDevices.length>0?((0,o.openBlock)(),(0,o.createBlock)(V,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{k:"harvester.pci.deviceInTheSameHost"})])),_:1})):(0,o.createCommentVNode)("",!0)])]),N.enabledDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",d,[(0,o.createElementVNode)("div",c,[(0,o.createVNode)(w,{value:y.selectedDevices,"onUpdate:value":t[0]||(t[0]=e=>y.selectedDevices=e),label:"Available PCI Devices",searchable:"",multiple:"",taggable:"",options:N.deviceOpts,mode:a.mode},{option:(0,o.withCtx)((e=>[(0,o.createElementVNode)("span",null,[(0,o.createTextVNode)((0,o.toDisplayString)(e.value)+" ",1),(0,o.createElementVNode)("span",u,"("+(0,o.toDisplayString)(e.displayLabel)+")",1)])])),_:1},8,["value","options","mode"])])]),N.compatibleNodes.length&&y.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("div",m,[t[3]||(t[3]=(0,o.createTextVNode)(" Compatible hosts: ",-1)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(N.compatibleNodes,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:t},(0,o.toDisplayString)(e)+(0,o.toDisplayString)(t<N.compatibleNodes.length-1?", ":""),1)))),128))])])):y.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,(0,o.toDisplayString)(e.t("harvester.pci.impossibleSelection")),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm role-link pl-0",onClick:t[1]||(t[1]=e=>{y.showMatrix=!y.showMatrix,e.target.blur()})},(0,o.toDisplayString)(y.showMatrix?e.t("harvester.pci.hideCompatibility"):e.t("harvester.pci.showCompatibility")),1),y.showMatrix?((0,o.openBlock)(),(0,o.createElementBlock)("div",h,[(0,o.createElementVNode)("div",b,[(0,o.createVNode)(E,{"enabled-devices":N.enabledDevices,"devices-by-node":N.devicesByNode,"devices-in-use":N.devicesInUse},null,8,["enabled-devices","devices-by-node","devices-in-use"])])])):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",g,[(0,o.createElementVNode)("div",f,[(0,o.createVNode)(S,{schema:y.pciDeviceSchema,devices:y.pciDevices,onSubmit:t[2]||(t[2]=(0,o.withModifiers)((()=>{}),["prevent"]))},null,8,["schema","devices"])])])]))])}var y=a(14220),N=a(88339),V=a(89483),C=a(68745),w=a(65079),E=a.n(w),S=a(76978),B=a(32766),A=a(79428),x=a(93987),D={name:"VirtualMachinePCIDevices",components:{LabeledSelect:V.A,DeviceList:A["default"],CompatibilityMatrix:x["default"],Banner:C.A},props:{mode:{type:String,default:y.G5},value:{type:Object,default:()=>{}},vm:{type:Object,default:()=>{}}},async fetch(){const e={pciDevices:this.$store.dispatch("harvester/findAll",{type:B.rk.PCI_DEVICE}),claims:this.$store.dispatch("harvester/findAll",{type:B.rk.PCI_CLAIM}),vms:this.$store.dispatch("harvester/findAll",{type:B.rk.VM})},t=await(0,N.kR)(e);for(const s in t)this[s]=t[s];const a=[],o=[],r=this.value?.domain?.devices?.hostDevices||[],l=this.otherDevices(r).map((({name:e})=>e));r.forEach((({name:e,deviceName:t})=>{const r=(t||"").split("/")?.[1];r&&e.includes(r)&&!l.includes(e)?o.push(e):this.enabledDevices.find((t=>t?.metadata?.name===e))&&a.push(e)})),o.length>0?this.oldFormatDevices=o:this.selectedDevices=a},data(){return{pciDevices:[],claims:[],vms:[],selectedDevices:[],pciDeviceSchema:this.$store.getters["harvester/schemaFor"](B.rk.PCI_DEVICE),showMatrix:!1,oldFormatDevices:[]}},watch:{selectedDevices(e){const t=e.map((e=>{const t=this.enabledDevices.find((t=>t.metadata.name===e)),a=t?.status?.resourceName;return{deviceName:a,name:t?.metadata.name}})),a=[...this.otherDevices(this.value?.domain?.devices?.hostDevices||[]),...t];(0,S.hZ)(this.value.domain.devices,"hostDevices",a)}},computed:{enabledDevices(){return this.pciDevices.filter((e=>e.isEnabled&&e.claimedByMe))||[]},devicesInUse(){const e=this.vms.reduce(((e,t)=>{if(t.metadata.name===this.vm?.metadata?.name)return e;const a=t?.hostDevices||[];return a.forEach((a=>{e[a.name]={usedBy:[t.metadata.name]}})),e}),{});return e},devicesByNode(){return this.enabledDevices?.reduce(((e,t)=>{const a=t.status?.nodeName;return a&&(e[a]?e[a].push(t):e[a]=[]),e}),{})},compatibleNodes(){const e=[...Object.keys(this.devicesByNode)];return this.selectedDevices.forEach((t=>{E()(e,(e=>{const a=this.enabledDevices.find((e=>e.metadata.name===t));return a.status.nodeName!==e}))})),e},deviceOpts(){const e=this.enabledDevices.filter((e=>{if(this.selectedDevices.length>0){const t=this.enabledDevices.find((e=>e.metadata.name===this.selectedDevices[0]));return!this.devicesInUse[e?.metadata.name]&&e.status.nodeName===t.status.nodeName}return!this.devicesInUse[e?.metadata.name]}));return e.map((e=>({value:e?.metadata.name,label:e?.metadata.name,displayLabel:e?.status?.resourceName})))},oldFormatDevicesHTML(){return this.oldFormatDevices.map((e=>`<li>${e}</li>`)).join("")}},methods:{otherDevices(e){return e.filter((e=>!this.pciDevices.find((t=>e.name===t.name))))},nodeNameFromUid(e){for(const t in this.uniqueDevices){const a=this.uniqueDevices[t].nodes,o=a.find((t=>t.systemUUID===e));if(o)return o.name}}}},M=a(47433);const U=(0,M.A)(D,[["render",k]]);var T=U},14869:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("UnitInput");return(0,o.openBlock)(),(0,o.createBlock)(n,{value:l.memory,"onUpdate:value":[t[0]||(t[0]=e=>l.memory=e),s.change],label:e.t("harvester.virtualMachine.input.reservedMemory"),mode:a.mode,"input-exponent":2,increment:1024,"output-modifier":!0,suffix:l.MEBIBYTE},null,8,["value","label","mode","suffix","onUpdate:value"])}var l=a(73344),s=a(84757),n={name:"HarvesterReserved",emits:["updateReserved"],components:{UnitInput:l.A},props:{reservedMemory:{type:String,default:null},mode:{type:String,default:"create"}},data(){return{MEBIBYTE:s.gJ,memory:this.reservedMemory}},watch:{reservedMemory(e){this.memory=e}},methods:{change(){const{memory:e}=this;this.$emit("updateReserved",{memory:e})}}},i=a(47433);const d=(0,i.A)(n,[["render",r]]);var c=d},12258:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var o=a(9274);const r={class:"row"},l={class:"col span-12"},s={class:"row"},n={class:"col span-6"},i={class:"text-label"},d={key:0,class:"row"},c={class:"col span-12 text-muted"},u={key:1,class:"text-error"},p={key:2,class:"row mt-20"},m={class:"col span-12"},v={class:"row mt-20"},h={class:"col span-12"};function b(e,t,a,b,g,f){const k=(0,o.resolveComponent)("t"),y=(0,o.resolveComponent)("Banner"),N=(0,o.resolveComponent)("LabeledSelect"),V=(0,o.resolveComponent)("CompatibilityMatrix"),C=(0,o.resolveComponent)("DeviceList");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(y,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{k:"harvester.usb.howToUseDevice"})])),_:1}),g.selectedDevices.length>0?((0,o.openBlock)(),(0,o.createBlock)(y,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{k:"harvester.usb.deviceInTheSameHost"})])),_:1})):(0,o.createCommentVNode)("",!0)])]),f.enabledDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(N,{value:g.selectedDevices,"onUpdate:value":t[0]||(t[0]=e=>g.selectedDevices=e),label:e.t("harvester.usb.available"),searchable:"",multiple:"",taggable:"",options:f.deviceOpts,mode:a.mode},{option:(0,o.withCtx)((e=>[(0,o.createElementVNode)("span",null,[(0,o.createTextVNode)((0,o.toDisplayString)(e.value)+" ",1),(0,o.createElementVNode)("span",i,"("+(0,o.toDisplayString)(e.displayLabel)+")",1)])])),_:1},8,["value","label","options","mode"])])]),f.compatibleNodes.length&&g.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createElementVNode)("div",c,[t[3]||(t[3]=(0,o.createTextVNode)(" Compatible hosts: ",-1)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(f.compatibleNodes,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:e},(0,o.toDisplayString)(e)+(0,o.toDisplayString)(t<f.compatibleNodes.length-1?", ":""),1)))),128))])])):g.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",u,(0,o.toDisplayString)(e.t("harvester.usb.impossibleSelection")),1)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("button",{type:"button",class:"btn btn-sm role-link pl-0",onClick:t[1]||(t[1]=e=>{g.showMatrix=!g.showMatrix,e.target.blur()})},(0,o.toDisplayString)(g.showMatrix?e.t("harvester.usb.hideCompatibility"):e.t("harvester.usb.showCompatibility")),1),g.showMatrix?((0,o.openBlock)(),(0,o.createElementBlock)("div",p,[(0,o.createElementVNode)("div",m,[(0,o.createVNode)(V,{"enabled-devices":f.enabledDevices,"devices-by-node":f.devicesByNode,"devices-in-use":f.devicesInUse},null,8,["enabled-devices","devices-by-node","devices-in-use"])])])):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createVNode)(C,{schema:g.deviceSchema,devices:g.devices,onSubmit:t[2]||(t[2]=(0,o.withModifiers)((()=>{}),["prevent"]))},null,8,["schema","devices"])])])])}var g=a(14220),f=a(88339),k=a(32766),y=a(68774),N=a(89483),V=a(68745),C=a(93987),w=a(34529),E=a(65079),S=a.n(E),B=a(76978),A={name:"VirtualMachineUSBDevices",components:{Banner:V.A,CompatibilityMatrix:C["default"],DeviceList:w["default"],LabeledSelect:N.A},props:{mode:{type:String,default:g.G5},value:{type:Object,default:()=>{}},vm:{type:Object,default:()=>{}}},async fetch(){const e={devices:this.$store.dispatch("harvester/findAll",{type:k.rk.USB_DEVICE}),vms:this.$store.dispatch("harvester/findAll",{type:k.rk.VM})},t=await(0,f.kR)(e);for(const a in t)this[a]=t[a];this.selectedDevices=(this.value?.domain?.devices?.hostDevices||[]).map((({name:e})=>e)).filter((e=>this.enabledDevices.find((t=>t?.metadata?.name===e))))},data(){return{deviceSchema:this.$store.getters["harvester/schemaFor"](k.rk.USB_DEVICE),deviceHeaders:[{...y.c4},y.X0],devices:[],vms:[],selectedDevices:[],showMatrix:!1}},watch:{selectedDevices(e){const t=e.map((e=>{const t=this.enabledDevices.find((t=>t.metadata.name===e)),a=t?.status?.resourceName;return{deviceName:a,name:t?.metadata.name}})),a=[...this.otherDevices(this.value?.domain?.devices?.hostDevices||[]),...t];(0,B.hZ)(this.value.domain.devices,"hostDevices",a)}},computed:{deviceOpts(){const e=this.enabledDevices.filter((e=>{if(this.selectedDevices.length>0){const t=this.enabledDevices.find((e=>e.metadata.name===this.selectedDevices[0]));return!this.devicesInUse[e?.metadata.name]&&e.status.nodeName===t?.status.nodeName}return!this.devicesInUse[e?.metadata.name]}));return e.map((e=>({value:e?.metadata.name,label:e?.metadata.name,displayLabel:e?.status?.description})))},enabledDevices(){return this.devices.filter((e=>e.status.enabled))},devicesInUse(){const e=this.vms.reduce(((e,t)=>{if(t.metadata.name===this.vm?.metadata?.name)return e;const a=t?.hostDevices||[];return a.forEach((a=>{e[a.name]={usedBy:[t.metadata.name]}})),e}),{});return e},devicesByNode(){return this.enabledDevices?.reduce(((e,t)=>{const a=t.status?.nodeName;return a&&(e[a]?e[a].push(t):e[a]=[]),e}),{})},compatibleNodes(){const e=[...Object.keys(this.devicesByNode)];return this.selectedDevices.forEach((t=>{S()(e,(e=>{const a=this.enabledDevices.find((e=>e.metadata.name===t));return a?.status.nodeName!==e}))})),e}},methods:{otherDevices(e){return e.filter((e=>!this.devices.find((t=>e.name===t.name))))}}},x=a(47433);const D=(0,x.A)(A,[["render",b]]);var M=D},92200:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return B}});var o=a(9274);const r={class:"row"},l={class:"col span-12"},s={class:"row"},n={class:"col span-6"},i={key:0,class:"row"},d={class:"col span-12 text-muted"},c={key:1,class:"text-error"},u={class:"row mt-20"},p={class:"col span-12"};function m(e,t,a,m,v,h){const b=(0,o.resolveComponent)("t"),g=(0,o.resolveComponent)("Banner"),f=(0,o.resolveComponent)("LabeledSelect"),k=(0,o.resolveComponent)("VGpuDeviceList");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(g,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{k:"harvester.vgpu.howToUseDevice"})])),_:1}),v.selectedDevices.length>0?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{k:"harvester.vgpu.deviceInTheSameHost"})])),_:1})):(0,o.createCommentVNode)("",!0)])]),h.enabledDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(f,{value:v.selectedDevices,"onUpdate:value":t[0]||(t[0]=e=>v.selectedDevices=e),label:"Available vGPU Devices",searchable:"",multiple:"",taggable:"",options:h.deviceOpts,mode:a.mode},{option:(0,o.withCtx)((e=>[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(e.value),1)])),_:1},8,["value","options","mode"])])]),h.compatibleNodes.length&&v.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createElementVNode)("div",d,[t[2]||(t[2]=(0,o.createTextVNode)(" Compatible hosts: ",-1)),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(h.compatibleNodes,((e,t)=>((0,o.openBlock)(),(0,o.createElementBlock)("span",{key:t},(0,o.toDisplayString)(e)+(0,o.toDisplayString)(t<h.compatibleNodes.length-1?", ":""),1)))),128))])])):v.selectedDevices.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,(0,o.toDisplayString)(e.t("harvester.vgpu.impossibleSelection")),1)):(0,o.createCommentVNode)("",!0)],64)):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[(0,o.createVNode)(k,{schema:v.deviceSchema,devices:v.devices,onSubmit:t[1]||(t[1]=(0,o.withModifiers)((()=>{}),["prevent"]))},null,8,["schema","devices"])])])])}var v=a(14220),h=a(88339),b=a(89483),g=a(68745),f=a(65079),k=a.n(f),y=a(76978),N=a(32766),V=a(33212),C=a(68851),w={name:"VirtualMachineVGpuDevices",components:{Banner:g.A,LabeledSelect:b.A,VGpuDeviceList:V["default"]},props:{mode:{type:String,default:v.G5},value:{type:Object,default:()=>{}},vm:{type:Object,default:()=>{}}},async fetch(){const e={devices:this.$store.dispatch("harvester/findAll",{type:N.rk.VGPU_DEVICE}),vms:this.$store.dispatch("harvester/findAll",{type:N.rk.VM})},t=await(0,h.kR)(e);for(const o in t)this[o]=t[o];const a=this.vm.isOff?[...(this.value?.domain?.devices?.gpus||[]).map((({name:e})=>e))]:[...Object.values(this.vm?.provisionedVGpus).reduce(((e,t)=>[...e,...t]),[])];(0,C.sb)(a).forEach((e=>{this.enabledDevices.find((t=>t?.metadata?.name===e))&&this.selectedDevices.push(e)}))},data(){return{deviceSchema:this.$store.getters["harvester/schemaFor"](N.rk.VGPU_DEVICE),devices:[],vms:[],selectedDevices:[]}},watch:{selectedDevices(e){const t=e.map((e=>{const t=this.enabledDevices.find((t=>t.metadata.name===e)),a=`nvidia.com/${t?.status?.configureVGPUTypeName?.replace(/\s+/g,"_")}`;return{deviceName:a,name:t?.metadata.name}}));(0,y.hZ)(this.value.domain.devices,"gpus",t)}},computed:{enabledDevices(){return this.devices.filter((e=>e.isEnabled))||[]},devicesInUse(){const e=this.vms.reduce(((e,t)=>(t.metadata.name===this.vm?.metadata?.name||t.hostDevices.forEach((a=>{e[a.name]={usedBy:[t.metadata.name]}})),e)),{});return e},devicesByNode(){return this.enabledDevices?.reduce(((e,t)=>{const a=t.spec?.nodeName;return a&&(e[a]?e[a].push(t):e[a]=[]),e}),{})},compatibleNodes(){const e=[...Object.keys(this.devicesByNode)];return this.selectedDevices.forEach((t=>{k()(e,(e=>{const a=this.enabledDevices.find((e=>e.metadata.name===t));return a.spec.nodeName!==e}))})),e},deviceOpts(){const e=this.enabledDevices.filter((e=>{if(this.selectedDevices.length>0){const t=this.enabledDevices.find((e=>e.metadata.name===this.selectedDevices[0]));return!this.devicesInUse[e?.metadata.name]&&e.spec.nodeName===t.spec.nodeName}return!this.devicesInUse[e?.metadata.name]}));return e.map((e=>({value:e?.metadata.name,label:e?.metadata.name})))}}},E=a(47433);const S=(0,E.A)(w,[["render",m]]);var B=S},11739:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ie}});var o=a(9274);const r={key:2,class:"row mb-20"},l={class:"col span-6"},s={class:"col span-6"},n={class:"row mb-20"},i={class:"col span-6"},d={class:"col span-6"},c={class:"row mb-20"},u={class:"col span-6"},p={class:"col span-6"},m={class:"row mb-20"},v={key:0,class:"mb-20"},h={class:"row mb-20"},b={class:"col span-6"},g={key:0,class:"col span-6"},f={class:"row mb-20"},k={class:"col span-6"},y={key:1};function N(e,t,a,N,V,C){const w=(0,o.resolveComponent)("RadioGroup"),E=(0,o.resolveComponent)("LabeledInput"),S=(0,o.resolveComponent)("NameNsDescription"),B=(0,o.resolveComponent)("Checkbox"),A=(0,o.resolveComponent)("LabeledSelect"),x=(0,o.resolveComponent)("CpuMemory"),D=(0,o.resolveComponent)("SSHKey"),M=(0,o.resolveComponent)("Tab"),U=(0,o.resolveComponent)("Volume"),T=(0,o.resolveComponent)("Network"),I=(0,o.resolveComponent)("NodeScheduling"),O=(0,o.resolveComponent)("PodAffinity"),_=(0,o.resolveComponent)("PciDevices"),P=(0,o.resolveComponent)("VGpuDevices"),$=(0,o.resolveComponent)("UsbDevices"),R=(0,o.resolveComponent)("AccessCredentials"),L=(0,o.resolveComponent)("t"),q=(0,o.resolveComponent)("Banner"),F=(0,o.resolveComponent)("KeyValue"),H=(0,o.resolveComponent)("Reserved"),G=(0,o.resolveComponent)("UnitInput"),j=(0,o.resolveComponent)("CloudConfig"),J=(0,o.resolveComponent)("MessageLink"),K=(0,o.resolveComponent)("Tabbed"),z=(0,o.resolveComponent)("RestartVMDialog"),W=(0,o.resolveComponent)("CruResource"),Y=(0,o.resolveDirective)("t");return e.spec?((0,o.openBlock)(),(0,o.createBlock)(W,{key:0,id:"vm",ref:"vmCruResource","done-route":e.doneRoute,resource:a.value,"cancel-event":!0,mode:e.mode,"validation-passed":C.isValidationPassed,"can-yaml":!!V.isSingle,errors:e.errors,"generate-yaml":C.generateYaml,"apply-hooks":e.applyHooks,onFinish:C.saveVM,onCancel:C.cancelAction,onError:t[29]||(t[29]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[e.isCreate?((0,o.openBlock)(),(0,o.createBlock)(w,{key:0,value:V.isSingle,"onUpdate:value":t[0]||(t[0]=e=>V.isSingle=e),class:"mb-20 vm-radio-group",name:"createInstanceMode",options:[!0,!1],labels:[e.t("harvester.virtualMachine.instance.single.label"),e.t("harvester.virtualMachine.instance.multiple.label")]},null,8,["value","labels"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(S,{value:a.value,mode:e.mode,"has-extra":!V.isSingle,"name-label":C.nameLabel,namespaced:!0,"name-placeholder":V.isSingle?"nameNsDescription.name.placeholder":"harvester.virtualMachine.instance.multiple.nameNsDescription","extra-columns":V.isSingle?[]:["type"],"onUpdate:value":t[2]||(t[2]=t=>e.$emit("update:value",t))},{type:(0,o.withCtx)((()=>[V.isSingle?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createBlock)(E,{key:0,value:V.count,"onUpdate:value":[t[1]||(t[1]=e=>V.count=e),C.validateCount],valueModifiers:{number:!0},min:2,type:"number",label:e.t("harvester.virtualMachine.instance.multiple.count"),required:""},null,8,["value","label","onUpdate:value"]))])),_:1},8,["value","mode","has-extra","name-label","name-placeholder","extra-columns"]),e.isCreate?((0,o.openBlock)(),(0,o.createBlock)(B,{key:1,value:e.useTemplate,"onUpdate:value":t[3]||(t[3]=t=>e.useTemplate=t),class:"check mb-20",type:"checkbox","label-key":"harvester.virtualMachine.useTemplate.label"},null,8,["value"])):(0,o.createCommentVNode)("",!0),e.useTemplate?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(A,{value:V.templateId,"onUpdate:value":[t[4]||(t[4]=e=>V.templateId=e),C.updateTemplateId],"label-key":"harvester.virtualMachine.useTemplate.template.label",options:C.templateOptions},null,8,["value","options","onUpdate:value"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(A,{value:V.templateVersionId,"onUpdate:value":t[5]||(t[5]=e=>V.templateVersionId=e),"label-key":"harvester.virtualMachine.useTemplate.version.label",options:C.versionOptions},null,8,["value","options"])])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(K,{"side-tabs":!0,onChanged:C.onTabChanged},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(M,{name:"basics",label:e.t("harvester.virtualMachine.detail.tabs.basics")},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{class:"mb-20",cpu:e.cpu,"max-cpu":e.maxCpu,memory:e.memory,"max-memory":e.maxMemory,mode:e.mode,"enable-hot-plug":e.cpuMemoryHotplugEnabled,onUpdateCpuMemory:e.updateCpuMemory},null,8,["cpu","max-cpu","memory","max-memory","mode","enable-hot-plug","onUpdateCpuMemory"]),(0,o.createVNode)(D,{value:e.sshKey,"onUpdate:value":t[6]||(t[6]=t=>e.sshKey=t),class:"mb-20","create-namespace":!0,namespace:a.value.metadata.namespace,mode:e.mode,disabled:e.isWindows||e.isEdit,"onUpdate:sshKey":e.updateSSHKey,onRegisterAfterHook:e.registerAfterHook},null,8,["value","namespace","mode","disabled","onUpdate:sshKey","onRegisterAfterHook"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"Volume",label:e.t("harvester.tab.volume"),weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(U,{value:e.diskRows,"onUpdate:value":t[7]||(t[7]=t=>e.diskRows=t),mode:e.mode,"custom-volume-mode":e.customVolumeMode,namespace:a.value.metadata.namespace,"resource-type":a.value.type,vm:a.value,"validate-required":!0},null,8,["value","mode","custom-volume-mode","namespace","resource-type","vm"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"Network",label:e.t("harvester.tab.network"),weight:-2},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(T,{value:e.networkRows,"onUpdate:value":t[8]||(t[8]=t=>e.networkRows=t),mode:e.mode,"is-single":V.isSingle},null,8,["value","mode","is-single"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"nodeScheduling",label:e.t("workload.container.titles.nodeScheduling"),weight:-3},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(I,{mode:e.mode,value:e.spec.template.spec,nodes:e.nodesIdOptions},null,8,["mode","value","nodes"])])),_:1},8,["label"]),(0,o.createVNode)(M,{label:e.t("harvester.tab.vmScheduling"),name:"vmScheduling",weight:-4},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(O,{mode:e.mode,value:e.spec.template.spec,nodes:e.nodes,"all-namespaces-option-available":!0,namespaces:e.filteredNamespaces,"overwrite-labels":e.affinityLabels},null,8,["mode","value","nodes","namespaces","overwrite-labels"])])),_:1},8,["label"]),e.enabledPCI?((0,o.openBlock)(),(0,o.createBlock)(M,{key:0,label:e.t("harvester.tab.pciDevices"),name:"pciDevices",weight:-5},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{mode:e.mode,value:e.spec.template.spec,vm:a.value},null,8,["mode","value","vm"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),e.enabledSriovgpu?((0,o.openBlock)(),(0,o.createBlock)(M,{key:1,label:e.t("harvester.tab.vGpuDevices"),name:"vGpuDevices",weight:-6},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(P,{mode:e.mode,value:e.spec.template.spec,vm:a.value},null,8,["mode","value","vm"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),e.enabledPCI&&C.usbPassthroughEnabled?((0,o.openBlock)(),(0,o.createBlock)(M,{key:2,label:e.t("harvester.tab.usbDevices"),name:"usbDevices",weight:-7},{default:(0,o.withCtx)((()=>[(0,o.createVNode)($,{mode:e.mode,value:e.spec.template.spec,vm:a.value},null,8,["mode","value","vm"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),e.isEdit?((0,o.openBlock)(),(0,o.createBlock)(M,{key:3,label:e.t("harvester.tab.accessCredentials"),name:"accessCredentials",weight:-8},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(R,{value:e.accessCredentials,"onUpdate:value":t[9]||(t[9]=t=>e.accessCredentials=t),mode:e.mode,"resource-type":a.value,"is-qemu-installed":C.isQemuInstalled},null,8,["value","mode","resource-type","is-qemu-installed"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(M,{name:"labels",label:e.t("generic.labels"),weight:-9},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(L,{k:"harvester.virtualMachine.labels.banner"})])),_:1}),(0,o.createVNode)(F,{key:"labels",value:a.value.labels,"add-label":e.t("labels.addLabel"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[10]||(t[10]=e=>a.value.setLabels(e))},null,8,["value","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"instanceLabel",label:e.t("harvester.tab.instanceLabel"),weight:-10},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(L,{k:"harvester.virtualMachine.instanceLabels.banner"})])),_:1}),(0,o.createVNode)(F,{key:"instance-labels",value:a.value.instanceLabels,"protected-keys":a.value.systemLabels||[],"toggle-filter":e.toggler,"add-label":e.t("labels.addLabel"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[11]||(t[11]=e=>a.value.setInstanceLabels(e))},null,8,["value","protected-keys","toggle-filter","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"annotations",label:e.t("harvester.tab.annotations"),weight:-11},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(q,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(L,{k:"harvester.virtualMachine.annotations.banner"})])),_:1}),(0,o.createVNode)(F,{key:"annotations",value:a.value.annotations,"protected-keys":a.value.systemAnnotations||[],"toggle-filter":e.toggler,"add-label":e.t("labels.addAnnotation"),mode:e.mode,"read-allowed":!1,"value-can-be-empty":!0,"onUpdate:value":t[12]||(t[12]=e=>a.value.setAnnotations(e))},null,8,["value","protected-keys","toggle-filter","add-label","mode"])])),_:1},8,["label"]),(0,o.createVNode)(M,{name:"advanced",label:e.t("harvester.tab.advanced"),weight:-12},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(A,{value:e.runStrategy,"onUpdate:value":t[13]||(t[13]=t=>e.runStrategy=t),"label-key":"harvester.virtualMachine.runStrategy",options:e.runStrategies,mode:e.mode},null,8,["value","options","mode"])]),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(A,{value:e.osType,"onUpdate:value":t[14]||(t[14]=t=>e.osType=t),"label-key":"harvester.virtualMachine.osType",options:e.OS,disabled:!e.isCreate},null,8,["value","options","disabled"])])]),(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createVNode)(A,{value:e.maintenanceStrategy,"onUpdate:value":t[15]||(t[15]=t=>e.maintenanceStrategy=t),"label-key":"harvester.virtualMachine.maintenanceStrategy.label",options:e.maintenanceStrategies,"get-option-label":e.getMaintenanceStrategyOptionLabel,mode:e.mode},null,8,["value","options","get-option-label","mode"])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(H,{"reserved-memory":e.reservedMemory,mode:e.mode,onUpdateReserved:e.updateReserved},null,8,["reserved-memory","mode","onUpdateReserved"])])]),(0,o.createElementVNode)("div",m,[e.showAdvanced?(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:0,role:"button",onClick:t[16]||(t[16]=(...t)=>e.toggleAdvanced&&e.toggleAdvanced(...t))},null,512)),[[Y,"harvester.generic.showMore"]]):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("a",{key:1,role:"button",onClick:t[17]||(t[17]=(...t)=>e.toggleAdvanced&&e.toggleAdvanced(...t))},null,512)),[[Y,"harvester.generic.showMore"]])]),e.showAdvanced?((0,o.openBlock)(),(0,o.createElementBlock)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createElementVNode)("div",b,[(0,o.createVNode)(E,{value:V.hostname,"onUpdate:value":t[18]||(t[18]=e=>V.hostname=e),"label-key":C.hostnameLabel,placeholder:C.hostPlaceholder,mode:e.mode},null,8,["value","label-key","placeholder","mode"])]),a.value.vmMachineTypeAutoFeatureEnabled?(0,o.createCommentVNode)("",!0):((0,o.openBlock)(),(0,o.createElementBlock)("div",g,[(0,o.createVNode)(A,{value:e.machineType,"onUpdate:value":t[19]||(t[19]=t=>e.machineType=t),"label-key":"harvester.virtualMachine.input.MachineType",options:C.machineTypeOptions,mode:e.mode},null,8,["value","options","mode"])]))]),(0,o.createElementVNode)("div",f,[(0,o.createElementVNode)("div",k,[(0,o.createVNode)(G,{value:e.terminationGracePeriodSeconds,"onUpdate:value":[t[20]||(t[20]=t=>e.terminationGracePeriodSeconds=t),e.updateTerminationGracePeriodSeconds],suffix:1==e.terminationGracePeriodSeconds?"Second":"Seconds",label:e.t("harvester.virtualMachine.terminationGracePeriodSeconds.label"),mode:e.mode,positive:""},null,8,["value","suffix","label","mode","onUpdate:value"])])])])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(j,{ref:"yamlEditor","user-script":e.userScript,mode:e.mode,"os-type":e.osType,"view-code":e.isWindows,namespace:a.value.metadata.namespace,"network-script":e.networkScript,onUpdateUserData:e.updateUserData,onUpdateNetworkData:e.updateNetworkData,onUpdateDataTemplateId:e.updateDataTemplateId},null,8,["user-script","mode","os-type","view-code","namespace","network-script","onUpdateUserData","onUpdateNetworkData","onUpdateDataTemplateId"]),a.value.cpuPinningFeatureEnabled?((0,o.openBlock)(),(0,o.createBlock)(B,{key:1,value:e.cpuPinning,"onUpdate:value":t[21]||(t[21]=t=>e.cpuPinning=t),disabled:!C.enableCpuPinningCheckbox,class:"check",type:"checkbox","tooltip-key":"harvester.virtualMachine.cpuPinning.tooltip","label-key":"harvester.virtualMachine.cpuPinning.label",mode:e.mode},null,8,["value","disabled","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(B,{value:e.installUSBTablet,"onUpdate:value":t[22]||(t[22]=t=>e.installUSBTablet=t),class:"check mt-20",type:"checkbox","tooltip-key":"harvester.virtualMachine.usbTip","label-key":"harvester.virtualMachine.enableUsb",mode:e.mode},null,8,["value","mode"]),(0,o.createVNode)(B,{value:e.installAgent,"onUpdate:value":[t[23]||(t[23]=t=>e.installAgent=t),e.updateAgent],class:"check",type:"checkbox",disabled:e.isWindows,"label-key":"harvester.virtualMachine.installAgent",mode:e.mode},null,8,["value","disabled","mode","onUpdate:value"]),(0,o.createVNode)(B,{value:e.tpmEnabled,"onUpdate:value":t[24]||(t[24]=t=>e.tpmEnabled=t),class:"check",type:"checkbox","label-key":"harvester.virtualMachine.advancedOptions.tpm",mode:e.mode},null,8,["value","mode"]),a.value.tpmPersistentStateFeatureEnabled&&e.tpmEnabled?((0,o.openBlock)(),(0,o.createBlock)(B,{key:2,value:e.tpmPersistentStateEnabled,"onUpdate:value":t[25]||(t[25]=t=>e.tpmPersistentStateEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.tpmPersistentState"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(B,{value:e.efiEnabled,"onUpdate:value":t[26]||(t[26]=t=>e.efiEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.efiEnabled"),mode:e.mode},null,8,["value","label","mode"]),a.value.efiPersistentStateFeatureEnabled&&e.efiEnabled?((0,o.openBlock)(),(0,o.createBlock)(B,{key:3,value:e.efiPersistentStateEnabled,"onUpdate:value":t[27]||(t[27]=t=>e.efiPersistentStateEnabled=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.efiPersistentState"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),e.efiEnabled?((0,o.openBlock)(),(0,o.createBlock)(B,{key:4,value:e.secureBoot,"onUpdate:value":t[28]||(t[28]=t=>e.secureBoot=t),class:"check",type:"checkbox",label:e.t("harvester.virtualMachine.advancedOptions.secureBoot"),mode:e.mode},null,8,["value","label","mode"])):(0,o.createCommentVNode)("",!0),C.showCpuPinningBanner?((0,o.openBlock)(),(0,o.createBlock)(q,{key:5,color:"warning"},{default:(0,o.withCtx)((()=>["create"===e.mode?((0,o.openBlock)(),(0,o.createBlock)(J,{key:0,to:C.to,"prefix-label":"harvester.virtualMachine.advancedOptions.cpuManager.prefix","middle-label":"harvester.virtualMachine.advancedOptions.cpuManager.middle","suffix-label":"harvester.virtualMachine.advancedOptions.cpuManager.suffix"},null,8,["to"])):(0,o.createCommentVNode)("",!0),"edit"===e.mode?((0,o.openBlock)(),(0,o.createElementBlock)("span",y,(0,o.toDisplayString)(e.t("harvester.virtualMachine.cpuPinning.restartVMMessage")),1)):(0,o.createCommentVNode)("",!0)])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1},8,["label"])])),_:1},8,["onChanged"]),V.isOpen?((0,o.openBlock)(),(0,o.createBlock)(z,{key:3,ref:"restartDialog",vm:a.value},null,8,["vm"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["done-route","resource","mode","validation-passed","can-yaml","errors","generate-yaml","apply-hooks","onFinish","onCancel"])):(0,o.createCommentVNode)("",!0)}var V=a(45250),C=a(65359),w=a(63209),E=a(76978),S=a(42411),B=a(42200),A=a(43094),x=a(10196),D=a(79380),M=a(89483),U=a(40527),T=a(73344),I=a(37329),O=a(1018),_=a(92200),P=a(12258),$=a(38094),R=a(68851),L=a(37648),q=a(99726),F=a(2602),H=a(8135),G=a(91825),j=a(66490),J=a(48249),K=a(32766),z=a(48387),W=a(69057),Y=a(60068),Z=a(71574),Q=a(81111),X=a(73705),ee=a(55323),te=a(383),ae=a(14869),oe=a(9980),re=a(96413),le={name:"HarvesterEditVM",emits:["update:value"],components:{Tab:S.A,Tabbed:w.A,Checkbox:B.S,RadioGroup:x.z,CruResource:A.A,LabeledInput:D.o,LabeledSelect:M.A,NameNsDescription:U.A,Volume:ee["default"],SSHKey:te["default"],Network:X["default"],CpuMemory:Q["default"],CloudConfig:Z["default"],NodeScheduling:I.A,PodAffinity:O.A,AccessCredentials:Y["default"],Reserved:ae["default"],PciDevices:W["default"],RestartVMDialog:z["default"],UnitInput:T.A,VGpuDevices:_["default"],KeyValue:$.A,Banner:oe.l,MessageLink:re.A,UsbDevices:P["default"]},mixins:[G.A,J.Ay],inheritAttrs:!1,props:{value:{type:Object,required:!0}},data(){const e=(0,E.o8)(this.value),t="Running"===this.value.actualState,a=this.value.spec.template.spec.hostname||"";return{cloneVM:e,count:2,templateId:"",templateVersionId:"",namePrefix:"",isSingle:!0,isOpen:!1,hostname:a,isRestartImmediately:t}},computed:{...(0,C.L8)({t:"i18n/t"}),to(){return{name:"harvester-c-cluster-resource",params:{cluster:this.$store.getters["clusterId"],resource:K.rk.HOST}}},machineTypeOptions(){return this.machineTypes.map((e=>e?{label:e,value:e}:{label:"None",value:""}))},templateOptions(){return this.templates.map((e=>{const t=this.hasAvailableVersion(e.id);return{label:e.id,value:e.id,disabled:!t}}))},versionOptions(){const e=this.curTemplateResource?.defaultVersion;return this.versions.filter((e=>e.templateId===this.templateId)).map((t=>{const a=t.version,o=e===a?`${a} (${this.t("generic.default")})`:a,r=t.id;return{label:o,value:r,disabled:!t.isReady}}))},curTemplateResource(){return this.templates.find((e=>e.id===this.templateId))},nameLabel(){return this.isSingle?"harvester.virtualMachine.instance.single.nameLabel":"harvester.virtualMachine.instance.multiple.nameLabel"},hostnameLabel(){return this.isSingle?"harvester.virtualMachine.instance.single.host.label":"harvester.virtualMachine.instance.multiple.host.label"},hostPlaceholder(){return this.isSingle?this.t("harvester.virtualMachine.instance.single.host.placeholder"):this.t("harvester.virtualMachine.instance.multiple.host.placeholder")},secretNamePrefix(){return this.value?.metadata?.name},isQemuInstalled(){return this.value.isQemuInstalled},hasRestartAction(){return this.value.hasAction("restart")},hasStartAction(){return this.value.hasAction("start")},enableCpuPinningCheckbox(){return"create"!==this.mode||this.nodes.some((e=>e.isCPUManagerEnabled))},isValidationPassed(){const e=this.diskRows.some((e=>!0===e.hasDiskError));return!e},showCpuPinningBanner(){return!!this.value.cpuPinningFeatureEnabled&&("edit"===this.mode?this.cpuPinning!==!!this.cloneVM.spec.template.spec.domain.cpu.dedicatedCpuPlacement:"create"===this.mode&&this.nodes.every((e=>!e.isCPUManagerEnabled)))},usbPassthroughEnabled(){return this.$store.getters["harvester-common/getFeatureEnabled"]("usbPassthrough")}},watch:{templateId:{async handler(e,t){if(e&&e!==t&&!this.templateVersionId){const t=await this.$store.dispatch("harvester/findAll",{type:K.rk.VM_TEMPLATE});this.templateVersionId=t.find((t=>t.id===e))?.spec?.defaultVersionId}},immediate:!1},templateVersionId:{async handler(e){if(!e)return;const t=await this.$store.dispatch("harvester/findAll",{type:K.rk.VM_VERSION}),a=t.find((t=>t.id===e));if(!a?.spec?.vm)return;const o=(0,E.o8)(a.spec.vm);delete o.spec?.template?.spec?.accessCredentials,delete o.spec?.template?.metadata?.annotations?.[F.r.DYNAMIC_SSHKEYS_NAMES],delete o.spec?.template?.metadata?.annotations?.[F.r.DYNAMIC_SSHKEYS_USERS];const r=(0,j.v)(o),l=r.map((e=>(e?.spec?.dataSource&&delete e.spec.dataSource,e)));o.metadata.annotations[F.r.VOLUME_CLAIM_TEMPLATE]=JSON.stringify(l),this.value.spec.template.metadata.labels=o.spec.template.metadata.labels||{},this.value.metadata.labels={...a.metadata?.labels||{},...o.metadata?.labels||{}},this.value.metadata.annotations={...a.metadata?.annotations||{},...o.metadata?.annotations||{}},this.getInitConfig({value:o,existUserData:!0,fromTemplate:!0}),this["hasCreateVolumes"]=[]}},useTemplate(e){!1===e&&(this.templateId="",this.templateVersionId="",this.value.applyDefaults(),this.getInitConfig({value:this.value,init:this.isCreate}))}},created(){this.registerAfterHook((async()=>{await this.restartVM();const e=`${this.value.metadata.namespace}/${this.value.metadata.name}`,t=this.$store.getters["harvester/byId"](K.rk.VM,e);try{await this.saveSecret(t),await this.saveAccessCredentials(t)}catch(a){this.errors.push(...(0,q.rz)(a))}!this.errors.length&&this.isSingle&&this.done()})),this.registerBeforeHook&&this.registerBeforeHook(this.updateBeforeSave)},mounted(){this.imageId=this.$route.query?.image||this.imageId;const e=this.getDiskRows(this.value);this["diskRows"]=e;const t=this.$route.query.templateId,a=this.$route.query.versionId;t&&a&&(this.templateId=t,this.templateVersionId=a,this.useTemplate=!0)},methods:{cancelAction(){const{fromPage:e=K.rk.VM}=this.$route?.query,t={name:this.doneRoute,params:{resource:e}};this.$router.replace(t)},saveVM(e){(0,R.IU)(this.errors),this.validateCPUMemory(),this.errors.length?e(!1):this.isSingle?this.saveSingle(e):this.saveMultiple(e)},validateCPUMemory(){const{cpu:e,memory:t}=this;e||this.errors.push(this.t("validation.required",{key:this.t("harvester.virtualMachine.input.cpu")},!0)),t||this.errors.push(this.t("validation.required",{key:this.t("harvester.virtualMachine.input.memory")},!0))},async saveSingle(e){this.parseVM(),this.value.spec.template.spec.hostname=this.hostname?this.hostname:this.value.metadata.name,await this._save(this.value,e),this.errors.length?e(!1):e(!0)},async saveMultiple(e){this.namePrefix=this.value.metadata.name||"";const t=this.namePrefix.endsWith("-")?"":"-",a=this.hostname?this.hostname:this.namePrefix;if(this.count<1)return this.errors=[this.t("harvester.virtualMachine.instance.multiple.countTip")],void e(!1);if(!this.value.metadata.name)return this.errors.push(this.t("validation.required",{key:this.t("generic.name")},!0)),void e(!1);const o=(0,E.o8)(this.value),r=(0,E.o8)(this.spec);for(let l=1;l<=this.count;l++){this.value["spec"]=o.spec,this["spec"]=r;const s=l<10?`0${l}`:l;this.value.cleanForNew(),this.value.metadata.name=`${this.namePrefix}${t}${s}`,this.value.spec.template.spec["hostname"]=`${a}${t}${s}`,this.secretName="",await this.parseVM();const n=await this.$store.dispatch("harvester/clone",{resource:this.value});await this._save(n,e),l!==this.count||this.errors.length?l===this.count&&(this.value.metadata.name=this.namePrefix,e(!1)):(e(!0),this.done())}},async _save(e,t){try{await this.applyHooks(H.Fm),await e.save(),await this.applyHooks(H.Mz)}catch(a){this.errors.push(...(0,q.rz)(a)),t(!1)}},_compareDisksIgnoreStorage(e=[],t=[]){if(e.length!==t.length)return!1;const a=[...e].sort(((e,t)=>e.metadata.name.localeCompare(t.metadata.name))),o=[...t].sort(((e,t)=>e.metadata.name.localeCompare(t.metadata.name)));for(let r=0;r<a.length;r++){const e=(0,E.o8)(a[r]),t=(0,E.o8)(o[r]);if(delete e?.spec?.resources?.requests?.storage,delete t?.spec?.resources?.requests?.storage,!(0,V.isEqual)(e,t))return!1}return!0},_shouldPromptRestart(e,t){const a=!(0,V.isEqual)(e?.spec,t?.spec),o=(0,j.v)(e),r=(0,j.v)(t),l=!this._compareDisksIgnoreStorage(o,r);return a||l},restartVM(){if("edit"!==this.mode||!this.value.isRunning)return;const e=this._shouldPromptRestart(this.cloneVM,this.value);return e?new Promise((e=>{this.isOpen=!0,this.$nextTick((()=>{if(!this?.$refs?.restartDialog)return e();this.$refs.restartDialog.resolve=e}))})):void 0},updateBeforeSave(){this.isSingle&&(this.value.spec.template.spec.hostname||(this.value.spec.template.spec["hostname"]=this.value.metadata.name,this.spec.template.spec["hostname"]=this.value.metadata.name));const e=this.getAccessCredentialsValidation();return e.length>0?Promise.reject(e):Promise.resolve()},validateCount(e){e>10&&(this["count"]=10)},updateTemplateId(){this.templateVersionId=""},onTabChanged({tab:e}){"advanced"===e.name&&this.$refs.yamlEditor?.refresh()},hasAvailableVersion(e){let t=!1;return this.versions.filter((t=>t.templateId===e)).find((e=>{e.isReady&&(t=!0)})),t},generateYaml(){this.showYaml=this?.$refs?.vmCruResource?.showYaml||!1,this.parseVM();const e=(0,L.Kq)(this.value);return e}}},se=(a(32659),a(47433));const ne=(0,se.A)(le,[["render",N],["__scopeId","data-v-95dadbfa"]]);var ie=ne},68611:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(9274);const r={key:0},l={key:0,class:"pool-project"},s={class:"pool-namespace"},n={key:1,class:"pool-guestCluster"},i={key:2,class:"remove"},d={key:1,class:"footer"},c=["disabled"];function u(e,t,a,u,p,m){const v=(0,o.resolveComponent)("t"),h=(0,o.resolveComponent)("PriorityRow");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("h3",null,(0,o.toDisplayString)(e.t("harvester.ipPool.scope.label")),1),p.rows.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["pool-headers",{"show-project-and-cluster":m.showProjectAndCluster}])},[m.showProjectAndCluster?((0,o.openBlock)(),(0,o.createElementBlock)("span",l,[(0,o.createVNode)(v,{k:"harvester.ipPool.project.label"})])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("span",s,[(0,o.createVNode)(v,{k:"harvester.ipPool.namespace.label"})]),m.showProjectAndCluster?((0,o.openBlock)(),(0,o.createElementBlock)("span",n,[(0,o.createVNode)(v,{k:"harvester.ipPool.guestCluster.label"})])):(0,o.createCommentVNode)("",!0),m.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("span",i)):(0,o.createCommentVNode)("",!0)],2),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(p.rows,((t,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:r},[(0,o.createVNode)(h,{row:t,mode:a.mode,rows:p.rows,idx:r,"onUpdate:value":e.queueUpdate,onRemove:e=>m.remove(r)},null,8,["row","mode","rows","idx","onUpdate:value","onRemove"])])))),128))])):(0,o.createCommentVNode)("",!0),m.showAdd?((0,o.openBlock)(),(0,o.createElementBlock)("div",d,[(0,o.createElementVNode)("button",{type:"button",disabled:m.disableAdd,class:"btn role-tertiary add",onClick:t[0]||(t[0]=e=>m.add())},[(0,o.createVNode)(v,{k:"harvester.ipPool.scope.addLabel"})],8,c)])):(0,o.createCommentVNode)("",!0)])}var p=a(12784),m=a.n(p),v=a(14220),h=a(68851),b=a(76978),g=a(65359),f=a(86107),k={emits:["update:value"],components:{PriorityRow:f["default"]},props:{value:{type:Array,default:null},mode:{type:String,default:v.G5},autoAddIfEmpty:{type:Boolean,default:!0}},data(){const e=(0,b.o8)(this.value||[]);return{rows:e}},computed:{...(0,g.L8)(["isRancherInHarvester","isStandaloneHarvester"]),isView(){return this.mode===v.nW},disableAdd(){return this.isStandaloneHarvester&&this.rows.some((e=>"*"===e.namespace))},showAdd(){return!this.isView},showRemove(){return!this.isView},showProjectAndCluster(){return!this.isStandaloneHarvester}},created(){this.queueUpdate=m()(this.update,500)},methods:{add(){const e={namespace:"*"};this.showProjectAndCluster?this.rows.push({...e,project:"*",guestCluster:"*"}):this.rows.push(e),this.queueUpdate()},remove(e){(0,h.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},y=(a(69117),a(47433));const N=(0,y.A)(k,[["render",u],["__scopeId","data-v-4914b3a7"]]);var V=N},86107:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var o=a(9274);const r={key:0,class:"pool-project"},l={key:0},s={class:"pool-namespace"},n={key:0},i={key:1,class:"pool-guestCluster"},d={key:0},c={key:2,class:"remove"};function u(e,t,a,u,p,m){const v=(0,o.resolveComponent)("Select"),h=(0,o.resolveComponent)("t");return(0,o.openBlock)(),(0,o.createElementBlock)("div",{class:(0,o.normalizeClass)(["pool-row",{"show-project-and-cluster":m.showProjectAndCluster}])},[m.showProjectAndCluster?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[m.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",l,(0,o.toDisplayString)(a.row.project),1)):((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,value:a.row.project,"onUpdate:value":[t[0]||(t[0]=e=>a.row.project=e),m.update],options:m.projectOptions},null,8,["value","options","onUpdate:value"]))])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",s,[m.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",n,(0,o.toDisplayString)(a.row.namespace),1)):((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,value:a.row.namespace,"onUpdate:value":[t[1]||(t[1]=e=>a.row.namespace=e),m.update],options:m.namespaceOptions},null,8,["value","options","onUpdate:value"]))]),m.showProjectAndCluster?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[m.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",d,(0,o.toDisplayString)(a.row.guestCluster),1)):((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,value:a.row.guestCluster,"onUpdate:value":[t[2]||(t[2]=e=>a.row.guestCluster=e),m.update],options:m.guestClusterOptions},null,8,["value","options","onUpdate:value"]))])):(0,o.createCommentVNode)("",!0),m.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("div",c,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-link",onClick:t[3]||(t[3]=e=>m.remove(a.idx))},[(0,o.createVNode)(h,{k:"generic.remove"})])])):(0,o.createCommentVNode)("",!0)],2)}var p=a(14220),m=a(45866),v=a(35664),h=a(65359),b=a(32766),g={emits:["update:value","remove"],components:{Select:m.A},props:{row:{type:Object,default:()=>({})},mode:{type:String,default:p.G5},rows:{type:Array,default:()=>[]},idx:{type:Number,required:!0}},data(){return{value:""}},computed:{...(0,h.L8)(["allNamespaces","currentCluster","isRancherInHarvester","isStandaloneHarvester"]),showProjectAndCluster(){return!this.isStandaloneHarvester},isView(){return this.mode===p.nW},showRemove(){return!this.isView},filteredNamespaces(){const e=this.allNamespaces||[];return e.filter((e=>"*"===this.row.project||(!this.row.project||e.project?.id===this.row.project)))},namespaceOptions(){const e=this.filteredNamespaces,t=this.rows.map((e=>e?.namespace));return this.isStandaloneHarvester?[{label:this.t("generic.all"),value:"*"},...e.map((e=>({label:e.metadata.name,value:e.id,disabled:t.includes(e.id)&&e.id!==this.row.namespace})))]:[{label:this.t("generic.all"),value:"*"},...e.map((e=>({label:e.metadata.name,value:e.id})))]},guestClusterOptions(){const e=this.$store.getters["management/all"](v.qt.RANCHER_CLUSTER),t=this.$store.getters["management/all"](b.rk.HARVESTER_CONFIG),a=this.rows.map((e=>e?.guestCluster)),o=this.filteredNamespaces.map((e=>e.id)),r=e.filter((e=>{const r=e.spec?.rkeConfig?.machinePools||[],l=r[0]?.machineConfigRef?.name,s=t.find((e=>e.id===`fleet-default/${l}`));if(s){const t=s?.vmNamespace;return!("*"!==this.row.namespace||!o.includes(t))||t===this.row.namespace&&!a.includes(e.id)}return!1})).map((e=>({label:e.nameDisplay,value:e.metadata.name})));return[{label:this.t("generic.none"),value:""},{label:this.t("generic.all"),value:"*"},...r]},projectOptions(){const e=this.$store.getters["management/all"](v.Mc.PROJECT),t=e.filter((e=>e.metadata.namespace===this.currentCluster.id)).map((e=>({label:e.nameDisplay,value:e.id})));return[{label:this.t("generic.none"),value:""},{label:this.t("generic.all"),value:"*"},...t]}},methods:{update(){const{namespace:e,project:t,guestCluster:a}=this.row;this.$emit("update:value",{namespace:e,project:t,guestCluster:a})},remove(){this.$emit("remove")}},watch:{"row.project"(){"*"!==this.row.namespace&&(this.row.namespace=""),"*"===this.row.guestCluster&&""===this.row.guestCluster||(this.row.guestCluster="")},"row.namespace"(){"*"!==this.row.guestCluster&&(this.row.guestCluster="")}}},f=(a(75782),a(47433));const k=(0,f.A)(g,[["render",u],["__scopeId","data-v-4db6b05a"]]);var y=k},51100:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return T}});var o=a(9274);const r={key:0},l={class:"pool-subnet"},s={class:"pool-gateway"},n={key:0,class:"pool-startIP"},i={key:1,class:"pool-endIP"},d={key:2,class:"remove"},c={class:"pool-subnet"},u={key:0},p=["onUpdate:modelValue"],m={class:"pool-gateway"},v={key:0},h=["onUpdate:modelValue"],b={key:0,class:"pool-startIP"},g={key:0},f=["onUpdate:modelValue"],k={key:1,class:"pool-endIP"},y={key:0},N=["onUpdate:modelValue"],V={key:2,class:"remove"},C=["onClick"],w={key:1,class:"footer"};function E(e,t,a,E,S,B){const A=(0,o.resolveComponent)("t");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[S.rows.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(S.rows,((a,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:r},[(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["pool-headers",{[a.type]:!0}])},[(0,o.createElementVNode)("span",l,[(0,o.createVNode)(A,{k:"harvester.ipPool.subnet.label"}),t[6]||(t[6]=(0,o.createElementVNode)("span",{class:"text-error"}," * ",-1))]),(0,o.createElementVNode)("span",s,[(0,o.createVNode)(A,{k:"harvester.ipPool.gateway.label"})]),"range"===a.type?((0,o.openBlock)(),(0,o.createElementBlock)("span",n,[(0,o.createVNode)(A,{k:"harvester.ipPool.startIP.label"})])):(0,o.createCommentVNode)("",!0),"range"===a.type?((0,o.openBlock)(),(0,o.createElementBlock)("span",i,[(0,o.createVNode)(A,{k:"harvester.ipPool.endIP.label"})])):(0,o.createCommentVNode)("",!0),B.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("span",d)):(0,o.createCommentVNode)("",!0)],2),(0,o.createElementVNode)("div",{class:(0,o.normalizeClass)(["pool-row",{[a.type]:!0}])},[(0,o.createElementVNode)("div",c,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",u,(0,o.toDisplayString)(a.subnet),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.subnet=e,type:"text",onInput:t[0]||(t[0]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,p)),[[o.vModelText,a.subnet]])]),(0,o.createElementVNode)("div",m,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",v,(0,o.toDisplayString)(a.gateway),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.gateway=e,type:"text",onInput:t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,h)),[[o.vModelText,a.gateway]])]),"range"===a.type?((0,o.openBlock)(),(0,o.createElementBlock)("div",b,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",g,(0,o.toDisplayString)(a.rangeStart),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.rangeStart=e,type:"text",onInput:t[2]||(t[2]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,f)),[[o.vModelText,a.rangeStart]])])):(0,o.createCommentVNode)("",!0),"range"===a.type?((0,o.openBlock)(),(0,o.createElementBlock)("div",k,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",y,(0,o.toDisplayString)(a.rangeEnd),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.rangeEnd=e,type:"text",onInput:t[3]||(t[3]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,N)),[[o.vModelText,a.rangeEnd]])])):(0,o.createCommentVNode)("",!0),B.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("div",V,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-link",onClick:e=>B.remove(r)},[(0,o.createVNode)(A,{k:"generic.remove"})],8,C)])):(0,o.createCommentVNode)("",!0)],2)])))),128))])):(0,o.createCommentVNode)("",!0),B.showAdd?((0,o.openBlock)(),(0,o.createElementBlock)("div",w,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-tertiary add",onClick:t[4]||(t[4]=e=>B.addCIDR())},[(0,o.createVNode)(A,{k:"harvester.ipPool.cidr.addLabel"})]),(0,o.createElementVNode)("button",{type:"button",class:"btn role-tertiary add",onClick:t[5]||(t[5]=e=>B.addRange())},[(0,o.createVNode)(A,{k:"harvester.ipPool.range.addLabel"})])])):(0,o.createCommentVNode)("",!0)])}var S=a(12784),B=a.n(S),A=a(14220),x=a(68851),D={emits:["update:value"],props:{value:{type:Array,default:null},mode:{type:String,default:A.G5},specType:{type:String,default:"ClusterIP"},autoAddIfEmpty:{type:Boolean,default:!0}},data(){const e=(this.value||[]).map((e=>{let t="cidr";return(e.rangeStart||e.rangeEnd)&&(t="range"),{...e,type:t}}));return{rows:e}},computed:{isView(){return this.mode===A.nW},showAdd(){return!this.isView},showRemove(){return!this.isView}},created(){this.queueUpdate=B()(this.update,500)},methods:{addCIDR(){this.rows.push({subnet:"",gateway:"",type:"cidr"}),this.queueUpdate()},addRange(){this.rows.push({subnet:"",gateway:"",rangeStart:"",rangeEnd:"",type:"range"}),this.queueUpdate()},remove(e){(0,x.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},M=(a(25760),a(47433));const U=(0,M.A)(D,[["render",E],["__scopeId","data-v-6a840725"]]);var T=U},10788:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);const r={class:"row mb-20"},l={class:"col span-6"},s={class:"col span-6"};function n(e,t,a,n,i,d){const c=(0,o.resolveComponent)("LabeledSelect"),u=(0,o.resolveComponent)("LabeledInput"),p=(0,o.resolveComponent)("Priority");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(c,{value:i.selector.network,"onUpdate:value":[t[0]||(t[0]=e=>i.selector.network=e),e.queueUpdate],label:e.t("harvester.ipPool.network.label"),options:d.networkOptions,mode:a.mode},null,8,["value","label","options","mode","onUpdate:value"])]),(0,o.createElementVNode)("div",s,[(0,o.createVNode)(u,{value:i.selector.priority,"onUpdate:value":[t[1]||(t[1]=e=>i.selector.priority=e),d.update],valueModifiers:{number:!0},label:e.t("harvester.ipPool.priority.label"),mode:a.mode,type:"number",min:"0"},null,8,["value","label","mode","onUpdate:value"])])]),(0,o.createVNode)(p,{value:i.selector.scope,"onUpdate:value":[t[2]||(t[2]=e=>i.selector.scope=e),d.update],class:"col span-12",mode:a.mode},null,8,["value","mode","onUpdate:value"])])}var i=a(12784),d=a.n(i),c=a(89483),u=a(79380),p=a(35664),m=a(14220),v=a(68611),h={emits:["update:value"],components:{LabeledSelect:c.A,LabeledInput:u.o,Priority:v["default"]},props:{value:{type:Object,default:()=>({})},mode:{type:String,default:m.G5}},data(){const e=this.value||{network:"",priority:0,scope:[]};return{selector:e}},computed:{networkOptions(){const e=this.$store.getters["harvester/all"](p.XG)||[];return[{label:this.t("generic.none"),value:""},...e.map((e=>({label:e.id,value:e.id})))]}},created(){this.queueUpdate=d()(this.update,500)},methods:{update(){this.isView||this.$emit("update:value",this.selector)}}},b=a(47433);const g=(0,b.A)(h,[["render",n]]);var f=g},5113:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("NameNsDescription"),i=(0,o.resolveComponent)("Range"),d=(0,o.resolveComponent)("Tab"),c=(0,o.resolveComponent)("Selector"),u=(0,o.resolveComponent)("ResourceTabs"),p=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(p,{"done-route":e.doneRoute,resource:e.value,mode:e.mode,errors:l.errors,"apply-hooks":e.applyHooks,"yaml-modifiers":s.yamlModifiers,onFinish:e.save,onError:t[3]||(t[3]=e=>l.errors=e)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:e.value,namespaced:!1,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(u,{class:"mt-15","need-conditions":!1,"need-related":!1,"side-tabs":!0,mode:e.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{name:"range",label:e.t("harvester.ipPool.tabs.range"),weight:98,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{value:e.value.spec.ranges,"onUpdate:value":t[1]||(t[1]=t=>e.value.spec.ranges=t),class:"col span-12",mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"]),(0,o.createVNode)(d,{name:"selector",label:e.t("harvester.ipPool.tabs.selector"),weight:97,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(c,{value:e.value.spec.selector,"onUpdate:value":t[2]||(t[2]=t=>e.value.spec.selector=t),mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"])])),_:1},8,["mode"])])),_:1},8,["done-route","resource","mode","errors","apply-hooks","yaml-modifiers","onFinish"])}var l=a(40527),s=a(61629),n=a(42411),i=a(91825),d=a(35664),c=a(88339),u=a(43094),p=a(32766),m=a(51100),v=a(10788),h={name:"HarvesterIPPool",emits:["update:value"],components:{NameNsDescription:l.A,ResourceTabs:s.A,Tab:n.A,CruResource:u.A,Range:m["default"],Selector:v["default"]},mixins:[i.A],inheritAttrs:!1,async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={networks:this.$store.dispatch(`${e}/findAll`,{type:d.XG}),settings:this.$store.dispatch(`${e}/findAll`,{type:p.rk.SETTING})};this.$store.getters["management/schemaFor"](p.rk.HARVESTER_CONFIG)&&(t.harvesterConfigs=this.$store.dispatch("management/findAll",{type:p.rk.HARVESTER_CONFIG})),this.$store.getters["management/schemaFor"](d.qt.RANCHER_CLUSTER)&&(t.rancherClusters=this.$store.dispatch("management/findAll",{type:d.qt.RANCHER_CLUSTER})),await(0,c.kR)(t)},data(){return{errors:[]}},computed:{yamlModifiers(){const e=["metadata.managedFields","metadata.relationships","metadata.state","links","type","id"];return this.isCreate&&e.push("status"),{activelyRemove:e}}}},b=a(47433);const g=(0,b.A)(h,[["render",r]]);var f=g},50927:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return V}});var o=a(9274);const r={class:"row"},l={class:"col span-6"},s={key:0},n={class:"row mt-10"},i={key:0,class:"col span-6"},d={class:"col span-6"},c={class:"row mt-10"},u={class:"col span-6"},p={class:"col span-6"},m={class:"row mt-10"},v={class:"col span-6"};function h(e,t,a,h,b,g){const f=(0,o.resolveComponent)("RadioGroup"),k=(0,o.resolveComponent)("LabeledSelect"),y=(0,o.resolveComponent)("LabeledInput");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(f,{value:b.healthCheckEnabled,"onUpdate:value":[t[0]||(t[0]=e=>b.healthCheckEnabled=e),g.onToggle],mode:a.mode,name:"healthCheckEnabled",labels:[e.t("generic.disabled"),e.t("generic.enabled")],options:[!1,!0],disabled:a.disabled},null,8,["value","mode","labels","disabled","onUpdate:value"])])]),b.healthCheckEnabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createElementVNode)("div",n,[b.healthCheckEnabled?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createVNode)(k,{value:a.value.port,"onUpdate:value":t[1]||(t[1]=e=>a.value.port=e),mode:a.mode,options:g.portOptions,required:"",label:e.t("harvester.service.healthCheckPort.label"),disabled:a.disabled},null,8,["value","mode","options","label","disabled"])])):(0,o.createCommentVNode)("",!0),(0,o.createElementVNode)("div",d,[(0,o.createVNode)(y,{value:a.value.successThreshold,"onUpdate:value":t[2]||(t[2]=e=>a.value.successThreshold=e),valueModifiers:{number:!0},mode:a.mode,type:"number",label:e.t("harvester.service.healthCheckSuccessThreshold.label"),tooltip:e.t("harvester.service.healthCheckSuccessThreshold.description"),disabled:a.disabled},null,8,["value","mode","label","tooltip","disabled"])])]),(0,o.createElementVNode)("div",c,[(0,o.createElementVNode)("div",u,[(0,o.createVNode)(y,{value:a.value.failureThreshold,"onUpdate:value":t[3]||(t[3]=e=>a.value.failureThreshold=e),valueModifiers:{number:!0},mode:a.mode,type:"number",label:e.t("harvester.service.healthCheckFailureThreshold.label"),tooltip:e.t("harvester.service.healthCheckFailureThreshold.description"),disabled:a.disabled},null,8,["value","mode","label","tooltip","disabled"])]),(0,o.createElementVNode)("div",p,[(0,o.createVNode)(y,{value:a.value.periodSeconds,"onUpdate:value":t[4]||(t[4]=e=>a.value.periodSeconds=e),valueModifiers:{number:!0},mode:a.mode,type:"number",label:e.t("harvester.service.healthCheckPeriod.label"),disabled:a.disabled},null,8,["value","mode","label","disabled"])])]),(0,o.createElementVNode)("div",m,[(0,o.createElementVNode)("div",v,[(0,o.createVNode)(y,{value:a.value.timeoutSeconds,"onUpdate:value":t[5]||(t[5]=e=>a.value.timeoutSeconds=e),valueModifiers:{number:!0},mode:a.mode,type:"number",label:e.t("harvester.service.healthCheckTimeout.label"),disabled:a.disabled},null,8,["value","mode","label","disabled"])])])])):(0,o.createCommentVNode)("",!0)])}var b=a(79380),g=a(89483),f=a(95706),k={emits:["enabled"],components:{LabeledInput:b.o,LabeledSelect:g.A,RadioGroup:f.A},props:{value:{type:Object,required:!0},model:{type:Object,required:!0},mode:{type:String,default:"create"},disabled:{type:Boolean,default:!1}},data(){return{healthCheckEnabled:!!this.value.port}},computed:{portOptions(){const e=this.model?.spec?.listeners||[];return e.filter((e=>e.port&&"TCP"===e.protocol)).map((e=>e.backendPort))||[]}},methods:{onToggle(e){this.$emit("enabled",e)}}},y=a(47433);const N=(0,y.A)(k,[["render",h]]);var V=N},67347:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return O}});var o=a(9274);const r={key:0},l={class:"listener-headers"},s={class:"listener-name"},n={class:"listener-protocol"},i={class:"listener-port"},d={class:"listener-backendPort"},c={key:0,class:"remove"},u={class:"port-name"},p={key:0},m=["onUpdate:modelValue","placeholder"],v={class:"port-protocol"},h={key:0},b={class:"port"},g={key:0},f=["onUpdate:modelValue","placeholder"],k={class:"target-port"},y={key:0},N=["onUpdate:modelValue","placeholder"],V={key:0,class:"remove"},C=["onClick"],w={key:1,class:"footer"};function E(e,t,a,E,S,B){const A=(0,o.resolveComponent)("t"),x=(0,o.resolveComponent)("Select");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[S.rows.length?((0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createElementVNode)("span",s,[(0,o.createVNode)(A,{k:"harvester.loadBalancer.listeners.name.label"})]),(0,o.createElementVNode)("span",n,[(0,o.createVNode)(A,{k:"harvester.loadBalancer.listeners.protocol.label"})]),(0,o.createElementVNode)("span",i,[(0,o.createVNode)(A,{k:"harvester.loadBalancer.listeners.port.label"}),t[4]||(t[4]=(0,o.createElementVNode)("span",{class:"text-error"}," * ",-1))]),(0,o.createElementVNode)("span",d,[(0,o.createVNode)(A,{k:"harvester.loadBalancer.listeners.backendPort.label"}),t[5]||(t[5]=(0,o.createElementVNode)("span",{class:"text-error"}," * ",-1))]),B.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("span",c)):(0,o.createCommentVNode)("",!0)]),((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(S.rows,((a,r)=>((0,o.openBlock)(),(0,o.createElementBlock)("div",{key:r,class:"listener-row"},[(0,o.createElementVNode)("div",u,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",p,(0,o.toDisplayString)(a.name),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,ref_for:!0,ref:"port-name","onUpdate:modelValue":e=>a.name=e,type:"text",placeholder:e.t("servicePorts.rules.name.placeholder"),onInput:t[0]||(t[0]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,m)),[[o.vModelText,a.name,void 0,{number:!0}]])]),(0,o.createElementVNode)("div",v,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",h,(0,o.toDisplayString)(a.protocol),1)):((0,o.openBlock)(),(0,o.createBlock)(x,{key:1,value:a.protocol,"onUpdate:value":e=>a.protocol=e,options:B.protocolOptions,onInput:e.queueUpdate},null,8,["value","onUpdate:value","options","onInput"]))]),(0,o.createElementVNode)("div",b,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",g,(0,o.toDisplayString)(a.port),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,ref_for:!0,ref:"port","onUpdate:modelValue":e=>a.port=e,type:"number",min:"1",max:"65535",placeholder:e.t("servicePorts.rules.listening.placeholder"),onInput:t[1]||(t[1]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,f)),[[o.vModelText,a.port,void 0,{number:!0}]])]),(0,o.createElementVNode)("div",k,[B.isView?((0,o.openBlock)(),(0,o.createElementBlock)("span",y,(0,o.toDisplayString)(a.backendPort),1)):(0,o.withDirectives)(((0,o.openBlock)(),(0,o.createElementBlock)("input",{key:1,"onUpdate:modelValue":e=>a.backendPort=e,type:"number",min:"1",max:"65535",placeholder:e.t("harvester.loadBalancer.listeners.backendPort.placeholder"),onInput:t[2]||(t[2]=(...t)=>e.queueUpdate&&e.queueUpdate(...t))},null,40,N)),[[o.vModelText,a.backendPort,void 0,{number:!0}]])]),B.showRemove?((0,o.openBlock)(),(0,o.createElementBlock)("div",V,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-link",onClick:e=>B.remove(r)},[(0,o.createVNode)(A,{k:"generic.remove"})],8,C)])):(0,o.createCommentVNode)("",!0)])))),128))])):(0,o.createCommentVNode)("",!0),B.showAdd?((0,o.openBlock)(),(0,o.createElementBlock)("div",w,[(0,o.createElementVNode)("button",{type:"button",class:"btn role-tertiary add",onClick:t[3]||(t[3]=e=>B.add())},[(0,o.createVNode)(A,{k:"generic.add"})])])):(0,o.createCommentVNode)("",!0)])}var S=a(12784),B=a.n(S),A=a(14220),x=a(68851),D=a(76978),M=a(45866),U={emits:["update:value"],components:{Select:M.A},props:{value:{type:Array,default:null},mode:{type:String,default:A.G5},autoAddIfEmpty:{type:Boolean,default:!0}},data(){const e=(0,D.o8)(this.value||[]);return{rows:e}},computed:{isView(){return this.mode===A.nW},showAdd(){return!this.isView},showRemove(){return!this.isView},protocolOptions(){return["TCP","UDP"]}},created(){this.queueUpdate=B()(this.update,500)},mounted(){this.isView||this.autoAddIfEmpty&&this.mode!==A.G5&&this?.rows.length<1&&this.add(!1)},methods:{add(e=!0){this.rows.push({name:"",port:null,protocol:"TCP",backendPort:null}),this.queueUpdate(),this.rows.length>0&&e&&this.$nextTick((()=>{const e=this.$refs["port-name"];e[e.length-1].focus()}))},remove(e){(0,x.Wq)(this.rows,e),this.queueUpdate()},update(){this.isView||this.$emit("update:value",this.rows)}}},T=(a(50004),a(47433));const I=(0,T.A)(U,[["render",E],["__scopeId","data-v-602acdc3"]]);var O=I},21132:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return D}});var o=a(9274);const r={class:"row"},l={class:"col span-6"},s={key:0,class:"col span-6"},n={class:"row"},i={class:"col span-12"};function d(e,t,a,d,c,u){const p=(0,o.resolveComponent)("NameNsDescription"),m=(0,o.resolveComponent)("LabeledSelect"),v=(0,o.resolveComponent)("Tab"),h=(0,o.resolveComponent)("Banner"),b=(0,o.resolveComponent)("Listeners"),g=(0,o.resolveComponent)("KeyValue"),f=(0,o.resolveComponent)("HealthCheck"),k=(0,o.resolveComponent)("ResourceTabs"),y=(0,o.resolveComponent)("CruResource"),N=(0,o.resolveDirective)("clean-html");return(0,o.openBlock)(),(0,o.createBlock)(y,{"done-route":e.doneRoute,resource:a.value,mode:e.mode,errors:e.errors,"apply-hooks":e.applyHooks,"yaml-modifiers":u.yamlModifiers,onFinish:e.save,onError:t[6]||(t[6]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,{value:a.value,namespaced:!0,mode:e.mode,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(k,{class:"mt-15","need-conditions":!1,"need-related":!1,"side-tabs":!0,mode:e.mode},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{name:"basic",label:e.t("harvester.loadBalancer.tabs.basic"),weight:99,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(m,{value:a.value.spec.ipam,"onUpdate:value":t[1]||(t[1]=e=>a.value.spec.ipam=e),label:e.t("harvester.loadBalancer.ipam.label"),options:u.ipamOption,mode:e.mode},null,8,["value","label","options","mode"])]),"pool"===a.value.spec.ipam?((0,o.openBlock)(),(0,o.createElementBlock)("div",s,[(0,o.createVNode)(m,{value:a.value.spec.ipPool,"onUpdate:value":[t[2]||(t[2]=e=>a.value.spec.ipPool=e),u.update],label:e.t("harvester.loadBalancer.ipPool.label"),options:u.ipPoolOptions,mode:e.mode},null,8,["value","label","options","mode","onUpdate:value"])])):(0,o.createCommentVNode)("",!0)])])),_:1},8,["label"]),"vm"===a.value.spec.workloadType?((0,o.openBlock)(),(0,o.createBlock)(v,{key:0,name:"listeners",label:e.t("harvester.loadBalancer.tabs.listeners"),weight:98,class:"bordered-table"},{default:(0,o.withCtx)((()=>[u.healthCheckPortInUseWarning?((0,o.openBlock)(),(0,o.createBlock)(h,{key:0,color:"warning"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("span",null,null,512),[[N,u.healthCheckPortInUseWarning]])])),_:1})):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(b,{value:a.value.spec.listeners,"onUpdate:value":t[3]||(t[3]=e=>a.value.spec.listeners=e),class:"col span-12",mode:e.mode},null,8,["value","mode"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),"vm"===a.value.spec.workloadType?((0,o.openBlock)(),(0,o.createBlock)(v,{key:1,name:"backendServer",label:e.t("harvester.loadBalancer.tabs.backendServer"),weight:97,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",n,[(0,o.createElementVNode)("div",i,[(0,o.createVNode)(h,{color:c.matchingVMs.none?"warning":"success"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("span",null,null,512),[[N,e.t("harvester.loadBalancer.backendServerSelector.matchingVMs.matchesSome",c.matchingVMs)]])])),_:1},8,["color"])])]),(0,o.createVNode)(g,{value:u.backendServerSelector,"onUpdate:value":t[4]||(t[4]=e=>u.backendServerSelector=e),mode:e.mode,"read-allowed":!1,"initial-empty-row":!0},null,8,["value","mode"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),"vm"===a.value.spec.workloadType?((0,o.openBlock)(),(0,o.createBlock)(v,{key:2,name:"healthCheck",label:e.t("harvester.loadBalancer.tabs.healthCheck"),weight:96,class:"bordered-table"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{value:a.value.spec.healthCheck,"onUpdate:value":t[5]||(t[5]=e=>a.value.spec.healthCheck=e),mode:e.mode,model:a.value,onEnabled:u.healthCheckEnabled},null,8,["value","mode","model","onEnabled"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0)])),_:1},8,["mode"])])),_:1},8,["done-route","resource","mode","errors","apply-hooks","yaml-modifiers","onFinish"])}var c=a(45250),u=a(40527),p=a(61629),m=a(89483),v=a(42411),h=a(43094),b=a(38094),g=a(68745),f=a(91825),k=a(35664),y=a(88339),N=a(38823),V=a(32766),C=a(67347),w=a(50927);const E="loadbalancer.harvesterhci.io/namespace",S="loadbalancer.harvesterhci.io/project";var B={name:"HarvesterLoadBalancer",emits:["update:value"],components:{NameNsDescription:u.A,ResourceTabs:p.A,LabeledSelect:m.A,Tab:v.A,Listeners:C["default"],HealthCheck:w["default"],CruResource:h.A,KeyValue:b.A,Banner:g.A},mixins:[f.A],inheritAttrs:!1,props:{value:{type:Object,required:!0}},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={ipPools:this.$store.dispatch(`${e}/findAll`,{type:V.rk.IP_POOL}),namespaces:this.$store.dispatch(`${e}/findAll`,{type:k.CU}),vms:this.$store.dispatch(`${e}/findAll`,{type:V.rk.VM})};this.$store.getters["management/schemaFor"](k.Mc.PROJECT)&&(t.projects=this.$store.dispatch("management/findAll",{type:k.Mc.PROJECT})),await(0,y.kR)(t),this.updateMatchingVMs()},data(){const e=this.value.metadata.annotations||[];this.value.spec.healthCheck||(this.value.spec.healthCheck={});const t={matched:0,matches:[],none:!0,sample:null,total:0};return{ipPool:this.value.spec.ipPool,projectSelector:e[S]||"",namespaceSelector:e[E]||"",matchingVMs:t}},computed:{ipamOption(){return[{label:this.t("harvester.loadBalancer.ipam.options.dhcp"),value:"dhcp"},{label:this.t("harvester.loadBalancer.ipam.options.pool"),value:"pool"}]},ipPoolOptions(){const e=this.$store.getters["harvester/all"](V.rk.IP_POOL),t=e.map((e=>e.id));return[{label:this.t("harvester.loadBalancer.ipPool.options.none"),value:""},...t]},projectOptions(){const e=this.$store.getters["harvester/all"](k.Mc.PROJECT);return e.map((e=>e.id))},namespaceOptions(){const e=this.$store.getters["harvester/all"](k.CU);return e.map((e=>e.id))},backendServerSelector:{get(){const e={};return Object.keys(this.value.spec?.backendServerSelector||{}).map((t=>{e[t]=(this.value.spec.backendServerSelector[t]||[]).join(",")||""})),e},set(e){const t={};Object.keys(e).map((a=>{t[a]=(e[a]||"").split(",")})),this.value.spec["backendServerSelector"]=t}},yamlModifiers(){const e=["metadata.managedFields","metadata.relationships","metadata.state","links","type","id"];return this.isCreate&&e.push("status"),{activelyRemove:e}},healthCheckPortInUseWarning(){const e=this.value?.spec?.healthCheck?.port,t=this.value?.spec?.listeners?.find((t=>t.backendPort===e));return e&&t?this.t("harvester.loadBalancer.healthCheck.warning.portInUse",{port:t.backendPort},!0):""}},methods:{update(){const{projectSelector:e,namespaceSelector:t}=this;e&&(this.value.metadata.annotations[S]=e),t&&(this.value.metadata.annotations[E]=t)},updateMatchingVMs:(0,c.throttle)((function(){const e=this.value.spec.backendServerSelector,t=this.$store.getters["harvester/all"](V.rk.VM).filter((e=>e.metadata.namespace===this.value.metadata.namespace));if((0,c.isEmpty)(e))this.matchingVMs={matched:0,total:t.length,none:!0,sample:null};else{const a=(0,N.wC)(t,e,"spec.template.metadata.labels");this.matchingVMs={matched:a.length,total:t.length,none:0===a.length,sample:a[0]?a[0].nameDisplay:null}}}),250,{leading:!0}),healthCheckEnabled(e){e||(this.value.spec.healthCheck={})}},watch:{backendServerSelector:"updateMatchingVMs","value.metadata.namespace":"updateMatchingVMs"}},A=(a(57353),a(47433));const x=(0,A.A)(B,[["render",d],["__scopeId","data-v-ef4b96d4"]]);var D=x},8212:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return A}});var o=a(9274);const r={class:"row mb-20"},l={class:"col span-3"};function s(e,t,a,s,n,i){const d=(0,o.resolveComponent)("NameNsDescription"),c=(0,o.resolveComponent)("LabeledSelect"),u=(0,o.resolveComponent)("Banner"),p=(0,o.resolveComponent)("ProjectMembershipEditor"),m=(0,o.resolveComponent)("Tab"),v=(0,o.resolveComponent)("ResourceQuota"),h=(0,o.resolveComponent)("ContainerResourceLimit"),b=(0,o.resolveComponent)("Labels"),g=(0,o.resolveComponent)("Tabbed"),f=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(f,{class:"project","done-route":e.value.listLocation,errors:e.fvUnreportedValidationErrors,mode:e.mode,resource:e.value,subtypes:[],"can-yaml":!1,"validation-passed":e.fvFormIsValid,onError:t[4]||(t[4]=t=>e.errors=t),onFinish:i.save,onCancel:e.done},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{value:e.value,"name-editable":!0,mode:e.mode,namespaced:!1,"description-key":"spec.description","description-disabled":i.isDescriptionDisabled,"name-key":"spec.displayName","normalize-name":!1,rules:{name:e.fvGetAndReportPathRules("spec.displayName"),namespace:[],description:[]},"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode","description-disabled","rules"]),(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[i.pspOptions?((0,o.openBlock)(),(0,o.createBlock)(c,{key:0,value:e.value.spec.podSecurityPolicyTemplateId,"onUpdate:value":t[1]||(t[1]=t=>e.value.spec.podSecurityPolicyTemplateId=t),class:"psp",mode:e.mode,options:i.pspOptions,disabled:!n.canEditPSPBindings,label:e.t("project.psp.label")},null,8,["value","mode","options","disabled","label"])):(0,o.createCommentVNode)("",!0)])]),(0,o.createVNode)(g,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[i.canViewMembers?((0,o.openBlock)(),(0,o.createBlock)(m,{key:0,name:"members",label:e.t("project.members.label"),weight:10},{default:(0,o.withCtx)((()=>[i.showBannerForOnlyManagingMembers?((0,o.openBlock)(),(0,o.createBlock)(u,{key:0,color:"info",label:e.t("project.membersEditOnly")},null,8,["label"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(p,{mode:e.mode,"parent-id":e.value.id,onHasOwnerChanged:i.onHasOwnerChanged,onMembershipUpdate:i.onMembershipUpdate},null,8,["mode","parent-id","onHasOwnerChanged","onMembershipUpdate"])])),_:1},8,["label"])):(0,o.createCommentVNode)("",!0),(0,o.createVNode)(m,{name:"resource-quotas",label:e.t("project.resourceQuotas"),weight:9},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{value:e.value,"onUpdate:value":t[2]||(t[2]=t=>e.value=t),mode:i.canEditTabElements,types:e.isStandaloneHarvester?n.HARVESTER_TYPES:n.RANCHER_TYPES,onRemove:i.removeQuota},null,8,["value","mode","types","onRemove"])])),_:1},8,["label"]),(0,o.createVNode)(m,{name:"container-default-resource-limit",label:i.resourceQuotaLabel,weight:8},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,{value:e.value.spec.containerDefaultResourceLimit,"onUpdate:value":t[3]||(t[3]=t=>e.value.spec.containerDefaultResourceLimit=t),mode:i.canEditTabElements,"show-tip":!1,"register-before-hook":e.registerBeforeHook},null,8,["value","mode","register-before-hook"])])),_:1},8,["label"]),(0,o.createVNode)(m,{name:"labels-and-annotations","label-key":"generic.labelsAndAnnotations",weight:7},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{"default-container-class":"labels-and-annotations-container",value:e.value,mode:i.canEditTabElements,"display-side-by-side":!1},null,8,["value","mode"])])),_:1})])),_:1})])),_:1},8,["done-route","errors","mode","resource","validation-passed","onFinish","onCancel"])}var n=a(65359),i=a(85992),d=a(91825),c=a(77651),u=a(43094),p=a(51449),m=a(89483),v=a(90373),h=a(3712),b=a(42411),g=a(63209),f=a(40527),k=a(35664),y=a(27278),N=a(14220),V=a(83954),C=a(11518),w=a(9980),E={emits:["update:value"],components:{ContainerResourceLimit:i.A,CruResource:u.A,Labels:p.A,LabeledSelect:m.A,NameNsDescription:f.A,ProjectMembershipEditor:V.h,ResourceQuota:v.A,Tabbed:g.A,Tab:b.A,Banner:w.l},mixins:[d.A,c.A],inheritAttrs:!1,async fetch(){this.$store.getters["management/canList"](k.Mc.POD_SECURITY_POLICY_TEMPLATE)&&(this.allPSPs=await this.$store.dispatch("management/findAll",{type:k.Mc.POD_SECURITY_POLICY_TEMPLATE}));const e=this.$store.getters["management/schemaFor"](k.Mc.PSP_TEMPLATE_BINDING);this.canEditPSPBindings=!!e},data(){return this.value["spec"]=this.value.spec||{},this.value.spec["podSecurityPolicyTemplateId"]=this.value.status?.podSecurityPolicyTemplateId||"",{allPSPs:[],projectRoleTemplateBindingSchema:this.$store.getters["management/schemaFor"](k.Mc.PROJECT_ROLE_TEMPLATE_BINDING),createLocation:{name:"c-cluster-product-resource-create",params:{product:y.o,resource:k.Mc.PROJECT_ROLE_TEMPLATE_BINDING},query:{[N.iJ]:this.project?.id?.replace("/",":")}},resource:k.Mc.PROJECT_ROLE_TEMPLATE_BINDING,saveBindings:null,membershipHasOwner:!1,membershipUpdate:{},HARVESTER_TYPES:h.vq,RANCHER_TYPES:h.Sg,fvFormRuleSets:[{path:"spec.displayName",rules:["required"]}],canEditPSPBindings:!0}},computed:{...(0,n.L8)(["currentCluster","isStandaloneHarvester"]),canViewMembers(){return(0,V.A)(this.$store)},canEditProject(){return this.value?.links?.update},isDescriptionDisabled(){return this.mode===N.G5&&!this.canEditProject||!1},canEditTabElements(){return this.mode!==N.G5||this.canEditProject?this.mode:N.nW},showBannerForOnlyManagingMembers(){return this.mode===N.G5&&!this.canEditProject},isK3s(){return(this.currentCluster?.spec?.kubernetesVersion||"").includes("k3s")},pspOptions(){if(this.isK3s||!this.currentCluster.spec.defaultPodSecurityPolicyTemplateName)return null;const e=[{label:this.t("project.psp.default"),value:""}];if(this.allPSPs)for(const a of this.allPSPs)e.push({label:a.nameDisplay,value:a.id});const t=this.value.status?.podSecurityPolicyTemplateId;return t&&!e.find((e=>e.value===t))&&e.unshift({label:this.t("project.psp.current",{value:t}),value:t}),e},isHarvester(){return this.$store.getters["currentProduct"].inStore===C.T3},resourceQuotaLabel(){return this.isHarvester?this.t("project.vmDefaultResourceLimit"):this.t("project.containerDefaultResourceLimit")}},watch:{hasOwner(){this.errors=this.hasOwner?[]:[this.t("project.haveOneOwner")]}},created(){this.value.metadata["namespace"]=this.$store.getters["currentCluster"].id,this.value["spec"]=this.value.spec||{},this.value.spec["containerDefaultResourceLimit"]=this.value.spec.containerDefaultResourceLimit||{}},methods:{async save(e){try{if(this.mode===N.YQ){const e=await this.value.save();this.membershipUpdate.save&&await this.membershipUpdate.save(e.id)}else if(this.mode===N.G5&&(this.canEditProject&&(await this.value.save(!0),await this.$store.dispatch("management/find",{type:k.Mc.PROJECT,id:this.value.id,opt:{force:!0}})),this.membershipUpdate.save)){const e=await this.value.norman;await this.membershipUpdate.save(e.id)}e(!0),this.$router.replace(this.value.listLocation)}catch(t){this.errors.push(t),e(!1)}},onHasOwnerChanged(e){this["membershipHasOwner"]=e},onMembershipUpdate(e){this["membershipUpdate"]=e},removeQuota(e){["resourceQuota","namespaceDefaultResourceQuota"].forEach((t=>{this.value?.spec[t]?.limit&&this.value?.spec[t]?.limit[e]&&delete this.value?.spec[t]?.limit[e],this.value?.spec[t]?.usedLimit&&this.value?.spec[t]?.usedLimit[e]&&delete this.value?.spec[t]?.usedLimit[e]}))}}},S=a(47433);const B=(0,S.A)(E,[["render",s]]);var A=B},40041:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return v}});var o=a(9274);function r(e,t,a,r,l,s){const n=(0,o.resolveComponent)("NameNsDescription"),i=(0,o.resolveComponent)("Labels"),d=(0,o.resolveComponent)("Tab"),c=(0,o.resolveComponent)("ResourceTabs"),u=(0,o.resolveComponent)("CruResource");return(0,o.openBlock)(),(0,o.createBlock)(u,{resource:e.value,mode:e.mode,errors:e.errors,onFinish:e.save,onError:t[2]||(t[2]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{value:e.value,mode:e.mode,namespaced:!1,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(c,{value:e.value,"onUpdate:value":t[1]||(t[1]=t=>e.value=t),mode:e.mode,"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(d,{name:"labels-and-annotations","label-key":"generic.labelsAndAnnotations",weight:-1},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{"default-container-class":"labels-and-annotations-container",value:e.value,mode:e.mode,"display-side-by-side":!1},null,8,["value","mode"])])),_:1})])),_:1},8,["value","mode"])])),_:1},8,["resource","mode","errors","onFinish"])}var l=a(43094),s=a(40527),n=a(61629),i=a(42411),d=a(51449),c=a(91825),u={name:"EditClusterNetwork",emits:["update:value"],components:{CruResource:l.A,NameNsDescription:s.A,ResourceTabs:n.A,Tab:i.A,Labels:d.A},mixins:[c.A],inheritAttrs:!1,computed:{doneLocationOverride(){return this.value.doneOverride}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.validate)},methods:{validate(){const e=[],t=this.value?.metadata?.name;return t?t.length>12&&e.push(this.t("validation.stringLength.max",{key:this.t("generic.name"),count:12},!0)):e.push(this.t("validation.required",{key:this.t("generic.name")},!0)),e.length>0?Promise.reject(e):Promise.resolve()}}},p=a(47433);const m=(0,p.A)(u,[["render",r]]);var v=m},95058:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var o=a(9274);const r={class:"row"},l={key:0,class:"row mb-10"},s={class:"col span-6"};function n(e,t,a,n,i,d){const c=(0,o.resolveComponent)("RadioGroup"),u=(0,o.resolveComponent)("LabeledSelect"),p=(0,o.resolveComponent)("KeyValue");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createElementVNode)("div",r,[(0,o.createVNode)(c,{value:i.selectNode,"onUpdate:value":[t[0]||(t[0]=e=>i.selectNode=e),d.update],name:"selectNode",options:d.selectNodeOptions,mode:a.mode},null,8,["value","options","mode","onUpdate:value"])]),"nodeSelector"===i.selectNode?((0,o.openBlock)(),(0,o.createElementBlock)("div",l,[(0,o.createElementVNode)("div",s,[(0,o.createVNode)(u,{value:i.nodeName,"onUpdate:value":[t[1]||(t[1]=e=>i.nodeName=e),d.update],label:e.t("workload.scheduling.affinity.nodeName"),options:a.nodes||[],mode:a.mode,multiple:!1},null,8,["value","label","options","mode","onUpdate:value"])])])):"custom"===i.selectNode?((0,o.openBlock)(),(0,o.createBlock)(p,{key:1,value:i.nodeSelector,"onUpdate:value":[t[2]||(t[2]=e=>i.nodeSelector=e),d.update],"key-label":e.t("generic.key"),mode:a.mode,"add-label":e.t("workload.scheduling.affinity.addNodeSelector"),"read-allowed":!1,"value-label":e.t("generic.value"),"initial-empty-row":!0},null,8,["value","key-label","mode","add-label","value-label","onUpdate:value"])):(0,o.createCommentVNode)("",!0)])}var i=a(65359),d=a(10196),c=a(89483),u=a(38094),p=a(2841),m=a(68851),v=a(32766),h={emits:["updateMatchingNICs","updateMatchingNodes"],components:{RadioGroup:d.z,LabeledSelect:c.A,KeyValue:u.A},props:{value:{type:Object,default:()=>({})},nodes:{type:Array,default:()=>[]},mode:{type:String,default:"create"}},data(){const{nodeSelector:e={}}=this.value;let t="all",a="";return e[p.yA]&&1===Object.keys(e).length?(t="nodeSelector",a=e[p.yA]):Object.keys(e).length>0&&(t="custom"),{selectNode:t,nodeName:a,nodeSelector:e}},computed:{...(0,i.L8)({t:"i18n/t"}),selectNodeOptions(){const e=[{label:this.t("harvester.vlanConfig.scheduling.affinity.allNodes"),value:"all"},{label:this.t("harvester.vlanConfig.scheduling.affinity.specificNode"),value:"nodeSelector"},{label:this.t("harvester.vlanConfig.scheduling.affinity.schedulingRules"),value:"custom"}];return e},nics(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/byId`](v.rk.LINK_MONITOR,"nic")||{},a=t?.status?.linkStatus||{},o=[];return Object.keys(a).map((e=>{const t=a[e]||[];t.map((t=>{(0,m.jq)(o,"name",t.name)||t.masterIndex||o.push({...t,nodeName:e})}))})),o}},methods:{update(){const{nodeName:e,nodeSelector:t}=this;switch(this.selectNode){case"all":delete this.value?.nodeSelector;break;case"nodeSelector":delete this.value?.nodeSelector,Object.assign(this.value,{nodeSelector:{[p.yA]:e}});break;case"custom":delete this.value.nodeName,delete this.value.nodeSelector,Object.assign(this.value,{nodeSelector:t});break;default:delete this.value.nodeSelector}this.$emit("updateMatchingNICs"),this.$emit("updateMatchingNodes")}}},b=a(47433);const g=(0,b.A)(h,[["render",n]]);var f=g},55191:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return G}});var o=a(9274);const r={class:"row"},l={class:"col span-12"},s={class:"row"},n={class:"col span-12"},i={class:"row mt-10"},d={class:"col span-6"},c={class:"col span-6"},u={class:"row mt-20"},p={class:"col span-12"},m={class:"mt-20"},v={class:"row"},h={class:"col span-6"},b={class:"col span-6"},g={class:"mt-20"},f={class:"row mt-10"},k={class:"col span-6"};function y(e,t,a,y,N,V){const C=(0,o.resolveComponent)("Loading"),w=(0,o.resolveComponent)("NameNsDescription"),E=(0,o.resolveComponent)("Banner"),S=(0,o.resolveComponent)("NodeSelector"),B=(0,o.resolveComponent)("Tab"),A=(0,o.resolveComponent)("LabelValue"),x=(0,o.resolveComponent)("ArrayListSelect"),D=(0,o.resolveComponent)("LabeledSelect"),M=(0,o.resolveComponent)("LabeledInput"),U=(0,o.resolveComponent)("Tabbed"),T=(0,o.resolveComponent)("CruResource"),I=(0,o.resolveDirective)("clean-html");return e.$fetchState.pending?((0,o.openBlock)(),(0,o.createBlock)(C,{key:0})):((0,o.openBlock)(),(0,o.createBlock)(T,{key:1,resource:e.value,mode:e.mode,errors:e.errors,onFinish:e.save,onError:t[5]||(t[5]=t=>e.errors=t)},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(w,{value:e.value,mode:e.mode,namespaced:!1,"onUpdate:value":t[0]||(t[0]=t=>e.$emit("update:value",t))},null,8,["value","mode"]),(0,o.createVNode)(U,{"side-tabs":!0},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(B,{name:"nodeSelector",label:e.t("harvester.vlanConfig.titles.nodeSelector"),weight:99},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",r,[(0,o.createElementVNode)("div",l,[(0,o.createVNode)(E,{color:N.matchingNodes.none?"warning":"success"},{default:(0,o.withCtx)((()=>[(0,o.withDirectives)((0,o.createElementVNode)("span",null,null,512),[[I,e.t("harvester.vlanConfig.nodeSelector.matchingNodes.matchesSome",N.matchingNodes)]])])),_:1},8,["color"])])]),(0,o.createElementVNode)("div",s,[(0,o.createElementVNode)("div",n,[(0,o.createVNode)(S,{mode:e.mode,value:e.value.spec,nodes:V.nodeOptions,onUpdateMatchingNICs:V.updateMatchingNICs,onUpdateMatchingNodes:V.updateMatchingNodes},null,8,["mode","value","nodes","onUpdateMatchingNICs","onUpdateMatchingNodes"])])])])),_:1},8,["label"]),(0,o.createVNode)(B,{name:"upLink",label:e.t("harvester.vlanConfig.titles.uplink"),weight:99,"show-header":!1},{default:(0,o.withCtx)((()=>[(0,o.createElementVNode)("div",i,[(0,o.createElementVNode)("div",d,[(0,o.createVNode)(A,{name:e.t("harvester.network.clusterNetwork.label"),value:e.value.spec.clusterNetwork},null,8,["name","value"])]),(0,o.createElementVNode)("div",c,[(0,o.createVNode)(A,{name:"Type",value:"VLAN"})])]),(0,o.createElementVNode)("div",u,[(0,o.createElementVNode)("div",p,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(N.nicErrors,((e,t)=>((0,o.openBlock)(),(0,o.createBlock)(E,{key:t,color:"warning",label:e},null,8,["label"])))),128)),(0,o.createVNode)(x,{value:e.value.spec.uplink.nics,"onUpdate:value":t[1]||(t[1]=t=>e.value.spec.uplink.nics=t),mode:e.mode,options:V.nicOptions,"enable-default-add-value":!1,"array-list-props":{addLabel:e.t("harvester.vlanConfig.uplink.nics.addLabel"),initialEmptyRow:!0,title:e.t("harvester.vlanConfig.uplink.nics.label"),required:!0,protip:!1},"select-props":{placeholder:e.t("harvester.vlanConfig.uplink.nics.placeholder")}},null,8,["value","mode","options","array-list-props","select-props"])])]),(0,o.createElementVNode)("h3",m,(0,o.toDisplayString)(e.t("harvester.vlanConfig.titles.bondOptions")),1),(0,o.createElementVNode)("div",v,[(0,o.createElementVNode)("div",h,[(0,o.createVNode)(D,{value:V.bondOptionMode,"onUpdate:value":t[2]||(t[2]=e=>V.bondOptionMode=e),label:e.t("harvester.vlanConfig.uplink.bondOptions.mode.label"),mode:e.mode,options:V.bondOptions,required:""},null,8,["value","label","mode","options"])]),(0,o.createElementVNode)("div",b,[(0,o.createVNode)(M,{value:V.miimon,"onUpdate:value":t[3]||(t[3]=e=>V.miimon=e),valueModifiers:{number:!0},label:e.t("harvester.vlanConfig.uplink.bondOptions.miimon.label"),mode:e.mode,type:"number",tooltip:e.t("harvester.vlanConfig.uplink.bondOptions.miimon.tooltip",null,!0)},null,8,["value","label","mode","tooltip"])])]),(0,o.createElementVNode)("h3",g,(0,o.toDisplayString)(e.t("harvester.vlanConfig.titles.attributes")),1),(0,o.createElementVNode)("div",f,[(0,o.createElementVNode)("div",k,[(0,o.createVNode)(M,{value:V.mtu,"onUpdate:value":t[4]||(t[4]=e=>V.mtu=e),valueModifiers:{number:!0},label:e.t("harvester.vlanConfig.uplink.linkAttributes.mtu.label"),mode:e.mode,type:"number"},null,8,["value","label","mode"])])])])),_:1},8,["label"])])),_:1})])),_:1},8,["resource","mode","errors","onFinish"]))}var N=a(45250),V=a(43094),C=a(40527),w=a(79380),E=a(89483),S=a(63209),B=a(42411),A=a(1050),x=a(39412),D=a(87619),M=a(9980),U=a(91825),T=a(35664),I=a(76978),O=a(68851),_=a(88339),P=a(2841),$=a(38823),R=a(32766),L=a(95058),q={emits:["update:value"],components:{CruResource:V.A,NameNsDescription:C.A,LabeledInput:w.o,LabeledSelect:E.A,Tabbed:S.A,Tab:B.A,NodeSelector:L["default"],ArrayListSelect:A.A,LabelValue:x.A,Loading:D.A,Banner:M.l},mixins:[U.A],inheritAttrs:!1,data(){const e=(0,I.o8)(this.value?.spec?.uplink?.nics||[]),t={matched:0,matches:[],none:!0,sample:null,total:0};return{type:"vlan",matchNICs:[],originNics:e,matchingNodes:t,nicErrors:[]}},created(){this.registerBeforeHook&&this.registerBeforeHook(this.validate);const e=this.$route.query.clusterNetwork;e&&(0,I.hZ)(this.value,"spec.clusterNetwork",e)},async fetch(){const e=this.$store.getters["currentProduct"].inStore,t={linkMonitors:this.$store.dispatch(`${e}/findAll`,{type:R.rk.LINK_MONITOR}),nodes:this.$store.dispatch(`${e}/findAll`,{type:T.NW})};await(0,_.kR)(t),this.updateMatchingNICs(),this.updateMatchingNodes()},computed:{nodeOptions(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](T.NW);return t.filter((e=>"true"!==e.isEtcd)).map((e=>({label:e.nameDisplay,value:e.id})))},mtu:{get(){return this.value?.spec?.uplink?.linkAttributes?.mtu},set(e){(0,I.hZ)(this.value,"spec.uplink.linkAttributes.mtu",e)}},bondOptionMode:{get(){return this.value?.spec?.uplink?.bondOptions?.mode},set(e){(0,I.hZ)(this.value,"spec.uplink.bondOptions.mode",e)}},miimon:{get(){return this.value?.spec?.uplink?.bondOptions?.miimon},set(e){(0,I.hZ)(this.value,"spec.uplink.bondOptions.miimon",e)}},bondOptions(){return["balance-rr","active-backup","balance-xor","broadcast","802.3ad","balance-tlb","balance-alb"]},doneLocationOverride(){return this.value.doneOverride},nics(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/byId`](R.rk.LINK_MONITOR,"nic")||{},a=t?.status?.linkStatus||{},o=this.nodes.map((e=>e.id)),r=[];return Object.keys(a).map((e=>{if(o.includes(e)){const t=a[e]||[];t.map((t=>{r.push({...t,nodeName:e})}))}})),r},nicOptions(){const e=[],t={};return(this.matchNICs||[]).map((a=>{a.masterIndex&&!this.originNics.includes(a.name)?(0,I.hZ)(t,`${a.name}.masterIndex`,!0):(0,O.jq)(e,"name",a.name)?(0,O.jq)(e,"name",a.name)&&((0,I.hZ)(t,`${a.name}.total`,t[a.name].total+1),(0,I.hZ)(t,`${a.name}.down`,"down"===a.state?t[a.name].down+1:t[a.name].down)):(e.push(a),(0,I.hZ)(t,`${a.name}.total`,1),(0,I.hZ)(t,`${a.name}.down`,"down"===a.state?1:0))})),e.filter((e=>!t[e.name].masterIndex)).map((e=>{let a="";return a=0===t[e.name].down?`${e.name} (Up)`:1===t[e.name].total?`${e.name} (Down)`:`${e.name} (${t[e.name].down}/${t[e.name].total} Down)`,{label:a,value:e.name,disabled:t[e.name].down>0}}))},nodes(){const e=this.$store.getters["currentProduct"].inStore,t=this.$store.getters[`${e}/all`](T.NW);return t.filter((e=>"true"!==e.isEtcd))}},methods:{validate(){const e=[],t=this.value.spec?.uplink?.nics||[],a=this.t("validation.arrayCountRequired",{key:this.t("harvester.vlanConfig.uplink.nics.label"),count:1},!0);if(0===t.length?e.push(a):t.map((t=>{t||e.push(a);const o=this.nicOptions.find((e=>e.value===t));o&&o?.disabled&&e.push(this.t("harvester.vlanConfig.uplink.nics.validate.available",{nic:t},!0))})),this.value?.metadata?.name||e.push(this.t("validation.required",{key:this.t("generic.name")},!0)),this.value?.spec?.clusterNetwork||e.push(this.t("validation.required",{key:this.t("harvester.network.clusterNetwork.label")},!0)),e.length>0)return Promise.reject((0,O.sb)(e));{const e=this.value?.spec?.uplink?.bondOptions?.miimon;e||0===e||delete this.value?.spec?.uplink?.bondOptions?.miimon;const t=this.value?.spec?.uplink?.linkAttributes?.mtu;return t||0===t||delete this.value?.spec?.uplink?.linkAttributes?.mtu,Promise.resolve()}},updateMatchingNICs:(0,N.throttle)((function(){const e=this.value?.spec?.nodeSelector||{},t=this.nics||[];let a=[],o=[];if((0,N.isEmpty)(e))a=(0,I.o8)(t),o=(this.nodes||[]).map((e=>e.id));else if(e[P.yA]&&1===Object.keys(e).length)a=t.filter((t=>t.nodeName===e[P.yA])),o=[e[P.yA]];else{const r=(0,$.wC)(this.nodes||[],e).map((e=>e.id));a=t.filter((e=>r.includes(e.nodeName))),o=r.map((e=>e.id))}this.matchNICs=this.intersection(a,o)||[]}),250,{leading:!0}),intersection(e=[],t=[]){const a={};return e.map((e=>{a[e.name]=(a[e.name]||0)+1})),e.filter((e=>a[e.name]===t.length))},updateMatchingNodes:(0,N.throttle)((function(){const e=this.value?.spec?.nodeSelector||{},t=this.nodes||[];if((0,N.isEmpty)(e))this.matchingNodes={matched:t.length,total:t.length,none:!1,sample:t[0]?t[0].nameDisplay:null};else if(e[P.yA]&&1===Object.keys(e).length){const a=t.find((t=>t.id===e[P.yA]));this.matchingNodes=a?{matched:1,total:t.length,none:!1,sample:a.nameDisplay}:{matched:0,total:0,none:!0,sample:null}}else{const a=(0,$.wC)(t,e);this.matchingNodes={matched:a.length,total:t.length,none:0===a.length,sample:a[0]?a[0].nameDisplay:null}}}),250,{leading:!0})},watch:{nicOptions(e){const t=this.value.spec?.uplink?.nics||[],a=[];t.map((t=>{const o=e.find((e=>e.value===t));(o&&o?.disabled||!o)&&a.push(this.t("harvester.vlanConfig.uplink.nics.validate.available",{nic:t},!0))})),this.nicErrors=(0,O.sb)(a)}}},F=(a(19912),a(47433));const H=(0,F.A)(q,[["render",y],["__scopeId","data-v-1750718a"]]);var G=H},25058:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var o=a(9274);const r={class:"network-policy-edit"};function l(e,t,a,l,s,n){const i=(0,o.resolveComponent)("t"),d=(0,o.resolveComponent)("Banner"),c=(0,o.resolveComponent)("NetworkPolicy");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(d,{color:"info"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(i,{k:"harvester.networkPolicy.banner",url:n.networkPolicyDocLink,raw:!0},null,8,["url"])])),_:1}),(0,o.createVNode)(c,(0,o.normalizeProps)((0,o.guardReactiveProps)(e.$attrs)),null,16)])}var s=a(46174),n=a(9980),i=a(66242),d=a(3791),c={components:{NetworkPolicy:s.A,Banner:n.l},computed:{networkPolicyDocLink(){const e=this.$store.getters["harvester-common/getServerVersion"]();return(0,d.nn)(i.d.NETWORK_POLICY,e)}}},u=(a(45474),a(47433));const p=(0,u.A)(c,[["render",l],["__scopeId","data-v-7a1c4cde"]]);var m=p},51591:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".migration-field[data-v-24ae0fbe]{display:flex;flex-direction:column;gap:12px}",""]),t["default"]=n},72173:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".error[data-v-0ce3cc75]{color:#d9534f;margin-top:5px}",""]),t["default"]=n},5531:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".tag[data-v-6b2f75f1]{border:1px solid var(--primary);border-radius:var(--border-radius);box-sizing:border-box;margin:0;padding:0;font-size:14px;line-height:20px;list-style:none;display:inline-block;height:auto;margin-inline-end:8px;padding-inline:7px;white-space:nowrap;background:var(--accent-btn);opacity:1;text-align:start;color:var(--link);margin-bottom:10px;margin-right:8px;padding-top:8px;padding-bottom:8px}.tag i[data-v-6b2f75f1],.tag.add[data-v-6b2f75f1]{cursor:pointer}.tag.add[data-v-6b2f75f1]{border-style:dashed}.tag.add[data-v-6b2f75f1],.tag.input[data-v-6b2f75f1]{background:var(--body-bg)}.tag.input[data-v-6b2f75f1]{border:none;border-radius:none;padding:0}",""]),t["default"]=n},48952:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-034d9714]  .radio-group{display:flex}[data-v-034d9714]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},37853:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"p[data-v-4b7055bd]{display:flex;align-items:center}.icon-h-question[data-v-4b7055bd]{font-size:24px}.tip[data-v-4b7055bd]{font-size:15px}.goCA[data-v-4b7055bd]{margin:0 3px}",""]),t["default"]=n},44309:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".box[data-v-d281fc5e]{position:relative;padding-top:40px}.remove[data-v-d281fc5e]{position:absolute;top:10px;right:10px;padding:0}",""]),t["default"]=n},62636:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".box[data-v-a4b4739a]{position:relative;padding-top:40px}.remove[data-v-a4b4739a]{position:absolute;top:10px;right:10px;padding:0}",""]),t["default"]=n},26449:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".box[data-v-0083bb1a]{position:relative;padding-top:40px}.remove[data-v-0083bb1a]{position:absolute;top:10px;right:10px;padding:0}",""]),t["default"]=n},1092:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-c0399262]  .yaml-editor{flex:1;min-height:540px}[data-v-c0399262]  .yaml-editor .code-mirror .CodeMirror{position:static;height:auto;min-height:540px}",""]),t["default"]=n},95083:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".chooseFile[data-v-27a09764]{display:flex;align-items:center}",""]),t["default"]=n},94937:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-9dd10f70]  .radio-group{display:flex}[data-v-9dd10f70]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},9759:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".restart-modal[data-v-0f53a5eb]{z-index:45}.prompt-restart[data-v-0f53a5eb]{margin:0}.bottom[data-v-0f53a5eb]{display:flex;flex-direction:column;flex:1}.bottom .banner[data-v-0f53a5eb]{margin-top:0}.bottom .buttons[data-v-0f53a5eb]{display:flex;justify-content:flex-end;width:100%}",""]),t["default"]=n},99334:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-24a677c4]  .radio-group{display:flex}[data-v-24a677c4]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},57165:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-4b980a18]  .radio-group{display:flex}[data-v-4b980a18]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},22802:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-365beeb4]  .radio-group{display:flex}[data-v-365beeb4]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},1814:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-bdc3ab06]  .radio-group{display:flex}[data-v-bdc3ab06]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},96370:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-4ac8f18c]  .radio-group{display:flex}[data-v-4ac8f18c]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},12029:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-077b6bf4]  .radio-group{display:flex}[data-v-077b6bf4]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},46453:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-b9cb7bba]  .radio-group{display:flex}[data-v-b9cb7bba]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},88087:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-7d4cbfa3]  .radio-group{display:flex}[data-v-7d4cbfa3]  .radio-group .radio-container{margin-right:30px}",""]),t["default"]=n},91968:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"[data-v-1ecffc0e]  .yaml-editor{flex:1;min-height:200px}[data-v-1ecffc0e]  .yaml-editor .code-mirror .CodeMirror{position:static;height:auto;min-height:200px}",""]),t["default"]=n},95996:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".close[data-v-a5bf4cfc]{top:10px;right:10px;padding:0;position:absolute}.disk[data-v-a5bf4cfc]{position:relative}.disk .secret-name[data-v-a5bf4cfc]{height:61px}.disk[data-v-a5bf4cfc]:not(:last-of-type){padding-bottom:10px;margin-bottom:30px}.flex[data-v-a5bf4cfc]{display:flex;justify-content:space-between}.badge-state[data-v-a5bf4cfc]{padding:2px 5px}",""]),t["default"]=n},64370:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"#node[data-v-dfe6cb52]{display:flex;flex-direction:column}#node[data-v-dfe6cb52],#node .content[data-v-dfe6cb52]{flex-grow:1}#node .wrapper[data-v-dfe6cb52]{position:relative}#node .nicOption[data-v-dfe6cb52]{display:flex;justify-content:space-between}",""]),t["default"]=n},18740:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".header[data-v-9e3db54e]{display:flex;justify-content:flex-end}",""]),t["default"]=n},88051:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".output{display:flex;flex-direction:column;flex-grow:1}.output .provider h1{display:inline-block}.output .box-container{display:flex;justify-content:flex-start;flex-wrap:wrap;margin:0 -10px}@media only screen and (min-width:480px){.output .box-container .toggle-gradient-box{width:100%}}@media only screen and (min-width:768px){.output .box-container .toggle-gradient-box{width:calc(50% - 20px)}}@media only screen and (min-width:992px){.output .box-container .toggle-gradient-box{width:calc(33.33333% - 20px)}}@media only screen and (min-width:1281px){.output .box-container .toggle-gradient-box{width:calc(25% - 20px)}}.output .box-container .toggle-gradient-box{margin:10px;padding:10px;position:relative;border-radius:calc(var(--border-radius)*1.5)}.output .box-container .toggle-gradient-box:hover{box-shadow:0 0 30px var(--shadow);transition:box-shadow .1s ease-in-out;cursor:pointer}.output .box-container .toggle-gradient-box .side-label{transform:rotate(180deg);position:absolute;top:0;left:0;bottom:0;min-width:calc(var(--border-radius)*1.5);width:15px;border-top-right-radius:calc(var(--border-radius)*1.5);border-bottom-right-radius:calc(var(--border-radius)*1.5)}.output .box-container .toggle-gradient-box .side-label label{text-align:center;writing-mode:tb;height:100%;padding:0 2px;display:block;white-space:no-wrap;text-overflow:ellipsis}.output .box-container .toggle-gradient-box .logo{text-align:center;width:60px;height:60px;border-radius:calc(var(--border-radius)*2);overflow:hidden;background-color:#fff;display:inline-block;vertical-align:middle}.output .box-container .toggle-gradient-box .logo img{width:56px;height:56px;-o-object-fit:contain;object-fit:contain;position:relative;top:2px}.output .box-container .toggle-gradient-box:hover{background-position:100%}.output .box-container .toggle-gradient-box .name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:0;display:inline-block;vertical-align:middle}",""]),t["default"]=n},18597:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"h3[data-v-3585e2fe]{margin-top:2em}input[data-v-3585e2fe]{margin-top:1em}.route[real-mode=view] .label[data-v-3585e2fe]{color:var(--input-label)}button[data-v-3585e2fe]{margin-left:.5em}a[data-v-3585e2fe]:hover{text-decoration:none}",""]),t["default"]=n},5980:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".remove-btn[data-v-73ede312]{align-self:center}.trunk-span[data-v-73ede312]{flex:5}",""]),t["default"]=n},46883:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".edit-change[data-v-45d7bc4b]{align-items:center;display:flex}.edit-change>h5[data-v-45d7bc4b]{flex:1}[data-v-45d7bc4b]  .edit-help code{padding:1px 5px}[data-v-45d7bc4b] .banner__content.closable{white-space:normal;word-break:break-word}",""]),t["default"]=n},9884:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".column-headers .row.custom[data-v-f04994c6]{max-width:calc(100% - 75px)}.row[data-v-f04994c6]{align-items:center}.select[data-v-f04994c6]{max-width:480px}",""]),t["default"]=n},94983:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".custom-headers[data-v-e0dfa694]{align-items:center}",""]),t["default"]=n},65601:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".labeled-input.compact-input[data-v-8c848812]{padding:7px 10px}",""]),t["default"]=n},13158:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".labeled-input.compact-input[data-v-1618b260]{padding:7px 10px}",""]),t["default"]=n},25936:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".labeled-input.compact-input[data-v-6afc4f36]{padding:7px 10px}",""]),t["default"]=n},30056:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"#restore[data-v-dcf8e7de]{display:flex;flex-grow:1;flex-direction:column}#restore[data-v-dcf8e7de]  .radio-group{display:flex}#restore[data-v-dcf8e7de]  .radio-group .radio-container{margin-right:30px}#restore .content[data-v-dcf8e7de]{flex-grow:1}#restore .footer[data-v-dcf8e7de]{border-top:var(--header-border-size) solid var(--header-border);margin-left:-24px;margin-right:-24px;margin-bottom:-24px;padding:10px 24px}#restore .footer[data-v-dcf8e7de]  .spacer-small{padding:0}",""]),t["default"]=n},63554:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".kv-item.value>.unlabeled-select[data-v-64a57538]{height:40px;line-height:1}",""]),t["default"]=n},4689:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"#restore[data-v-6c93c587]{display:flex;flex-grow:1;flex-direction:column}#restore[data-v-6c93c587]  .radio-group{display:flex}#restore[data-v-6c93c587]  .radio-group .radio-container{margin-right:30px}#restore .content[data-v-6c93c587]{flex-grow:1}#restore .footer[data-v-6c93c587]{border-top:var(--header-border-size) solid var(--header-border);margin-left:-24px;margin-right:-24px;margin-bottom:-24px;padding:10px 24px}#restore .footer[data-v-6c93c587]  .spacer-small{padding:0}",""]),t["default"]=n},85581:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".box[data-v-590f4df4]{position:relative}.removeBtn[data-v-590f4df4]{position:absolute;top:10px;right:10px;padding:0}",""]),t["default"]=n},50524:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".dhcpOption-banner[data-v-e1da6b10]{width:-moz-max-content;width:max-content}",""]),t["default"]=n},30709:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".pool-headers[data-v-cff1ac6e],.pool-row[data-v-cff1ac6e]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center}.pool-headers.cidr[data-v-cff1ac6e],.pool-row.cidr[data-v-cff1ac6e]{grid-template-columns:41.75% 41.75% 15%}",""]),t["default"]=n},88307:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".pool-headers[data-v-4bce4a2b],.pool-row[data-v-4bce4a2b]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center}.pool-headers.localConnectIP[data-v-4bce4a2b],.pool-row.localConnectIP[data-v-4bce4a2b]{grid-template-columns:41.75% 41.75% 15%}",""]),t["default"]=n},33422:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".compat-matrix,.device-col{display:flex}.device-col{flex-direction:column;border-right:1px solid var(--border)}.device-col>*{border-bottom:1px solid var(--border)}.compat-cell{flex-basis:1em;padding:0 10px 0 10px}.compat-cell.has-device{background-color:var(--info-banner-bg)}.device-label,.node-label{display:flex;align-items:center;color:var(--input-label)}.node-label{padding:0 10px;justify-content:center}.blank-corner,.compat-cell,.device-label,.node-label{flex-basis:calc(2em + 10px)}.blank-corner{background:linear-gradient(to top right,#fff 0,#fff calc(50% - 1px),var(--body-text) 50%,#fff calc(50% + 1px),#fff 100%)}.blank-corner DIV.text-right{padding-left:80px}",""]),t["default"]=n},26387:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"#vm[data-v-95dadbfa]  .vm-radio-group .radio-group{display:flex}#vm[data-v-95dadbfa]  .vm-radio-group .radio-group .radio-container{margin-right:30px}#vm .restart[data-v-95dadbfa]{display:flex;justify-content:flex-end}#vm .banner-right[data-v-95dadbfa]{width:auto;display:flex;justify-items:center}",""]),t["default"]=n},21885:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".pool-headers[data-v-4914b3a7]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center;grid-template-columns:40% 40% 15%}.pool-headers.show-project-and-cluster[data-v-4914b3a7]{grid-template-columns:25% 25% 25% 15%}",""]),t["default"]=n},40262:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".pool-row[data-v-4db6b05a]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center;grid-template-columns:40% 40% 15%}.pool-row.show-project-and-cluster[data-v-4db6b05a]{grid-template-columns:25% 25% 25% 15%}",""]),t["default"]=n},25792:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".pool-headers[data-v-6a840725],.pool-row[data-v-6a840725]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center}.pool-headers.cidr[data-v-6a840725],.pool-row.cidr[data-v-6a840725]{grid-template-columns:41.75% 41.75% 15%}.pool-headers.range[data-v-6a840725],.pool-row.range[data-v-6a840725]{grid-template-columns:20% 20% 20% 20% 15%}",""]),t["default"]=n},48564:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".listener-headers[data-v-602acdc3],.listener-row[data-v-602acdc3]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center;grid-template-columns:35% 15% 15% 15% 15%}",""]),t["default"]=n},44713:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".title[data-v-ef4b96d4]{margin-bottom:10px}.title .read-from-file[data-v-ef4b96d4]{float:right}.ports-headers[data-v-ef4b96d4],.ports-row[data-v-ef4b96d4]{display:grid;grid-column-gap:1.75%;margin-bottom:10px;align-items:center}.ports-headers.show-protocol[data-v-ef4b96d4],.ports-row.show-protocol[data-v-ef4b96d4]{grid-template-columns:23% 23% 10% 15% 15% 10%}.ports-headers.show-protocol[data-v-ef4b96d4]:not(.show-node-port),.ports-row.show-protocol[data-v-ef4b96d4]:not(.show-node-port){grid-template-columns:31% 31% 10% 15% 10%}.ports-headers.show-node-port[data-v-ef4b96d4]:not(.show-protocol),.ports-row.show-node-port[data-v-ef4b96d4]:not(.show-protocol){grid-template-columns:28% 28% 15% 15% 10%}.ports-headers[data-v-ef4b96d4]{color:var(--input-label)}.toggle-host-ports[data-v-ef4b96d4]{color:var(--primary)}.remove BUTTON[data-v-ef4b96d4]{padding:0}.ports-row>div[data-v-ef4b96d4]{height:100%}.ports-row .port-protocol[data-v-ef4b96d4]  .unlabeled-select .v-select.inline{margin-top:2px}.footer[data-v-ef4b96d4]{margin-top:10px;margin-left:5px}.footer .protip[data-v-ef4b96d4]{float:right;padding:5px 0}",""]),t["default"]=n},86472:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,"button[data-v-1750718a]{all:unset;height:0;position:relative;top:-35px;float:right;margin-right:7px;cursor:pointer}button .align-value[data-v-1750718a]{padding-top:7px}",""]),t["default"]=n},95618:function(e,t,a){"use strict";a.r(t);var o=a(36758),r=a.n(o),l=a(40935),s=a.n(l),n=s()(r());n.push([e.id,".network-policy-edit[data-v-7a1c4cde]{flex:auto;display:flex;flex-direction:column}",""]),t["default"]=n},44684:function(e,t,a){var o=a(51591);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("23fba647",o,!0,{sourceMap:!1,shadowMode:!1})},47554:function(e,t,a){var o=a(72173);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("0a82a107",o,!0,{sourceMap:!1,shadowMode:!1})},61051:function(e,t,a){var o=a(5531);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("2ab997d2",o,!0,{sourceMap:!1,shadowMode:!1})},50072:function(e,t,a){var o=a(48952);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("011aed91",o,!0,{sourceMap:!1,shadowMode:!1})},10205:function(e,t,a){var o=a(37853);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("796d5530",o,!0,{sourceMap:!1,shadowMode:!1})},88789:function(e,t,a){var o=a(44309);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("4412edfb",o,!0,{sourceMap:!1,shadowMode:!1})},31660:function(e,t,a){var o=a(62636);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("355586d0",o,!0,{sourceMap:!1,shadowMode:!1})},31729:function(e,t,a){var o=a(26449);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("137f7524",o,!0,{sourceMap:!1,shadowMode:!1})},58180:function(e,t,a){var o=a(1092);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("0b6ebda2",o,!0,{sourceMap:!1,shadowMode:!1})},92427:function(e,t,a){var o=a(95083);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("3f5ef292",o,!0,{sourceMap:!1,shadowMode:!1})},86873:function(e,t,a){var o=a(94937);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("213558ae",o,!0,{sourceMap:!1,shadowMode:!1})},13503:function(e,t,a){var o=a(9759);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("54300e05",o,!0,{sourceMap:!1,shadowMode:!1})},21030:function(e,t,a){var o=a(99334);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("21824756",o,!0,{sourceMap:!1,shadowMode:!1})},19949:function(e,t,a){var o=a(57165);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("52afd3fe",o,!0,{sourceMap:!1,shadowMode:!1})},57010:function(e,t,a){var o=a(22802);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("5bf22ba4",o,!0,{sourceMap:!1,shadowMode:!1})},71318:function(e,t,a){var o=a(1814);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("097b633b",o,!0,{sourceMap:!1,shadowMode:!1})},82002:function(e,t,a){var o=a(96370);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("1492605e",o,!0,{sourceMap:!1,shadowMode:!1})},18813:function(e,t,a){var o=a(12029);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("3008a3f0",o,!0,{sourceMap:!1,shadowMode:!1})},11221:function(e,t,a){var o=a(46453);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("27f0bb08",o,!0,{sourceMap:!1,shadowMode:!1})},27639:function(e,t,a){var o=a(88087);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("d2d2f1a4",o,!0,{sourceMap:!1,shadowMode:!1})},66592:function(e,t,a){var o=a(91968);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("2c802be1",o,!0,{sourceMap:!1,shadowMode:!1})},5564:function(e,t,a){var o=a(95996);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("0f6054ee",o,!0,{sourceMap:!1,shadowMode:!1})},60754:function(e,t,a){var o=a(64370);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("16f5184e",o,!0,{sourceMap:!1,shadowMode:!1})},64308:function(e,t,a){var o=a(18740);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("2d86d8bd",o,!0,{sourceMap:!1,shadowMode:!1})},94547:function(e,t,a){var o=a(88051);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("445e5e9f",o,!0,{sourceMap:!1,shadowMode:!1})},27589:function(e,t,a){var o=a(18597);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("59a130bc",o,!0,{sourceMap:!1,shadowMode:!1})},45820:function(e,t,a){var o=a(5980);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("733dddec",o,!0,{sourceMap:!1,shadowMode:!1})},33123:function(e,t,a){var o=a(46883);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("140186ee",o,!0,{sourceMap:!1,shadowMode:!1})},1980:function(e,t,a){var o=a(9884);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("fd799b78",o,!0,{sourceMap:!1,shadowMode:!1})},96391:function(e,t,a){var o=a(94983);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("380e2d1c",o,!0,{sourceMap:!1,shadowMode:!1})},20545:function(e,t,a){var o=a(65601);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("165b7990",o,!0,{sourceMap:!1,shadowMode:!1})},88198:function(e,t,a){var o=a(13158);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("2d4ffc04",o,!0,{sourceMap:!1,shadowMode:!1})},5648:function(e,t,a){var o=a(25936);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("24b87eda",o,!0,{sourceMap:!1,shadowMode:!1})},4008:function(e,t,a){var o=a(30056);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("99c9cf44",o,!0,{sourceMap:!1,shadowMode:!1})},40610:function(e,t,a){var o=a(63554);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("00476935",o,!0,{sourceMap:!1,shadowMode:!1})},38673:function(e,t,a){var o=a(4689);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("344e8b72",o,!0,{sourceMap:!1,shadowMode:!1})},52045:function(e,t,a){var o=a(85581);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("cc0271ae",o,!0,{sourceMap:!1,shadowMode:!1})},40028:function(e,t,a){var o=a(50524);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("e42dc67a",o,!0,{sourceMap:!1,shadowMode:!1})},17109:function(e,t,a){var o=a(30709);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("23128680",o,!0,{sourceMap:!1,shadowMode:!1})},79891:function(e,t,a){var o=a(88307);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("e6a09e5c",o,!0,{sourceMap:!1,shadowMode:!1})},91950:function(e,t,a){var o=a(33422);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("5f8696f8",o,!0,{sourceMap:!1,shadowMode:!1})},32659:function(e,t,a){var o=a(26387);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("6519d94c",o,!0,{sourceMap:!1,shadowMode:!1})},69117:function(e,t,a){var o=a(21885);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("c5d8299c",o,!0,{sourceMap:!1,shadowMode:!1})},75782:function(e,t,a){var o=a(40262);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("bfe7e752",o,!0,{sourceMap:!1,shadowMode:!1})},25760:function(e,t,a){var o=a(25792);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("15480cb2",o,!0,{sourceMap:!1,shadowMode:!1})},50004:function(e,t,a){var o=a(48564);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("54340006",o,!0,{sourceMap:!1,shadowMode:!1})},57353:function(e,t,a){var o=a(44713);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("11e13e2a",o,!0,{sourceMap:!1,shadowMode:!1})},19912:function(e,t,a){var o=a(86472);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("66b2ea2b",o,!0,{sourceMap:!1,shadowMode:!1})},45474:function(e,t,a){var o=a(95618);o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.id,o,""]]),o.locals&&(e.exports=o.locals);var r=a(74825).A;r("7f2e4cd0",o,!0,{sourceMap:!1,shadowMode:!1})},28431:function(e,t,a){var o={"./__tests__/loki.test":53338,"./__tests__/loki.test.ts":53338,"./awsElasticsearch":62729,"./awsElasticsearch.vue":62729,"./azurestorage":54093,"./azurestorage.vue":54093,"./cloudwatch":4991,"./cloudwatch.vue":4991,"./datadog":19443,"./datadog.vue":19443,"./elasticsearch":97863,"./elasticsearch.vue":97863,"./file":77332,"./file.vue":77332,"./forward":83158,"./forward.vue":83158,"./gcs":17686,"./gcs.vue":17686,"./gelf":36118,"./gelf.vue":36118,"./kafka":97622,"./kafka.vue":97622,"./kinesisStream":37803,"./kinesisStream.vue":37803,"./logdna":46636,"./logdna.vue":46636,"./logz":72135,"./logz.vue":72135,"./loki":42629,"./loki.vue":42629,"./newrelic":12951,"./newrelic.vue":12951,"./opensearch":26087,"./opensearch.vue":26087,"./redis":49054,"./redis.vue":49054,"./s3":32156,"./s3.vue":32156,"./splunkHec":10918,"./splunkHec.vue":10918,"./sumologic":54132,"./sumologic.vue":54132,"./syslog":32401,"./syslog.vue":32401,"./utils":69598,"./utils.js":69598};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=28431},48254:function(e,t,a){var o={"./":46106,"./__tests__/ssh.test":93498,"./__tests__/ssh.test.ts":93498,"./basic":16149,"./basic.vue":16149,"./generic":94719,"./generic.vue":94719,"./index":46106,"./index.vue":46106,"./registry":25532,"./registry.vue":25532,"./ssh":22153,"./ssh.vue":22153,"./tls":64701,"./tls.vue":64701};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=48254},88292:function(e,t,a){var o={"./additional-ca.vue":36955,"./additional-guest-memory-overhead-ratio.vue":53867,"./auto-rotate-rke2-certs.vue":32158,"./backup-target.vue":71526,"./containerd-registry.vue":90955,"./csi-driver-config.vue":65241,"./csi-online-expand-validation.vue":63727,"./default-vm-termination-grace-period-seconds.vue":59392,"./http-proxy.vue":76143,"./kubevirt-migration.vue":34058,"./ntp-servers.vue":28436,"./overcommit-config.vue":70726,"./rancher-cluster.vue":89107,"./ssl-certificates.vue":54122,"./ssl-parameters.vue":13515,"./storage-network.vue":57589,"./support-bundle-image.vue":48749,"./support-bundle-namespaces.vue":49216,"./upgrade-config.vue":14436,"./vm-force-reset-policy.vue":34462,"./vm-migration-network.vue":55348};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=88292},26190:function(e,t,a){var o={"./additional-ca.vue":36955,"./additional-guest-memory-overhead-ratio.vue":53867,"./auto-rotate-rke2-certs.vue":32158,"./backup-target.vue":71526,"./containerd-registry.vue":90955,"./csi-driver-config.vue":65241,"./csi-online-expand-validation.vue":63727,"./default-vm-termination-grace-period-seconds.vue":59392,"./http-proxy.vue":76143,"./kubevirt-migration.vue":34058,"./ntp-servers.vue":28436,"./overcommit-config.vue":70726,"./rancher-cluster.vue":89107,"./ssl-certificates.vue":54122,"./ssl-parameters.vue":13515,"./storage-network.vue":57589,"./support-bundle-image.vue":48749,"./support-bundle-namespaces.vue":49216,"./upgrade-config.vue":14436,"./vm-force-reset-policy.vue":34462,"./vm-migration-network.vue":55348};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=26190},2467:function(e,t,a){var o={"./generic.vue":26370,"./harvester-seeder.vue":17438,"./index.vue":20668,"./nvidia-driver-toolkit.vue":6633,"./pcidevices-controller.vue":55821,"./rancher-logging.vue":70927,"./rancher-monitoring.vue":59289,"./rancher-vcluster.vue":95627,"./vm-import-controller.vue":32415};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=2467},6232:function(e,t,a){var o={"./custom":43868,"./custom.vue":43868,"./driver.longhorn.io_v1":30050,"./driver.longhorn.io_v1.vue":30050,"./driver.longhorn.io_v2":42822,"./driver.longhorn.io_v2.vue":42822,"./lvm.driver.harvesterhci.io":14257,"./lvm.driver.harvesterhci.io.vue":14257};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=6232},80373:function(e,t,a){var o={"./harvesterhci.io.addon/generic.vue":26370,"./harvesterhci.io.addon/harvester-seeder.vue":17438,"./harvesterhci.io.addon/index.vue":20668,"./harvesterhci.io.addon/nvidia-driver-toolkit.vue":6633,"./harvesterhci.io.addon/pcidevices-controller.vue":55821,"./harvesterhci.io.addon/rancher-logging.vue":70927,"./harvesterhci.io.addon/rancher-monitoring.vue":59289,"./harvesterhci.io.addon/rancher-vcluster.vue":95627,"./harvesterhci.io.addon/vm-import-controller.vue":32415,"./harvesterhci.io.host/HarvesterDisk.vue":75851,"./harvesterhci.io.host/HarvesterHugepages.vue":45137,"./harvesterhci.io.host/HarvesterKsmtuned.vue":77768,"./harvesterhci.io.host/HarvesterSeeder.vue":65864,"./harvesterhci.io.host/index.vue":35237,"./harvesterhci.io.monitoring.alertmanagerconfig/index.vue":36605,"./harvesterhci.io.storage/CDISettings.vue":8716,"./harvesterhci.io.storage/index.vue":14787,"./harvesterhci.io.storage/provisioners/custom.vue":43868,"./harvesterhci.io.storage/provisioners/driver.longhorn.io_v1.vue":30050,"./harvesterhci.io.storage/provisioners/driver.longhorn.io_v2.vue":42822,"./harvesterhci.io.storage/provisioners/lvm.driver.harvesterhci.io.vue":14257,"./kubeovn.io.subnet/AccessControlList.vue":49270,"./kubeovn.io.subnet/index.vue":77252,"./kubeovn.io.vpc/StaticRoutes.vue":25017,"./kubeovn.io.vpc/VpcPeerings.vue":57477,"./kubeovn.io.vpc/index.vue":18411,"./kubevirt.io.virtualmachine/CompatibilityMatrix.vue":93987,"./kubevirt.io.virtualmachine/VirtualMachineAccessCredentials/AccessCredentialsUsers.vue":58094,"./kubevirt.io.virtualmachine/VirtualMachineAccessCredentials/index.vue":60068,"./kubevirt.io.virtualmachine/VirtualMachineAccessCredentials/type/basicAuth.vue":23574,"./kubevirt.io.virtualmachine/VirtualMachineAccessCredentials/type/sshkey.vue":18933,"./kubevirt.io.virtualmachine/VirtualMachineCloudConfig/DataTemplate.vue":36334,"./kubevirt.io.virtualmachine/VirtualMachineCloudConfig/index.vue":71574,"./kubevirt.io.virtualmachine/VirtualMachineCpuMemory.vue":81111,"./kubevirt.io.virtualmachine/VirtualMachineNetwork/base.vue":48893,"./kubevirt.io.virtualmachine/VirtualMachineNetwork/index.vue":73705,"./kubevirt.io.virtualmachine/VirtualMachinePciDevices/DeviceList.vue":79428,"./kubevirt.io.virtualmachine/VirtualMachinePciDevices/index.vue":69057,"./kubevirt.io.virtualmachine/VirtualMachineReserved.vue":14869,"./kubevirt.io.virtualmachine/VirtualMachineSSHKey.vue":383,"./kubevirt.io.virtualmachine/VirtualMachineUSBDevices/DeviceList.vue":34529,"./kubevirt.io.virtualmachine/VirtualMachineUSBDevices/index.vue":12258,"./kubevirt.io.virtualmachine/VirtualMachineVGpuDevices/VGpuDeviceList.vue":33212,"./kubevirt.io.virtualmachine/VirtualMachineVGpuDevices/index.vue":92200,"./kubevirt.io.virtualmachine/VirtualMachineVolume/index.vue":55323,"./kubevirt.io.virtualmachine/VirtualMachineVolume/type/container.vue":88656,"./kubevirt.io.virtualmachine/VirtualMachineVolume/type/existing.vue":44964,"./kubevirt.io.virtualmachine/VirtualMachineVolume/type/vmImage.vue":52005,"./kubevirt.io.virtualmachine/VirtualMachineVolume/type/volume.vue":34653,"./kubevirt.io.virtualmachine/index.vue":11739,"./loadbalancer.harvesterhci.io.ippool/Priority.vue":68611,"./loadbalancer.harvesterhci.io.ippool/PriorityRow.vue":86107,"./loadbalancer.harvesterhci.io.ippool/Range.vue":51100,"./loadbalancer.harvesterhci.io.ippool/Selector.vue":10788,"./loadbalancer.harvesterhci.io.ippool/index.vue":5113,"./loadbalancer.harvesterhci.io.loadbalancer/HealthCheck.vue":50927,"./loadbalancer.harvesterhci.io.loadbalancer/Listeners.vue":67347,"./loadbalancer.harvesterhci.io.loadbalancer/index.vue":21132,"./network.harvesterhci.io.clusternetwork/index.vue":40041,"./network.harvesterhci.io.vlanconfig/NodeSelector.vue":95058,"./network.harvesterhci.io.vlanconfig/index.vue":55191};function r(e){var t=l(e);return a(t)}function l(e){if(!a.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=l,e.exports=r,r.id=80373}}]);
//# sourceMappingURL=harvester-1.7.0.umd.min.edit.js.map