{"version":3,"file":"harvester-1.7.1.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-1.7.1/./promptRemove/harvesterhci.io.virtualmachinebackup.vue","webpack://harvester-1.7.1/./promptRemove/harvesterhci.io.virtualmachinebackup.vue?afef","webpack://harvester-1.7.1/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-1.7.1/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { resourceNames } from '@shell/utils/string';\nimport { mapGetters, mapState } from 'vuex';\nimport { BACKUP_TYPE } from '@pkg/harvester/config/types';\nimport { HCI } from '../types';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\n\nexport default {\n  name: 'PromptRemoveVMBackupDialog',\n\n  emits: ['errors'],\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    },\n\n    close: {\n      type:     Function,\n      required: true\n    },\n\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return { errors: [] };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n    resourceType() {\n      const isSnapshot = this.value?.[0]?.spec?.type === BACKUP_TYPE.SNAPSHOT;\n      const count = this.names?.length || 1;\n\n      if (isSnapshot) {\n        return this.t(`typeLabel.\"${ HCI.VM_SNAPSHOT }\"`, { count });\n      }\n\n      return this.t(`typeLabel.\"${ HCI.BACKUP }\"`, { count });\n    },\n  },\n  methods: {\n    resourceNames,\n    async remove(buttonDone) {\n      try {\n        await Promise.all(this.value.map((resource) => resource.remove()));\n        this.close(buttonDone);\n      } catch (err) {\n        this.errors = exceptionToErrorsArray(err);\n        buttonDone(false);\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    <div class=\"mb-5\">\n      {{ t('promptRemove.attemptingToRemove', { type: resourceType }) }} <span\n        v-clean-html=\"resourceNames(names, null, t)\"\n      />\n    </div>\n    <Banner\n      v-for=\"(error, i) in errors\"\n      :key=\"i\"\n      class=\"\"\n      color=\"error\"\n      :label=\"error\"\n    />\n  </div>\n</template>\n","import { render } from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=template&id=09d58eda\"\nimport script from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=script&lang=js\"\nexport * from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\nimport { alternateLabel as alternateLabelButton } from '@shell/utils/platform';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    type: {\n      type:     String,\n      required: true\n    },\n    close: {\n      type:     Function,\n      required: true\n    },\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return {\n      checkedList:    [],\n      checkAll:       true,\n      alternateLabel: alternateLabelButton\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter((volume) => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      let goTo;\n\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...this.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((_results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          this.value?.[0]?.currentRouter().push(goTo);\n        }\n        this.close();\n      }).catch((err) => {\n        this.$emit('errors', err);\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"mt-10\">\n      {{ t('promptRemove.attemptingToRemove', {type}) }}\n      <span v-clean-html=\"resourceNames(names, null, t)\"></span>\n\n      <div class=\"mt-10\">\n        {{ t('harvester.virtualMachine.promptRemove.title') }}\n      </div>\n      <div v-if=\"value.length === 1\">\n        <span\n          v-for=\"(name, i) in removeNameArr[value[0].id]\"\n          :key=\"i\"\n        >\n          <label class=\"checkbox-container mr-15\">\n            <input\n              v-model=\"checkedList\"\n              type=\"checkbox\"\n              :label=\"name\"\n              :value=\"name\"\n            />\n            <span\n              class=\"checkbox-custom mr-5\"\n              role=\"checkbox\"\n            />\n            {{ name }}\n          </label>\n        </span>\n      </div>\n      <div v-else>\n        <label class=\"checkbox-container mr-15\">\n          <input\n            v-model=\"checkedList\"\n            type=\"checkbox\"\n          />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n        </label>\n      </div>\n    </div>\n    <div class=\"text-warning mb-10 mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.tips') }}\n    </div>\n    <div class=\"text-info mt-20\">\n      {{ t('promptRemove.protip', { alternateLabel }) }}\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=46aee72e\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_ctx","t","type","$options","resourceType","resourceNames","$props","names","_Fragment","_renderList","$data","errors","error","i","_createBlock","_component_Banner","key","color","label","name","emits","props","value","Array","default","String","required","close","Function","doneLocation","Object","data","computed","mapState","mapGetters","isSnapshot","this","spec","BACKUP_TYPE","SNAPSHOT","count","length","HCI","VM_SNAPSHOT","BACKUP","methods","remove","buttonDone","Promise","all","map","resource","err","exceptionToErrorsArray","__exports__","render","_toDisplayString","_hoisted_3","removeNameArr","id","_hoisted_4","checkedList","$event","role","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","alternateLabel","checkAll","alternateLabelButton","out","forEach","crd","VM","volumes","template","filter","volume","persistentVolumeClaim","watch","handler","neu","keys","values","unshift","deep","immediate","goTo","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","_results","isEmpty","currentRouter","push","catch","$emit"],"sourceRoot":""}