{"version":3,"file":"harvester-1.5.2.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-1.5.2/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-1.5.2/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\nimport { alternateLabel as alternateLabelButton } from '@shell/utils/platform';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    type: {\n      type:     String,\n      required: true\n    },\n    close: {\n      type:     Function,\n      required: true\n    },\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return {\n      checkedList:    [],\n      checkAll:       true,\n      alternateLabel: alternateLabelButton\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter((volume) => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      let goTo;\n\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...this.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((_results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          this.value?.[0]?.currentRouter().push(goTo);\n        }\n        this.close();\n      }).catch((err) => {\n        this.$emit('errors', err);\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"mt-10\">\n      {{ t('promptRemove.attemptingToRemove', {type}) }}\n      <span v-clean-html=\"resourceNames(names, t)\"></span>\n\n      <div class=\"mt-10\">\n        {{ t('harvester.virtualMachine.promptRemove.title') }}\n      </div>\n      <div v-if=\"value.length === 1\">\n        <span\n          v-for=\"(name, i) in removeNameArr[value[0].id]\"\n          :key=\"i\"\n        >\n          <label class=\"checkbox-container mr-15\">\n            <input\n              v-model=\"checkedList\"\n              type=\"checkbox\"\n              :label=\"name\"\n              :value=\"name\"\n            />\n            <span\n              class=\"checkbox-custom mr-5\"\n              role=\"checkbox\"\n            />\n            {{ name }}\n          </label>\n        </span>\n      </div>\n      <div v-else>\n        <label class=\"checkbox-container mr-15\">\n          <input\n            v-model=\"checkedList\"\n            type=\"checkbox\"\n          />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n        </label>\n      </div>\n    </div>\n    <div class=\"text-warning mb-10 mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.tips') }}\n    </div>\n    <div class=\"text-info mt-20\">\n      {{ t('promptRemove.protip', { alternateLabel }) }}\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=38d7bac4\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_createElementVNode","_hoisted_1","_createTextVNode","_toDisplayString","_ctx","t","type","$props","$options","resourceNames","names","_hoisted_2","value","length","_hoisted_3","_Fragment","_renderList","removeNameArr","id","name","i","_hoisted_4","_cache","$event","$data","checkedList","label","_hoisted_5","role","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","alternateLabel","props","Array","default","String","required","close","Function","doneLocation","Object","data","checkAll","alternateLabelButton","computed","mapState","mapGetters","out","this","forEach","crd","HCI","VM","volumes","spec","template","filter","volume","persistentVolumeClaim","map","watch","handler","neu","keys","values","unshift","deep","immediate","methods","remove","goTo","Promise","all","resource","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","_results","isEmpty","currentRouter","push","catch","err","$emit","__exports__","render"],"sourceRoot":""}