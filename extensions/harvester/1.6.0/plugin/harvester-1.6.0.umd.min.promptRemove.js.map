{"version":3,"file":"harvester-1.6.0.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-1.6.0/./promptRemove/harvesterhci.io.virtualmachinebackup.vue","webpack://harvester-1.6.0/./promptRemove/harvesterhci.io.virtualmachinebackup.vue?afef","webpack://harvester-1.6.0/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-1.6.0/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { resourceNames } from '@shell/utils/string';\nimport { mapGetters, mapState } from 'vuex';\nimport { BACKUP_TYPE } from '@pkg/harvester/config/types';\nimport { HCI } from '../types';\nimport { exceptionToErrorsArray } from '@shell/utils/error';\n\nexport default {\n  name: 'PromptRemoveVMBackupDialog',\n\n  emits: ['errors'],\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    },\n\n    close: {\n      type:     Function,\n      required: true\n    },\n\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return { errors: [] };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n    resourceType() {\n      const isSnapshot = this.value?.[0]?.spec?.type === BACKUP_TYPE.SNAPSHOT;\n      const count = this.names?.length || 1;\n\n      if (isSnapshot) {\n        return this.t(`typeLabel.\"${ HCI.VM_SNAPSHOT }\"`, { count });\n      }\n\n      return this.t(`typeLabel.\"${ HCI.BACKUP }\"`, { count });\n    },\n  },\n  methods: {\n    resourceNames,\n    async remove(buttonDone) {\n      try {\n        await Promise.all(this.value.map((resource) => resource.remove()));\n        this.close(buttonDone);\n      } catch (err) {\n        this.errors = exceptionToErrorsArray(err);\n        buttonDone(false);\n      }\n    }\n  }\n};\n</script>\n\n<template>\n  <div class=\"mt-10\">\n    <div class=\"mb-5\">\n      {{ t('promptRemove.attemptingToRemove', { type: resourceType }) }} <span\n        v-clean-html=\"resourceNames(names, null, t)\"\n      />\n    </div>\n    <Banner\n      v-for=\"(error, i) in errors\"\n      :key=\"i\"\n      class=\"\"\n      color=\"error\"\n      :label=\"error\"\n    />\n  </div>\n</template>\n","import { render } from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=template&id=09d58eda\"\nimport script from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=script&lang=js\"\nexport * from \"./harvesterhci.io.virtualmachinebackup.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\nimport { alternateLabel as alternateLabelButton } from '@shell/utils/platform';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n    type: {\n      type:     String,\n      required: true\n    },\n    close: {\n      type:     Function,\n      required: true\n    },\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return {\n      checkedList:    [],\n      checkAll:       true,\n      alternateLabel: alternateLabelButton\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter((volume) => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      let goTo;\n\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...this.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((_results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          this.value?.[0]?.currentRouter().push(goTo);\n        }\n        this.close();\n      }).catch((err) => {\n        this.$emit('errors', err);\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"mt-10\">\n      {{ t('promptRemove.attemptingToRemove', {type}) }}\n      <span v-clean-html=\"resourceNames(names, null, t)\"></span>\n\n      <div class=\"mt-10\">\n        {{ t('harvester.virtualMachine.promptRemove.title') }}\n      </div>\n      <div v-if=\"value.length === 1\">\n        <span\n          v-for=\"(name, i) in removeNameArr[value[0].id]\"\n          :key=\"i\"\n        >\n          <label class=\"checkbox-container mr-15\">\n            <input\n              v-model=\"checkedList\"\n              type=\"checkbox\"\n              :label=\"name\"\n              :value=\"name\"\n            />\n            <span\n              class=\"checkbox-custom mr-5\"\n              role=\"checkbox\"\n            />\n            {{ name }}\n          </label>\n        </span>\n      </div>\n      <div v-else>\n        <label class=\"checkbox-container mr-15\">\n          <input\n            v-model=\"checkedList\"\n            type=\"checkbox\"\n          />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n        </label>\n      </div>\n    </div>\n    <div class=\"text-warning mb-10 mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.tips') }}\n    </div>\n    <div class=\"text-info mt-20\">\n      {{ t('promptRemove.protip', { alternateLabel }) }}\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=46aee72e\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createTextVNode","_toDisplayString","_ctx","t","type","$options","resourceType","resourceNames","$props","names","_Fragment","_renderList","$data","errors","error","i","_createBlock","_component_Banner","key","color","label","name","emits","props","value","Array","default","String","required","close","Function","doneLocation","Object","data","computed","mapState","mapGetters","isSnapshot","this","spec","BACKUP_TYPE","SNAPSHOT","count","length","HCI","VM_SNAPSHOT","BACKUP","methods","remove","buttonDone","Promise","all","map","resource","err","exceptionToErrorsArray","__exports__","render","_hoisted_3","removeNameArr","id","_hoisted_4","_cache","$event","checkedList","_hoisted_5","role","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","alternateLabel","checkAll","alternateLabelButton","out","forEach","crd","VM","volumes","template","filter","volume","persistentVolumeClaim","watch","handler","neu","keys","values","unshift","deep","immediate","goTo","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","_results","isEmpty","currentRouter","push","catch","$emit"],"sourceRoot":""}