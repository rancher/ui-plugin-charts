{"version":3,"file":"harvester-1.0.3.umd.min.promptRemove.js","mappings":"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","sources":["webpack://harvester-1.0.3/./promptRemove/kubevirt.io.virtualmachine.vue","webpack://harvester-1.0.3/./promptRemove/kubevirt.io.virtualmachine.vue?8f77"],"sourcesContent":["<script>\nimport { mapState, mapGetters } from 'vuex';\nimport { isEmpty } from '@shell/utils/object';\nimport Parse from 'url-parse';\nimport { resourceNames } from '@shell/utils/string';\nimport { HCI } from '../types';\nimport { alternateLabel as alternateLabelButton } from '@shell/utils/platform';\n\nexport default {\n  name: 'HarvesterPromptRemove',\n\n  props: {\n    value: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    names: {\n      type:    Array,\n      default: () => {\n        return [];\n      }\n    },\n\n    type: {\n      type:     String,\n      required: true\n    },\n    close: {\n      type:     Function,\n      required: true\n    },\n    doneLocation: {\n      type:    Object,\n      default: () => {}\n    }\n  },\n\n  data() {\n    return {\n      checkedList:    [],\n      checkAll:       true,\n      alternateLabel: alternateLabelButton\n    };\n  },\n\n  computed: {\n    ...mapState('action-menu', ['toRemove']),\n    ...mapGetters({ t: 'i18n/t' }),\n\n    removeNameArr() {\n      const out = {};\n\n      this.value.forEach((crd) => {\n        if (crd.type !== HCI.VM) {\n          return;\n        }\n        const volumes = crd.spec.template.spec?.volumes || [];\n        const names = volumes.filter((volume) => volume.persistentVolumeClaim ).map((volume) => {\n          if (volume.persistentVolumeClaim) {\n            return volume.name;\n          }\n        });\n\n        out[crd.id] = names;\n      });\n\n      return out;\n    },\n\n    plusMore() {\n      const remaining = this.toRemove.length - this.names.length;\n\n      return this.t('promptRemove.andOthers', { count: remaining });\n    },\n  },\n\n  watch: {\n    removeNameArr: {\n      handler(neu) {\n        if (this.value.length === 1) {\n          const keys = Object.values(neu[this.value[0].id]);\n\n          this.checkedList.unshift(keys[0]);\n        }\n      },\n      deep:      true,\n      immediate: true\n    }\n  },\n\n  methods: {\n    resourceNames,\n    remove() {\n      let goTo;\n\n      if (this.doneLocation) {\n        // doneLocation will recompute to undefined when delete request completes\n        goTo = { ...this.doneLocation };\n      }\n\n      Promise.all(this.value.map((resource) => {\n        if (resource.type !== HCI.VM) { // maybe is VMI\n          resource.remove();\n\n          return;\n        }\n\n        let removedDisks = '';\n\n        if (this.value.length > 1) {\n          if (this.checkAll) {\n            this.removeNameArr[resource.id].forEach((item) => {\n              removedDisks += `removedDisks=${ item }&`;\n            });\n          }\n        } else {\n          this.checkedList.forEach((item) => {\n            removedDisks += `removedDisks=${ item }&`;\n          });\n          removedDisks.replace(/&$/, '');\n        }\n\n        const parsed = Parse(resource.links.self);\n\n        resource.remove({ url: `${ parsed.pathname }?${ removedDisks }propagationPolicy=Foreground` });\n      })).then((_results) => {\n        if ( goTo && !isEmpty(goTo) ) {\n          this.value?.[0]?.currentRouter().push(goTo);\n        }\n        this.close();\n      }).catch((err) => {\n        this.$emit('errors', err);\n      });\n    }\n  }\n};\n</script>\n\n<template>\n  <div>\n    <div class=\"mt-10\">\n      {{ t('promptRemove.attemptingToRemove', {type}) }}\n      <span v-clean-html=\"resourceNames(names, plusMore, t)\"></span>\n\n      <div class=\"mt-10\">\n        {{ t('harvester.virtualMachine.promptRemove.title') }}\n      </div>\n      <div v-if=\"value.length === 1\">\n        <span\n          v-for=\"(name, i) in removeNameArr[value[0].id]\"\n          :key=\"i\"\n        >\n          <label class=\"checkbox-container mr-15\">\n            <input\n              v-model=\"checkedList\"\n              type=\"checkbox\"\n              :label=\"name\"\n              :value=\"name\"\n            />\n            <span\n              class=\"checkbox-custom mr-5\"\n              role=\"checkbox\"\n            />\n            {{ name }}\n          </label>\n        </span>\n      </div>\n      <div v-else>\n        <label class=\"checkbox-container mr-15\">\n          <input\n            v-model=\"checkedList\"\n            type=\"checkbox\"\n          />\n          <span\n            class=\"checkbox-custom mr-5\"\n            role=\"checkbox\"\n          />\n          {{ t('harvester.virtualMachine.promptRemove.deleteAll') }}\n        </label>\n      </div>\n    </div>\n    <div class=\"text-warning mb-10 mt-10\">\n      {{ t('harvester.virtualMachine.promptRemove.tips') }}\n    </div>\n    <div class=\"text-info mt-20\">\n      {{ t('promptRemove.protip', { alternateLabel }) }}\n    </div>\n  </div>\n</template>\n","import { render } from \"./kubevirt.io.virtualmachine.vue?vue&type=template&id=695ba7fe\"\nimport script from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\nexport * from \"./kubevirt.io.virtualmachine.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","role","_createElementBlock","_hoisted_1","_ctx","t","type","$props","$options","resourceNames","names","plusMore","_hoisted_2","_toDisplayString","value","length","_hoisted_3","_Fragment","_renderList","removeNameArr","id","name","i","key","_hoisted_4","$data","checkedList","$event","label","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","alternateLabel","props","Array","default","String","required","close","Function","doneLocation","Object","data","checkAll","alternateLabelButton","computed","mapState","mapGetters","out","this","forEach","crd","HCI","VM","volumes","spec","template","filter","volume","persistentVolumeClaim","map","remaining","toRemove","count","watch","handler","neu","keys","values","unshift","deep","immediate","methods","remove","goTo","Promise","all","resource","removedDisks","item","replace","parsed","Parse","links","self","url","pathname","then","_results","isEmpty","currentRouter","push","catch","err","$emit","__exports__","render"],"sourceRoot":""}